(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(e,t,n){"use strict";var r="00000000000000";function i(e,t){if(void 0===e)return"";var n=e.toString(),i=t-n.length;return i<=0?n:r.substr(0,i)+n}n(82);var s=n(37),o=n(46),a=n(42),c=n(81),u=n(6),l=n.n(u),h=n(12),d=n(14),f=n(21),p=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},v=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(h.a)(this,e),this.isFirst=!0,this.loading=!1,this.beforeLoad=!0,this.loaded=!1,this.allLoaded=!1,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this._items=f.k.array([],{deep:t})}return Object(d.a)(e,[{key:"scrollToTop",value:function(){this.topDiv="$$"+Object(a.a)()}},{key:"scrollToBottom",value:function(){this.bottomDiv="$$"+Object(a.a)()}},{key:"reset",value:function(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this._items.clear(),this.setPageStart(void 0)}},{key:"append",value:function(e){"tail"===this.appendPosition?this._items.unshift(e):this._items.push(e)}},{key:"first",value:function(e){return v(this,void 0,void 0,l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.reset(),this.beforeLoad=!1,this.param=e,t.next=5,this.more();case 5:case"end":return t.stop()}},t,this)}))}},{key:"more",value:function(){return v(this,void 0,void 0,l.a.mark(function e(){var t,n,r,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.allLoaded){e.next=2;break}return e.abrupt("return");case 2:if(!0!==this.loading){e.next=4;break}return e.abrupt("return");case 4:return this.loading=!0,r=this.pageSize+1,!0===this.isFirst&&this.firstSize>this.pageSize&&(r=this.firstSize+1),e.next=9,this.load(this.param,this.pageStart,r);case 9:if(i=e.sent,this.loading=!1,this.loaded=!0,s=i.length,!0===this.isFirst&&s>this.firstSize||!1===this.isFirst&&s>this.pageSize?(this.allLoaded=!1,--s,i.splice(s,1)):this.allLoaded=!0,0!==s){e.next=17;break}return this._items.clear(),e.abrupt("return");case 17:this.setPageStart(i[s-1]),"tail"===this.appendPosition?(t=this._items).push.apply(t,Object(c.a)(i)):(n=this._items).unshift.apply(n,Object(c.a)(i.reverse())),this.isFirst=!1;case 20:case"end":return e.stop()}},e,this)}))}},{key:"items",get:function(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0}}]),e}();p([f.k],m.prototype,"loading",void 0),p([f.k],m.prototype,"beforeLoad",void 0),p([f.k],m.prototype,"loaded",void 0),p([f.k],m.prototype,"allLoaded",void 0),p([f.d],m.prototype,"items",null),p([f.k],m.prototype,"topDiv",void 0),p([f.k],m.prototype,"bottomDiv",void 0);var y=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},b=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(h.a)(this,e),this.arr=[],this.dict=new Map,this.maxCount=t}return Object(d.a)(e,[{key:"loadIds",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var a=s.value;if(null!==a){var c=this.dict.get(a);void 0===c&&(t.push(a),c={id:a},this.dict.set(a,c))}}}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}this.loadId(t)}},{key:"get",value:function(e){if(void 0===e||null===e)return null;var t=this.dict.get(e);return void 0===t&&(this.dict.set(e,{id:e}),this.loadId([e]),t=this.dict.get(e)),t}},{key:"setItem",value:function(e,t){void 0===t?(this.dict.set(e,null),this.arr.push({id:e})):(this.dict.set(e,t),this.arr.push(t)),this.arr.length>this.maxCount&&(t=this.arr.shift(),this.dict.delete(t.id))}},{key:"loadId",value:function(e){return b(this,void 0,void 0,l.a.mark(function t(){var n,r,i,s,o,a,c,u,h,d,f,p,v,m,y=this;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._loadIds(e);case 2:if(void 0!==(n=t.sent)){t.next=36;break}r=!0,i=!1,s=void 0,t.prev=7,o=e[Symbol.iterator]();case 9:if(r=(a=o.next()).done){t.next=20;break}if(null!==(c=a.value)){t.next=13;break}return t.abrupt("continue",17);case 13:return t.next=15,this._loadId(c);case 15:u=t.sent,this.setItem(c,u);case 17:r=!0,t.next=9;break;case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(7),i=!0,s=t.t0;case 26:t.prev=26,t.prev=27,r||null==o.return||o.return();case 29:if(t.prev=29,!i){t.next=32;break}throw s;case 32:return t.finish(29);case 33:return t.finish(26);case 34:t.next=56;break;case 36:for(h=!0,d=!1,f=void 0,t.prev=39,p=function(){var e=m.value,t=n.find(function(t){return t.id===e});y.setItem(e,t)},v=e[Symbol.iterator]();!(h=(m=v.next()).done);h=!0)p();t.next=48;break;case 44:t.prev=44,t.t1=t.catch(39),d=!0,f=t.t1;case 48:t.prev=48,t.prev=49,h||null==v.return||v.return();case 51:if(t.prev=51,!d){t.next=54;break}throw f;case 54:return t.finish(51);case 55:return t.finish(48);case 56:case"end":return t.stop()}},t,this,[[7,22,26,34],[27,,29,33],[39,44,48,56],[49,,51,55]])}))}}]),e}();y([f.k],w.prototype,"dict",void 0),n.d(t,"k",function(){return i}),n.d(t,"o",function(){return s.j}),n.d(t,"m",function(){return s.i}),n.d(t,"l",function(){return s.g}),n.d(t,"g",function(){return s.c}),n.d(t,"f",function(){return s.b}),n.d(t,"a",function(){return s.a}),n.d(t,"c",function(){return o.c}),n.d(t,"n",function(){return o.h}),n.d(t,"d",function(){return o.d}),n.d(t,"p",function(){return o.i}),n.d(t,"b",function(){return o.a}),n.d(t,"j",function(){return o.g}),n.d(t,"h",function(){return o.e}),n.d(t,"i",function(){return o.f}),n.d(t,"e",function(){return m})},,function(e,t,n){"use strict";var r,i=n(4),s=n(19),o=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},c=function(){function e(e){this.formView=e}return e.prototype.render=function(){return i.createElement("div",{className:"col-sm-10"},this.renderControl())},Object.defineProperty(e.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.clear=function(){},e.prototype.clearErrors=function(){},e.prototype.readValues=function(e){},e.prototype.setError=function(e,t){},e.prototype.setInitValues=function(e){},e.prototype.isOk=function(){return this.validate(),!this.hasError},e.prototype.validate=function(){},a([s.d],e.prototype,"hasError",null),a([s.d],e.prototype,"filled",null),e}(),u=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.field=n,i.face=r,i.init(),i.setProps(),i}return o(t,e),t.prototype.ref=function(e){this.element=e},t.prototype.init=function(){var e;this.rules=[];var t=this.field.rules;void 0!==t&&(!0===Array.isArray(t)?(e=this.rules).push.apply(e,t):this.rules.push(t))},t.prototype.setProps=function(){return this.props={ref:this.ref.bind(this),name:this.field.name}},Object.defineProperty(t.prototype,"hasError",{get:function(){return void 0!==this.error},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return void 0!==this.value&&this.value!==this.field.defaultValue},enumerable:!0,configurable:!0}),t.prototype.clearValue=function(){this.value=void 0},t.prototype.clear=function(){this.clearErrors(),this.clearValue()},t.prototype.clearErrors=function(){this.isOK=void 0,this.error=void 0},t.prototype.readValues=function(e){e[this.field.name]=this.value},t.prototype.setError=function(e,t){},t.prototype.setInitValues=function(e){},t.prototype.getValueFromElement=function(){return this.value},t.prototype.validate=function(){try{var e=this.getValueFromElement();if(this.rules.length>0){for(var t=void 0,n=0,r=this.rules;n<r.length;n++){var i=r[n];console.log("validate: %s",e);var s=i(e);if(console.log("validate: %s err: %s",e,s),!0===s)this.error=void 0,t=!0;else if(void 0!==s)return this.error=s,void(this.isOK=!1)}this.isOK=t}this.value=e}catch(o){this.error=o.message}},t.prototype.render=function(){var e;if(void 0!==this.face){var t=this.face.notes;void 0!==t&&(e=i.createElement("small",{className:"text-muted"},t))}return i.createElement("div",{className:"col-sm-10"},this.renderControl(),e)},a([s.k],t.prototype,"isOK",void 0),a([s.k],t.prototype,"error",void 0),a([s.k],t.prototype,"value",void 0),a([s.d],t.prototype,"hasError",null),a([s.d],t.prototype,"filled",null),t}(c),l=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(e){function t(t){var n=e.call(this,t)||this;return n.otherClick=n.otherClick.bind(n),n}return l(t,e),t.prototype.otherClick=function(){var e=this.formView.props.onOther;void 0!==e&&e(this.formView.readValues())},t.prototype.renderControl=function(){console.log("buttons.renderControl");var e=this.formView.nothing,t=this.formView.hasError,n=this.formView.props;console.log("buttons.renderControl nothing:%s hasError:%s",e,t);var r,s=n.submitButton,o=n.otherButton;n.onOther;return void 0!==o&&(r=i.createElement("button",{className:"btn btn-outline-info ml-auto",onClick:this.otherClick},o)),i.createElement("div",{className:"d-flex justify-content-start"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:e||t},s||"\u63d0\u4ea4"),r)},t}(c),d=n(31),f=n(8),p=n.n(f),v=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.prototype.init=function(){e.prototype.init.call(this),!0===this.field.required&&this.rules.push(function(e){return null!==e&&void 0!==e&&0!==e.trim().length||"\u5fc5\u987b\u586b\u5165\u8981\u6c42\u5185\u5bb9"})},t.prototype.getValueFromElement=function(){return this.parseValue(this.element.value)},t.prototype.setProps=function(){e.prototype.setProps.call(this),d.assign(this.props,{onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onChange:this.onChange.bind(this)});var t=this.face;return void 0!==t&&d.assign(this.props,{placeholder:t.placeholder}),this.props},t.prototype.parseValue=function(e){return e},t.prototype.onBlur=function(){this.validate()},t.prototype.onChange=function(){console.log("onChange"),this.validate()},t.prototype.onFocus=function(){this.clearErrors()},t.prototype.className=function(){return f({"form-control":!0,"has-success":!0===this.isOK,"is-invalid":void 0!==this.error,"is-valid":void 0===this.error&&!0===this.isOK})},t.prototype.renderInput=function(){return i.createElement("input",m({className:this.className()},this.props))},t.prototype.ref=function(t){e.prototype.ref.call(this,t),t&&(t.value=void 0===this.value?"":this.value)},t.prototype.renderError=function(){return void 0===this.error?null:i.createElement("div",{className:"invalid-feedback"},this.error)},t.prototype.clearValue=function(){e.prototype.clearValue.call(this),this.element.value=""},t.prototype.setError=function(e,t){this.field.name===e&&(this.error=t)},t.prototype.setInitValues=function(e){var t=e[this.field.name];void 0!==t&&(this.value=t)},t.prototype.renderControl=function(){return i.createElement(i.Fragment,null,this.renderInput(),this.renderError())},t}(u),b=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this);return d.assign(t,{type:"text",maxLength:this.field.maxLength}),t},t.prototype.parseValue=function(e){if(void 0!==e&&0!==e.trim().length)return e},t}(y),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this);return d.assign(t,{type:"password",maxLength:this.field.maxLength}),t},t}(w),k=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return k(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.extraChars=[];var t=this.field,n=t.min,r=t.max;switch(void 0!==n?(this.rules.push(function(e){if(void 0!==e)return!(e<n)||"\u6700\u5c0f\u503c\u4e3a"+n}),n<0&&this.extraChars.push(45)):this.extraChars.push(45),void 0!==r&&this.rules.push(function(e){if(void 0!==e)return!(e>r)||"\u6700\u5927\u503c\u4e3a"+r}),this.field.type){case"dec":case"number":this.extraChars.push(46)}},t.prototype.parseValue=function(e){if(void 0!==e&&0!==e.trim().length){var t=Number.parseFloat(e);if(isNaN(t))throw new Error("\u65e0\u6548\u7684\u6570\u5b57");return t}},t.prototype.setProps=function(){e.prototype.setProps.call(this),d.assign(this.props,{type:"number",step:this.field.step,onKeyPress:this.onKeyPress.bind(this)})},t.prototype.onKeyPress=function(e){var t=e.charCode;if(!(8===t||0===t||13===t||t>=48&&t<=57))if(void 0!==this.extraChars&&this.extraChars.indexOf(t)>=0)switch(t){case 46:this.onKeyDot();break;case 45:this.onKeyNeg(),e.preventDefault()}else e.preventDefault()},t.prototype.onKeyDot=function(){var e=this.element.value;e.indexOf(".")>=0&&(this.element.value=e.replace(".",""))},t.prototype.onKeyNeg=function(){var e=this.element.value,t=e.indexOf("-");e=t>=0?e.replace("-",""):"-"+e,this.element.value=e},t}(y),E=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t.prototype.init=function(){e.prototype.init.call(this);var t=this.field,n=t.trueValue,r=t.falseValue;void 0===n&&(this.trueValue=1),void 0===r&&(this.falseValue=0)},t.prototype.setProps=function(){e.prototype.setProps.call(this),d.assign(this.props,{onChange:this.onChange.bind(this)})},t.prototype.clearValue=function(){this.element.checked=this.field.defaultValue===this.trueValue,this.value=this.getValueFromElement()},t.prototype.setInitValues=function(e){var t=e[this.field.name];void 0===t&&(t=this.field.defaultValue)},t.prototype.getValueFromElement=function(){return this.element.checked?this.trueValue:this.falseValue},t.prototype.onChange=function(){this.value=this.getValueFromElement()},t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static"},i.createElement("label",{className:"form-control"},i.createElement("label",{className:"custom-control custom-checkbox mb-0"},i.createElement("input",{type:"checkbox",name:this.field.name,ref:this.props.ref,onChange:this.props.onChange,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},this.face.label))))},t}(u),C=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.renderControl=function(){var e=this;return i.createElement("div",{className:"form-control-static"},i.createElement("div",{className:"form-control"},this.face.list.map(function(t,n){var r;return"object"!==typeof t?r=t:(r=t.text,t.value),i.createElement("label",{key:n,className:"custom-control custom-radio w-25"},i.createElement("input",{type:"radio",name:e.field.name,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},r))})))},t}(u),P=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this),n=this.field.maxLength,r=this.face.rows;return d.assign(t,{maxLength:n,rows:r}),t},t.prototype.renderInput=function(){var e=this;return i.createElement("textarea",j({ref:function(t){e.el=t,void 0!==t&&(t.value="")},className:this.className()},this.props))},t}(y),_=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.ref=i.ref.bind(i),i}return _(t,e),t.prototype.getValueFromElement=function(){var e=this.element,t=(e.selectedIndex,e.selectedOptions[0].value);switch(this.field.type){case"number":t=Number(t);break;case"date":t=new Date(t);break;case"bool":"string"===typeof t&&(t="true"===t.toLowerCase())}return t},t.prototype.renderControl=function(){var e=this.face.list,t=[];return void 0===this.face.default&&t.push(i.createElement("option",{key:-1,value:void 0},"\u8bf7\u9009\u62e9")),t.push.apply(t,e.map(function(e,t){var n,r;return"object"!==typeof e?n=r=e:(n=e.text,r=e.value),i.createElement("option",{key:t,value:r},n)})),i.createElement("div",{className:"form-control-static"},i.createElement("select",{name:this.field.name,className:"form-control",ref:this.ref},t))},t}(u),F=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return F(t,e),t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},i.createElement("div",{className:"alert alert-primary",role:"alert"},"don't know how to create control",i.createElement("br",null),"field: ",JSON.stringify(this.field)," must be object ",i.createElement("br",null),"face: ",JSON.stringify(this.face)," must be object ",i.createElement("br",null)))},t}(u),I=function(e){function t(t,n){var r=e.call(this,t)||this;return r.element=n,r}return F(t,e),t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},this.element)},t}(c),R=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},q=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},M=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return q(t,void 0,void 0,function(){var e,t,n,r,i,s,o;return M(this,function(a){switch(a.label){case 0:return e=this.face,t=e.pick,n=e.fromPicked,[4,t(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(r=a.sent())?(this.value=void 0,[2]):void 0===n?(this.value=r.id,[2]):(i=n(r),s=i.id,o=i.caption,this.value=s,this.caption=o,[2])}})})},t.onPicked=function(e){t.value=e.id},t}return R(t,e),t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.controlContent=function(){var e=this.face,t=e.itemFromId,n=e.fromPicked,r=e.initCaption;if(void 0===this.value)return r||"\u8bf7\u9009\u62e9Id";if(void 0!==this.caption)return this.caption;if(void 0!==t&&void 0!==n){var i=t(this.value);if(i){var s=n(i);if(void 0!==s)return s.caption}}return String(this.value)},t.prototype.renderControl=function(){var e=this.face,t=e.tuid,n=e.input;return void 0===n?i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer",onClick:this.onClick},this.controlContent()):i.createElement("div",{className:"form-control-static "},i.createElement(n.component,{id:this.value,ui:t}))},T([s.k],t.prototype,"caption",void 0),t}(u),U=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},D=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},H=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.onIdChanged=i.onIdChanged.bind(i),i}return U(t,e),t.prototype.onIdChanged=function(e){this.value=e.id},t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.buildContent=function(){var e=this;return i.createElement(this.face.input.component,B({},this.face,{id:this.value,onFormValues:function(){return e.formView.readValues()},onIdChanged:this.onIdChanged}))},t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static "},this.buildContent())},D([s.k],t.prototype,"caption",void 0),t}(u),$=n(29),W=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Q=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},z=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},K=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return z(t,void 0,void 0,function(){var e,t,n,r,i,s,o;return K(this,function(a){switch(a.label){case 0:return e=this.face,t=e.pick,n=e.fromPicked,[4,t(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(r=a.sent())?(this.value=void 0,[2]):(i=n(r),s=i.id,o=i.caption,this.value=s,this.caption=o,[2])}})})},t.view=Object($.a)(function(){var e,n=t.face.content;return e=void 0===t.value||null===t.value?"\u8bf7\u9009\u62e9":i.createElement(n,{id:t.value}),i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer bg-light",onClick:t.onClick},e)}),t}return W(t,e),t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.renderControl=function(){return i.createElement(this.view,null)},Q([s.k],t.prototype,"caption",void 0),t}(u),G=function(e,t){t.label;return void 0!==t.group?function(e,t,n){return new A(e,n,void 0)}(e,0,t):void 0!==t.field?function(e,t,n){var r=n.field,i=n.face;switch(typeof r){case"string":r={name:r,type:"string"};break;case"object":break;default:return new A(e,r,i)}var s=r.type||"string";if(void 0===i){if(void 0===(i=X[s]))return new A(e,r,i)}else if(void 0===i.type){var o=X[s];i.type=void 0===o?"string":o.type}return new(Y[i.type||s]||A)(e,r,i)}(e,0,t):new I(e,t.help)},Y={string:w,password:g,number:x,checkbox:O,radiobox:N,select:V,"pick-id":L,"pick-tuid":H,textarea:S,pick:J},X={string:{type:"string"},number:{type:"number"},int:{type:"number"},dec:{type:"number"},bool:{type:"checkbox"}};var Z=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(){function e(e,t){if(this.form=e,this.row=t,void 0===t.type){var n=t.createControl;void 0===n&&(n=e.createControl),void 0===n&&(n=G),this.control=n(e,t)}}return e.prototype.isOk=function(){return void 0===this.control||this.control.isOk()},e.prototype.contains=function(e){var t=this.row.field;if(void 0!==t)return e===t.name;var n=this.row.group;return void 0!==n&&void 0!==n.find(function(t){return t.field.name===e})},Object.defineProperty(e.prototype,"hasError",{get:function(){return this.control.hasError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return this.control.filled},enumerable:!0,configurable:!0}),e.prototype.clear=function(){void 0!==this.control&&this.control.clear()},e.prototype.clearErrors=function(){void 0!==this.control&&this.control.clearErrors()},e.prototype.readValues=function(e){void 0!==this.control&&this.control.readValues(e)},e.prototype.setError=function(e,t){void 0!==this.control&&this.control.setError(e,t)},e.prototype.setInitValues=function(e){void 0!==this.control&&this.control.setInitValues(e)},e}(),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Z(t,e),t.prototype.render=function(e){return i.createElement("div",{key:e,className:"form-group"},this.row)},Object.defineProperty(t.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(ee),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Z(t,e),t.prototype.render=function(e){return i.createElement("div",{key:e,className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.row.label),this.control.render())},t}(ee);function re(e,t){return new ne(e,t)}function ie(e,t){return new te(e,t)}var se="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",oe=8;function ae(){for(var e=se.length,t="",n=0;n<oe;n++)t+=se.charAt(Math.floor(Math.random()*e));return t}var ce=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},ue=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},le=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},he=function(){function e(e){this.rows=[],this.uid=ae(),this.props=e,this.buildRows(e),this.createControl=e.createControl,this.onSubmit=this.onSubmit.bind(this)}return Object.defineProperty(e.prototype,"hasError",{get:function(){var e=this.rows.map(function(e,t){return t+": "+e.hasError+"\n"});return console.log(e),this.rows.some(function(e){return e.hasError})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nothing",{get:function(){return this.rows.every(function(e){return!e.filled})},enumerable:!0,configurable:!0}),e.prototype.readValues=function(){for(var e={},t=0,n=this.rows;t<n.length;t++){n[t].readValues(e)}return e},e.prototype.clear=function(){for(var e=0,t=this.rows;e<t.length;e++){t[e].clear()}},e.prototype.clearErrors=function(){for(var e=0,t=this.rows;e<t.length;e++){t[e].clearErrors()}},e.prototype.setError=function(e,t){for(var n=0,r=this.rows;n<r.length;n++){r[n].setError(e,t)}},e.prototype.setInitValues=function(e){if(void 0!==e)for(var t=0,n=this.rows;t<n.length;t++){n[t].setInitValues(e)}},e.prototype.buildRows=function(e){var t=e.formRows,n=e.createRow;if(void 0!==t){for(var r=0,s=t;r<s.length;r++){var o=s[r];this.rows.push(this.buildRow(o,n))}!0!==this.props.readOnly&&(this.buttonsRow=this.buildRow({createControl:this.createButtons.bind(this)},void 0))}else this.rows.push(ie(this,i.createElement("div",{className:"text-warning"},"TonvaForm need formRows defined")))},e.prototype.buildRow=function(e,t){var n;return void 0!==e.type?n=ie:void 0===(n=e.createRow)&&void 0===(n=t)&&(n=re),n(this,e)},e.prototype.createButtons=function(e,t){return new h(e)},e.prototype.isOk=function(){for(var e=!0,t=0,n=this.rows;t<n.length;t++){n[t].isOk()||(e=!1)}return e},e.prototype.render=function(){var e=this;return i.createElement("form",{onSubmit:this.onSubmit},this.rows.map(function(t,n){return t.render(e.uid+n)}),this.buttons())},e.prototype.buttons=function(){if(void 0!==this.buttonsRow)return this.buttonsRow.render(this.uid+this.rows.length)},e.prototype.onSubmit=function(e){return ue(this,void 0,void 0,function(){var t;return le(this,function(n){switch(n.label){case 0:return e.preventDefault(),this.isOk()?(t=this.readValues(),[4,this.props.onSubmit(t)]):[2];case 1:return n.sent(),[2]}})})},ce([s.d],e.prototype,"hasError",null),ce([s.d],e.prototype,"nothing",null),e}(),de=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};var pe=function(e){function t(t){var n=e.call(this,t)||this;return n.formView=new he(n.props),n}return de(t,e),t.prototype.componentWillMount=function(){this.formView.setInitValues(this.props.initValues)},t.prototype.debug=function(){},t.prototype.render=function(){var e=this.props,t=e.className,n=e.children;e.initValues;return i.createElement("div",{className:t},void 0===n?this.formView.render():i.createElement("form",{onSubmit:this.formView.onSubmit},n))},t=fe([$.a],t)}(i.Component),ve=n(61),me=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ye=(function(e){function t(t){var n=e.call(this,t)||this;return n.toggle=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.state={dropdownOpen:!1},n}me(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,n=e.actions,r=e.isRight;void 0===r&&(r=!0);var s=n.some(function(e){return void 0!==e.icon});return i.createElement(ve.d,{isOpen:this.state.dropdownOpen,toggle:this.toggle},i.createElement(ve.c,{caret:!0,size:"sm",className:"cursor-pointer"},i.createElement("i",{className:f("fa","fa-"+(t||"ellipsis-v"))})),i.createElement(ve.b,{right:r},n.map(function(e,t){var n,r=e.icon,o=e.caption,a=e.action;return void 0===r&&void 0===o?i.createElement("div",{className:"dropdown-divider"}):(!0===s&&(void 0!==r&&(r="fa-"+r),n=i.createElement(i.Fragment,null,i.createElement("i",{className:f("fa",r,"fa-fw"),"aria-hidden":!0}),"\xa0 ")),void 0===a?i.createElement("h6",{className:"dropdown-header"},n," ",o):i.createElement(ve.a,{key:t,onClick:a},n," ",o))})))}}(i.Component),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ye(t,e),t.prototype.render=function(){var e=this.props.date;if(!e)return null;var t="string"===typeof e?new Date(Date.parse(e)):e,n=new Date,r=n.getTime()-t.getTime(),i=n.getDate(),s=t.getDate(),o=t.getHours(),a=t.getMinutes(),c=t.getMonth()+1,u=o+(a<10?":0":":")+a;return r<-864e5?t.getFullYear()+"\u5e74"+c+"\u6708"+s+"\u65e5 "+u:r<864e5?s!==i?(r<0?"\u660e\u5929 ":"\u6628\u5929 ")+u:u:r<31536e6?c+"\u6708"+s+"\u65e5 ":t.getFullYear()+"\u5e74"+c+"\u6708"+s+"\u65e5"},t}(i.Component),we=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(){function e(){}return e.prototype.setValues=function(e){},e}(),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.render=function(e){return i.createElement("div",{key:"_b_"+e,className:""},i.createElement("div",{className:"col-sm-12"},i.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}})))},t}(ge),xe=function(e){function t(t){var n=e.call(this)||this;return n.param=t,n}return we(t,e),t.prototype.render=function(e){var t;switch(this.param){default:t="py-2";break;case"=":t="py-1";break;case"-":t="pb-1"}var n=f(t);return i.createElement("div",{key:"_g_"+e,className:n,style:{backgroundColor:"#f0f0f0"}})},t}(ge),Ee=function(e){function t(t,n){var r=e.call(this)||this;return r.gridProps=t,r.prop=n,r}return we(t,e),t.prototype.render=function(e){var t=this.prop,n=t.onClick,r=t.bk,s=f({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return i.createElement("div",{key:e,className:s,onClick:n},this.renderLabel(),this.renderProp())},t.prototype.renderLabel=function(){var e=this.prop.label;return void 0===e?null:i.createElement("label",{className:"col-sm-2 col-form-label"},e)},t.prototype.renderProp=function(){var e,t,n=this.prop,r=n.label,s=n.full;switch(this.gridProps.alignValue){case"left":e="justify-content-start";break;case"center":e="justify-content-center";break;case"right":e="justify-content-end"}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}var o=f(e,t,!0!==s?void 0===r?"col-sm-12":"col-sm-10":"w-100","d-flex");return i.createElement("div",{className:o},this.renderPropBody())},t.prototype.renderPropBody=function(){return i.createElement("div",{className:"form-control-plaintext"},this.renderPropContent())},t.prototype.renderPropContent=function(){return this.content},t}(ge),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.setValues=function(e){this.content=void 0===e?void 0:e[this.prop.name]},t}(Ee),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.setValues=function(e){this.content=void 0===e?void 0:e[this.prop.name]},t}(Ee),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.setValues=function(e){if(void 0===e)this.content=void 0;else{var t=this.prop.list;this.content="string"===typeof t?e[t]:void 0}},t.prototype.renderPropBody=function(){var e=this.prop,t=e.list,n=e.row,r="string"===typeof t?this.content:t;return void 0===r?i.createElement("div",null):i.createElement("div",null,r.map(function(e,t){return i.createElement(i.Fragment,{key:t},0===t?null:i.createElement("div",{style:{borderBottom:"1px solid #f0f0f0"}}),i.createElement(n,e))}))},t}(Ee),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.renderPropBody=function(){return this.prop.component},t}(Ee),je=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}we(t,e),t.prototype.render=function(e){return i.createElement("div",{className:"bg-white"},i.createElement("label",{className:"col-sm-2 col-form-label"},"AAABBBCCC"),i.createElement("div",{className:"col-sm-10"},i.createElement("div",{className:"form-control-plaintext"},"dsfasfa sdf asdf a")))}}(ge),function(){function e(e,t){this.gridProps=e,this.props=t,this.buildRows()}return e.prototype.buildRows=function(){this.rows=[];for(var e=!0,t=0,n=this.props;t<n.length;t++){var r=n[t];if("string"===typeof r)this.rows.push(new xe(r)),e=!0;else{e||this.rows.push(new ke);var i=void 0;switch(r.type){default:continue;case"string":i=new Oe(this.gridProps,r);break;case"number":i=new Ce(this.gridProps,r);break;case"list":i=new Ne(this.gridProps,r);break;case"component":i=new Pe(this.gridProps,r)}this.rows.push(i),e=!1}}},e.prototype.setValues=function(e){for(var t=0,n=this.rows;t<n.length;t++){n[t].setValues(e)}},e.prototype.render=function(){return this.rows.map(function(e,t){return e.render(String(t))})},e}()),Se=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_e=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Ve=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Se(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.rows,r=e.values,s=new je(this.props,n);s.setValues(r);var o=f("container-fluid",t);return i.createElement("div",{className:o},s.render())},t=_e([$.a],t)}(i.Component),n(141),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Fe=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Ae=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Ve(t,e),t.prototype.render=function(){var e,t=this.props,n=t.className,r=t.badge,s=t.size,o=t.color,a=t.badgeAlign,c=t.badgeVertical,u=t.children,l=f(n,"va-badge",s&&"va-badge-"+s,"va-badge-"+(o||"secondary"),a&&"va-badg-"+a,c&&"va-badg-"+c);return r&&(e=i.createElement("b",null,r)),i.createElement("div",{className:l},u,e)},t=Fe([$.a],t)}(i.Component),n(143),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Ie=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t.prototype.render=function(){var e,t,n,r=this.props,s=r.className,o=r.left,a=r.children,c=r.right,u=r.onClick;return void 0!==o&&(e=i.createElement("header",null,o)),void 0!==c&&(t=i.createElement("footer",null,c)),void 0!==u&&(n="cursor-pointer"),i.createElement("div",{className:f("va-lmr",s,n),onClick:u},e,i.createElement("div",null,a),t)},t=Ie([$.a],t)}(i.Component),Te=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Te(t,e),t.prototype.render=function(){var e=this.props,t=e.name,n=e.className,r=e.size,s=e.spin,o=e.fixWidth,a=e.border,c=e.pull,u=e.pulse,l=e.rotate,h=e.flip,d=e.inverse,p=f(n,"fa",t&&"fa-"+t,r&&"fa-"+r,o&&"fa-fw",a&&"fa-border",c&&"fa-pull-"+c,s&&"fa-spin",u&&"fa-pulse",l&&"fa-rotate-"+l,h&&"fa-flip-"+h,d&&"fa-inverse");return i.createElement("i",{className:p})},t}(i.Component),Me=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Te(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.size,r=e.children,s=f("fa-stack",t,n&&"fa-"+n);return i.createElement("span",{className:s},r)}}(i.Component),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Le=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Me(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,n=e.iconClass,r=e.text,s=e.textClass;return i.createElement("div",{className:"py-2"},i.createElement(qe,{className:n,name:t,fixWidth:!0}),i.createElement("span",{className:s},r))}}(i.Component),function(e){return i.createElement("small",{className:f("text-muted",e.className),style:e.style},e.children)}),Ue=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Be={width:"4rem",height:"4rem"},De=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Ue(t,e),t.prototype.render=function(){var e,t=this.props,n=t.icon,r=t.main,s=t.discription,o=t.px,a=t.py;e="string"===typeof s?i.createElement("div",null,s):s;var c=n;"string"===typeof n&&(c=i.createElement("img",{className:"d-flex mr-3",src:n,alt:"img",style:Be}));var u=f("media",void 0===o?"px-0":"px-"+o,void 0===a?"py-2":"py-"+a);return i.createElement("div",{className:u},c,i.createElement("div",{className:"media-body"},i.createElement("h5",{className:"mt-0"},r),e))}}(i.Component),n(145),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),He=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},$e=function(e){function t(t){var n=e.call(this,t)||this;return n.state={pressed:!1},n}return De(t,e),t.prototype.render=function(){var e,t,n,r,s,o,a=this.props,c=(a.date,a.main),u=a.vice,l=a.middle,h=a.midSize,d=a.icon,p=a.unread,v=a.right,m=a.onClick;if(void 0!==p){var y=void 0;(y="number"===typeof p?p:p.get())>0?n=i.createElement("b",null,y):y<0&&(n=i.createElement("b",{className:"dot"}))}switch(typeof d){case"object":e=i.createElement("header",null,d,n),t=!1;break;case"string":e=i.createElement("header",{className:"icon"},i.createElement("img",{src:d}),n),t=!0}if(void 0!==l)switch(typeof l){case"string":r=i.createElement("div",{style:{flex:h}},l);break;default:r=l}void 0!==v&&(s="string"===typeof v?i.createElement("footer",null,i.createElement("small",{className:"text-muted"},v)):i.createElement("footer",null,v)),void 0!==u&&(o=i.createElement("span",null,u));var b=f("va-row",{icon:t,pressed:this.state.pressed},{"va-action":void 0!==m});return i.createElement("li",{className:b,onClick:m},e,i.createElement("div",null,i.createElement("div",null,c),o),r,s)},t=He([$.a],t)}(i.Component),We=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ze=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Ke=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}We(t,e),t.prototype.render=function(){var e,t,n=this,r=this.props,s=r.header,o=r.items,a=r.beforeLoad,c=r.none,u=r.renderRow,l=r.className,h=r.footer,d=r.itemClick,p=r.converter,v=f(l,"va-list");return e=void 0===o?null===a?null:i.createElement("li",{className:"empty"},a||"..."):0===o.length?i.createElement("li",{className:"empty"},c||"[none]"):void 0!==u?o.map(function(e,t){return u(e,t,n.props.ex)}):o.map(function(e,t){var n,r=e.onClick;if(void 0===r&&void 0!==d&&(r=function(){return d(e)}),void 0!==p){if(void 0===(n=p(e)))return null}else n=Qe({},e);return void 0===n.key&&(n.key=n.main),i.createElement($e,Qe({onClick:r},n))}),void 0!==s&&(t="string"===typeof s?i.createElement("div",{className:"va-list-header"},s):s),i.createElement("div",{className:v},t,i.createElement("ul",null,e),h)},t=ze([$.a],t)}(i.Component),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Je=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},Ge=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},Ye=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=function(e){n.key=e.target.value,void 0!==n.key&&(n.key=n.key.trim()),n.setState({disabled:!n.key})},n.ref=function(e){n.input=e,n.key=n.props.initKey||"",null!==e&&(e.value=n.key)},n.onSubmit=function(e){return Je(n,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:return e.preventDefault(),this.key?(this.input&&(this.input.disabled=!0),[4,this.props.onSearch(this.key)]):[2];case 1:return t.sent(),this.input&&(this.input.disabled=!1),[2]}})})},n.state={disabled:!1},n}return Ke(t,e),t.prototype.render=function(){var e,t,n=this.props,r=n.className,s=n.label,o=n.placeholder,a=n.buttonText,c=n.maxLength;switch(n.size){default:case"sm":e="input-group-sm";break;case"md":e="input-group-md";break;case"lg":e="input-group-lg"}return void 0!==s&&(t=i.createElement("label",{className:"input-group-addon"},s)),i.createElement("form",{className:r,onSubmit:this.onSubmit},i.createElement("div",{className:f("input-group",e)},t,i.createElement("input",{onChange:this.onChange,type:"text",name:"key",ref:this.ref,className:"form-control",placeholder:o,maxLength:c}),i.createElement("div",{className:"input-group-append"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.state.disabled},i.createElement("i",{className:"fa fa-search"}),i.createElement("i",{className:"fa"}),a))))},t}(i.Component),Xe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ze=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},et=(function(e){function t(t){var n=e.call(this,t)||this;return n.values={},n.stepViews=[],n.state={topView:void 0,stepViews:[]},n.onPrev=n.onPrev.bind(n),n.onNext=n.onNext.bind(n),n}Xe(t,e),t.prototype.setStep=function(e){var t=this.props.steps[e];if(void 0!==t){var n,r;void 0!==this.topView&&this.stepViews.push(this.topView),this.stepViews.length>0&&(n=i.createElement(et,{prefix:"undo",text:"\u4e0a\u4e00\u6b65"}),r=this.onPrev);var s=this.props,o=(s.header,s.footer,void 0===t.next?{prefix:"cloud-upload",text:this.props.submitButton||"\u63d0\u4ea4"}:{suffix:"arrow-right",text:"\u4e0b\u4e00\u6b65"}),a={formRows:t.formRows,submitButton:i.createElement(et,Ze({},o)),onSubmit:this.onNext,otherButton:n,onOther:r};this.stepViews.length;this.topView={stepName:e,step:t,props:a},this.setState({topView:this.topView,stepViews:this.stepViews})}},t.prototype.componentWillMount=function(){this.setStep(this.props.first)},t.prototype.onPrev=function(e){d.assign(this.values,e),this.topView=this.stepViews.pop(),this.setState({topView:this.topView,stepViews:this.stepViews})},t.prototype.onNext=function(e){d.assign(this.values,e);var t,n=this.topView.step.next;if(void 0===n)return this.props.onSubmit(this.values);t="string"===typeof n?n:n(this.values),this.setStep(t)},t.prototype.render=function(){var e=this.props,t=e.className,n=e.header,r=e.footer,s=this.state,o=s.topView,a=s.stepViews,c=o.stepName,u=o.step,l=a.length+1;return i.createElement("div",{className:t},i.createElement("div",null,n&&n(u,l),i.createElement(pe,Ze({key:c,initValues:this.values},o.props)),r&&r(u,l)))}}(i.Component),function(e){var t,n,r=e.prefix,s=(e.text,e.suffix);return void 0!==r&&(t=i.createElement("i",{className:f("fa","fa-"+r)})),void 0!==s&&(n=i.createElement("i",{className:f("fa","fa-"+s)})),i.createElement(i.Fragment,null,t," ",e.text," ",n)}),tt=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},nt=function(){function e(e){this.list=e}return Object.defineProperty(e.prototype,"isPaged",{get:function(){var e=this.list.props.items;return null!==e&&void 0!==e&&!1===Array.isArray(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){var e=this.list.props.items;return null===e?null:void 0!==e?!0===Array.isArray(e)?e:e.items:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loading",{get:function(){var e=this.list.props.items;if(null===e)return!1;if(void 0===e)return!0;var t=e;return void 0!==t.items&&t.loading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItems",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.updateProps=function(e){},e.prototype.renderContent=function(e,t){var n=this.list.props.item.render;return void 0===n?i.createElement("div",{className:"px-3 py-2"},JSON.stringify(e)):n(e,t)},tt([s.d],e.prototype,"loading",null),e}(),rt=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return rt(t,e),t.prototype.render=function(e,t){var n=this.list.props.item,r=n.className,s=n.key,o=n.onClick;return i.createElement("li",{key:void 0===s?t:s(e),className:f("va-row-clickable",r),onClick:function(){return o(e)}},this.renderContent(e,t))},t}(nt),st=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return st(t,e),t.prototype.render=function(e,t){var n=this.list.props.item,r=n.className,s=n.key;n.render;if("string"===typeof e){var o=f("va-list-gap","px-3","pt-1");return i.createElement("li",{key:ae(),className:o},e)}return i.createElement("li",{key:void 0===s?t:s(e),className:f(r)},this.renderContent(e,t))},t}(nt),at=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return at(t,e),t.prototype.buildItems=function(){console.log("buildItems in selectable.tsx");var e,t=this.list.props,n=t.items,r=t.selectedItems,i=t.compare;return void 0===n?this._items=void 0:null===n?this._items=null:(e=!0===Array.isArray(n)?n:n.items,this._selectedItems=r,this._items=void 0===r?e.map(function(e){return{selected:!1,item:e,labelId:ae()}}):void 0===i?e.map(function(e){return{selected:void 0!==r.find(function(t){return t===e}),item:e,labelId:ae()}}):e.map(function(e){return{selected:void 0!==r.find(function(t){return i(e,t)}),item:e,labelId:ae()}}))},Object.defineProperty(t.prototype,"items",{get:function(){return this.buildItems(),this._items},enumerable:!0,configurable:!0}),t.prototype.updateProps=function(e){e.selectedItems!==this._selectedItems&&this.buildItems()},t.prototype.onSelect=function(e,t){e.selected=t;var n=this._items.some(function(e){return e.selected});this.list.props.item.onSelect(e.item,t,n)},Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this._items.filter(function(e){return!0===e.selected}).map(function(e){return e.item})},enumerable:!0,configurable:!0}),t.prototype.render=function(e,t){var n=this,r=this.list.props.item,s=r.className,o=r.key,a=(r.render,r.onSelect,e.labelId),c=e.selected;return i.createElement("li",{key:void 0===o?t:o(e),className:f(s)},i.createElement("div",{className:"d-flex align-items-center px-3"},i.createElement("input",{ref:function(e){e&&(n.input=e,e.checked=c)},className:"",type:"checkbox",value:"",id:a,defaultChecked:c,onChange:function(t){n.onSelect(e,t.target.checked)}}),i.createElement("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:a},this.renderContent(e.item,t))))},ct([s.d],t.prototype,"items",null),t}(nt),lt=(n(147),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),ht=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},dt=function(e){function t(t){var n=e.call(this,t)||this;n._$scroll=function(e){console.log("############### items scroll to "+e)};var r=n.props.item,i=r.onClick,s=r.onSelect;return n.listBase=void 0!==s?new ut(n):void 0!==i?new it(n):new ot(n),n}return lt(t,e),t.prototype.componentWillUpdate=function(e,t,n){this.listBase.updateProps(e)},Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this.listBase.selectedItems},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.header,s=t.footer,o=t.before,a=t.loading,c=t.none;t.item,t.selectedItems;void 0===o&&(o="before"),void 0===a&&(a="loading"),void 0===c&&(c="none");var u,l=this.listBase,h=(l.isPaged,l.items);l.loading;function d(e,t){if(e)switch(typeof e){default:case"string":return i.createElement("li",{className:"va-list-"+t},e);case"function":return i.createElement("li",{className:"va-list-"+t},e());case"object":return i.createElement("li",null,e)}}return u=null===h?d(o,"before"):void 0===h?d(a,"loading"):0===h.length?d(c,"none"):h.map(function(t,n){return e.listBase.render(t,n)}),i.createElement("ul",{className:p()("va-list",n)},d(r,"header"),u,d(s,"footer"))},t=ht([$.a],t)}(i.Component);n.d(t,"a",function(){return be}),n.d(t,"c",function(){return Re}),n.d(t,"b",function(){return qe}),n.d(t,"e",function(){return Le}),n.d(t,"f",function(){return Ye}),n.d(t,"d",function(){return dt})},,,,function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u});var r=n(7),i=n(47),s=n(64),o=n(65),a=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class c extends o.a{constructor(e,t,n,r){super(e,r),Object.setPrototypeOf(this.x,e.x);let{name:i,typeName:o}=t;this.entity=t,this.ui=n,this.label=this.res.label||i,this.icon=s.a[o]}beforeStart(){const e=e=>super[e];return a(this,void 0,void 0,function*(){return!1!==(yield e("beforeStart").call(this))&&(yield this.entity.loadSchema(),!0)})}createForm(e,t,n){let r=this.buildFormOptions(n),s=new i.b(r,e);return s.setValues(t),s}buildFormOptions(e){let t,n,r,s,o,{fields:a,arrFields:c}=this.entity;void 0!==this.res&&(t=this.res.none,n=this.res.submit,r=this.res.arrNew,s=this.res.arrEdit,o=this.res.arrTitleNewButton),void 0===t&&(t=this.cUsq.res.none||"none"),void 0===n&&(n=this.cUsq.res.submit||"Submit"),void 0===r&&(r=this.cUsq.res.arrNew||"New"),void 0===s&&(s=this.cUsq.res.arrEdit||"Edit"),void 0===o&&(o=this.cUsq.res.arrTitleNewButton),void 0===e&&(e=i.a.new);let u=this.ui.form;return{fields:a,arrs:c,ui:u,res:this.res||{},inputs:this.buildInputs(u),none:t,submitCaption:n,arrNewCaption:r,arrEditCaption:s,arrTitleNewButton:o,mode:e}}buildInputs(e){let{fields:t,arrFields:n}=this.entity,r={};if(this.buildFieldsInputs(r,t,void 0,e),void 0!==n)for(let i of n){let{name:t,fields:n}=i,s=e&&e.items;this.buildFieldsInputs(r,n,t,s&&s[t])}return r}buildFieldsInputs(e,t,n,r){if(void 0!==n){let t=e[n];void 0===t&&(e[n]=t={},e=t)}for(let i of t){let{name:t,_tuid:s}=i;if(void 0===s)continue;let o=r&&r.items&&r.items[t];e[t]={select:this.buildSelect(i,n,o),content:this.buildContent(i,n),placeHolder:this.cUsq.getTuidPlaceHolder(s)}}}buildSelect(e,t,n){return(e,t,r)=>a(this,void 0,void 0,function*(){let{_tuid:r,_ownerField:i}=t,s=this.cUsq.cTuidSelect(r),o=void 0;void 0!==i&&(o=e.getValue(i.name)),n&&!0===n.autoList&&(console.log("select search set param=empty string"),o="");let a=yield s.call(o);if(s.removeCeased(),void 0===a)return;let c=s.idFromItem(a);return r.useId(c),c})}buildContent(e,t){}cQuerySelect(e){return this.cUsq.cQuerySelect(e)}}class u extends r.h{constructor(e){super(e),this.entity=e.entity,this.ui=e.ui}get label(){return this.controller.label}createForm(e,t,n){return this.controller.createForm(e,t,n)}}},,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return E}),n.d(t,"a",function(){return N}),n.d(t,"c",function(){return _});var r=n(6),i=n.n(r),s=n(12),o=n(14),a=n(16),c=n(15),u=n(17),l=n(25),h=n(5),d=n(21),f=(n(73),n(41)),p=n(89),v=n(90),m=n(33),y=n(44),b=n(37),w=(n(109),n(111),n(113),n(36)),g=n(42),k=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},x=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},E=new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent)?{minHeight:"3em"}:void 0,O=(n(95),[]),C=1,N=function(t){function n(e){var t;return Object(s.a)(this,n),(t=Object(a.a)(this,Object(c.a)(n).call(this,e))).waitCount=0,t.isHistoryBack=!1,t.clearError=function(){t.setState({fetchError:void 0})},t.back=t.back.bind(Object(l.a)(Object(l.a)(t))),t.navBack=t.navBack.bind(Object(l.a)(Object(l.a)(t))),t.stack=[],t.state={stack:t.stack,wait:0,fetchError:void 0},t}return Object(u.a)(n,t),Object(o.a)(n,[{key:"componentWillMount",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.addEventListener("popstate",this.navBack);case 1:case"end":return e.stop()}},e,this)}))}},{key:"componentDidMount",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_.set(this),void 0===(t=this.props.start)){e.next=7;break}return e.next=5,t();case 5:e.next=9;break;case 7:return e.next=9,_.start();case 9:case"end":return e.stop()}},e,this)}))}},{key:"startWait",value:function(){var t=this;0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=e.setTimeout(function(){t.waitTimeHandler=void 0,t.setState({wait:2})},1e3)),++this.waitCount,this.setState({fetchError:void 0})}},{key:"endWait",value:function(){var e=this;setTimeout(function(){--e.waitCount,0===e.waitCount&&(void 0!==e.waitTimeHandler&&(clearTimeout(e.waitTimeHandler),e.waitTimeHandler=void 0),e.setState({wait:0}))},100)}},{key:"onError",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(n=e.error)||!0!==n.unauthorized){t.next=5;break}return t.next=4,_.showLogin();case 4:return t.abrupt("return");case 5:this.setState({fetchError:e});case 6:case"end":return t.stop()}},t,this)}))}},{key:"show",value:function(e,t){this.clear(),this.push(e,t)}},{key:"push",value:function(e,t){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null),this.stack.push({key:C++,view:e,ceased:!1,disposer:t}),this.refresh()}},{key:"replace",value:function(e,t){var n=void 0,r=this.stack;r.length>0&&(n=r.pop()),this.stack.push({key:C++,view:e,ceased:!1,disposer:t}),void 0!==n&&this.dispose(n.disposer),this.refresh()}},{key:"ceaseTop",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack.length-1,n=0;n<e&&!(t<0);n++,t--){this.stack[t].ceased=!0}}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack,n=t.length;if(!(e<=0||n<=1)){n<e&&(e=n);for(var r=0,i=0;i<e&&0!==t.length;i++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}}},{key:"removeCeased",value:function(){for(;;){var e=this.stack.length-1;if(e<0)break;if(!1===this.stack[e].ceased)break;var t=this.stack.pop().disposer;this.dispose(t)}this.refresh()}},{key:"popAndDispose",value:function(){this.removeCeased();var e=this.stack.pop();if(void 0!==e){var t=e.disposer;return this.dispose(t),this.removeCeased(),e}}},{key:"dispose",value:function(e){void 0!==e&&(void 0===this.stack.find(function(t){return t.disposer===e})&&e())}},{key:"clear",value:function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose();this.refresh()}},{key:"regConfirmClose",value:function(e){var t=this.stack,n=t.length;0!==n&&(t[n-1].confirmClose=e)}},{key:"navBack",value:function(){_.log("backbutton pressed - nav level: "+this.stack.length),this.isHistoryBack=!0,this.back(!0),this.isHistoryBack=!1}},{key:"back",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return x(this,void 0,void 0,i.a.mark(function t(){var n,r,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.stack,0!==(r=n.length)){t.next=4;break}return t.abrupt("return");case 4:if(1!==r){t.next=7;break}return self!=window.top&&window.top.postMessage({type:"pop-app"},"*"),t.abrupt("return");case 7:if(s=n[r-1],!0!==e||!s.confirmClose){t.next=16;break}return t.next=11,s.confirmClose();case 11:if(t.t0=t.sent,!0!==t.t0){t.next=14;break}this.pop();case 14:t.next=17;break;case 16:this.pop();case 17:case"end":return t.stop()}},t,this)}))}},{key:"confirmBox",value:function(e){return window.confirm(e)}},{key:"render",value:function(){var e=this.state,t=e.wait,n=e.fetchError,r=this.state.stack,i=r.length-1,s=null,o=null;switch(t){case 1:s=h.createElement("li",{className:"va-wait va-wait1"});break;case 2:s=h.createElement("li",{className:"va-wait va-wait2"},h.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw"}),h.createElement("span",{className:"sr-only"},"Loading..."))}return n&&(o=h.createElement(v.a,Object.assign({clearError:this.clearError},n))),h.createElement("ul",{className:"va"},r.map(function(e,t){var n=e.key,r=e.view;return h.createElement("li",{key:n,style:t<i?{visibility:"hidden"}:void 0},r)}),s,o)}},{key:"refresh",value:function(){this.setState({stack:this.stack})}},{key:"level",get:function(){return this.stack.length}}]),n}(h.Component);function P(e){return void 0===e?{url:void 0,ws:void 0}:{url:"http://"+e+"/",ws:"ws://"+e+"/tv/"}}function j(){return x(this,void 0,void 0,i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=P("101.200.46.56"),n=P(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_CENTER_DEBUG_HOST||b.e),!0!==document.location.hash.includes("sheet_debug")){e.next=5;break}return e.abrupt("return",n);case 5:e.next=18;break;case 11:return e.sent,console.log("connected"),e.abrupt("return",n);case 16:e.prev=16,e.t0=e.catch(7);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,this,[[7,16]])}))}var S=function(){function e(){Object(s.a)(this,e),this.local=new y.a,this.user=void 0;var t=navigator.languages&&navigator.languages[0]||navigator.language;t||(this.language="zh",this.culture="CN");var n=t.split("-");this.language=n[0],n.length>1&&(this.culture=n[1])}return Object(o.a)(e,[{key:"set",value:function(e){this.nav=e}},{key:"registerReceiveHandler",value:function(e){if(void 0!==this.ws)return this.ws.onWsReceiveAny(e)}},{key:"unregisterReceiveHandler",value:function(e){void 0!==this.ws&&void 0!==e&&this.ws.endWsReceive(e)}},{key:"onReceive",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.ws){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.ws.receive(e);case 4:case"end":return t.stop()}},t,this)}))}},{key:"start",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t,n,r,s,o,a,c,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _.push(h.createElement(f.a,{header:!1},h.createElement("div",{style:{height:"100%"},className:"d-flex flex-fill align-items-center justify-content-center"},h.createElement("div",{className:"d-flex align-items-center justify-content-center slide text-info",style:{width:"5em",height:"2em"}},"\u52a0\u8f7d\u4e2d...")))),e.next=3,j();case 3:if(t=e.sent,n=t.url,r=t.ws,Object(b.m)(n),this.wsHost=r,s=document.location.hash,console.log("url=%s hash=%s",document.location.origin,s),this.isInFrame=void 0!==s&&""!==s&&s.startsWith("#tv"),!0!==this.isInFrame){e.next=18;break}if(void 0===(o=Object(m.h)(s))){e.next=18;break}return this.ws=w.d,console.log("this.ws = wsBridge in sub frame"),self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:o.hash},"*"),e.abrupt("return");case 18:if(a=this.local.device.get(),c=this.local.user.get(),void 0===a&&(a=Object(g.a)(),this.local.device.set(a),c=void 0),void 0!==c&&c.device===a){e.next=31;break}if(void 0===(u=this.nav.props.notLogined)){e.next=28;break}return e.next=26,u();case 26:e.next=30;break;case 28:return e.next=30,_.showLogin();case 30:return e.abrupt("return");case 31:return e.next=33,_.logined(c);case 33:case"end":return e.stop()}},e,this)}))}},{key:"showAppView",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.nav.props.onLogined)){e.next=4;break}return _.push(h.createElement("div",null,"NavView has no prop onLogined")),e.abrupt("return");case 4:return e.next=6,t();case 6:console.log("logined: AppView shown");case 7:case"end":return e.stop()}},e,this)}))}},{key:"logined",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(this.ws=new b.d(this.wsHost,e.token)).connect(),console.log("logined: %s",JSON.stringify(e)),this.local.user.set(e),p.a.set(e.token),this.user=e,console.log("ws.connect() in app main frame"),t.next=9,this.showAppView();case 9:case"end":return t.stop()}},t,this)}))}},{key:"showLogin",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){var r,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(1).then(n.bind(null,161));case 2:r=t.sent,s=h.createElement(r.default,{withBack:e}),!0!==e&&(this.nav.clear(),this.pop()),this.nav.push(s);case 6:case"end":return t.stop()}},t,this)}))}},{key:"logout",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.local.logoutClear(),this.user=void 0,Object(b.h)(),Object(m.f)(),Object(b.l)(void 0),this.ws=void 0,!0!==e){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,this.showLogin();case 10:case"end":return t.stop()}},t,this)}))}},{key:"startWait",value:function(){this.nav.startWait()}},{key:"endWait",value:function(){this.nav.endWait()}},{key:"onError",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.nav.onError(e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"show",value:function(e,t){this.nav.show(e,t)}},{key:"push",value:function(e,t){this.nav.push(e,t)}},{key:"replace",value:function(e,t){this.nav.replace(e,t)}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.nav.pop(e)}},{key:"clear",value:function(){this.nav.clear()}},{key:"navBack",value:function(){this.nav.navBack()}},{key:"ceaseTop",value:function(e){this.nav.ceaseTop(e)}},{key:"removeCeased",value:function(){this.nav.removeCeased()}},{key:"back",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return x(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.nav.back(e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"regConfirmClose",value:function(e){this.nav.regConfirmClose(e)}},{key:"confirmBox",value:function(e){return this.nav.confirmBox(e)}},{key:"navToApp",value:function(e,t,n,r,i){var s=this,o=!0===Object(b.f)().includes("http://localhost:")?"sheet_debug":"sheet",a=void 0===i?Object(m.a)(e,t):Object(m.a)(e,t,o,[n,r,i]);console.log("navToApp: %s",JSON.stringify(a)),_.push(h.createElement("article",{className:"app-container"},h.createElement("span",{id:a.hash,onClick:function(){return s.back()},style:E},h.createElement("i",{className:"fa fa-arrow-left"})),h.createElement("iframe",{src:a.url})))}},{key:"navToSite",value:function(e){window.open(e)}},{key:"log",value:function(e){O.push(e)}},{key:"level",get:function(){return this.nav.level}},{key:"logs",get:function(){return O}}]),e}();k([d.k],S.prototype,"user",void 0);var _=new S}).call(this,n(32))},function(e,t,n){"use strict";var r=n(50);n.o(r,"CApp")&&n.d(t,"CApp",function(){return r.CApp}),n.o(r,"CMap")&&n.d(t,"CMap",function(){return r.CMap}),n.o(r,"CQuery")&&n.d(t,"CQuery",function(){return r.CQuery}),n.o(r,"CTuidMain")&&n.d(t,"CTuidMain",function(){return r.CTuidMain}),n.o(r,"ControllerUsq")&&n.d(t,"ControllerUsq",function(){return r.ControllerUsq}),n.o(r,"VEntity")&&n.d(t,"VEntity",function(){return r.VEntity}),n.o(r,"VMapMain")&&n.d(t,"VMapMain",function(){return r.VMapMain}),n.o(r,"VQueryMain")&&n.d(t,"VQueryMain",function(){return r.VQueryMain}),n.o(r,"VTuidMain")&&n.d(t,"VTuidMain",function(){return r.VTuidMain}),n.o(r,"tv")&&n.d(t,"tv",function(){return r.tv})},function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return u});var r=n(3),i=n(20),s=n(26);class o{render(e){return void 0===this.view?r.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):r.createElement(this.view,{vm:this,className:e})}}const a=(e,t)=>r.createElement(r.Fragment,null,"content: ",Object(s.a)(e)),c=Object(i.a)(a),u=e=>r.createElement("div",{className:"px-3 py-2"},Object(s.a)(e))},,function(e,t,n){"use strict";function r(e,t){switch(e.substr(0,1)){default:return t;case"$":case"_":return}}function i(e){return JSON.stringify(e,r," ")}var s=n(3),o=n(20),a=n(51);const c=Object(o.a)(({tuidValue:e,ui:t,x:n,nullUI:r})=>{let i=typeof e;switch(i){default:return void 0===t?s.createElement(s.Fragment,null,i,"-",e):t(e,n);case"undefined":return void 0===r?s.createElement(s.Fragment,null,"null"):r();case"object":return null===e?void 0===r?s.createElement(s.Fragment,null,"null"):r():function(e,t,n){let{id:r,_$tuid:i,_$com:o}=e,c=i;if(void 0===c)return void 0!==t?t(e,n):Object(a.PureJSONContent)(e,n);let u=t||o;void 0===u&&(u=e._$com=c.getTuidContent());let l=c.valueFromId(r);return"number"===typeof l&&(l={id:l}),void 0!==t?t(l,n):s.createElement(u,l)}(e,t,n);case"number":return s.createElement(s.Fragment,null,"id...",e)}}),u=(e,t,n,r)=>s.createElement(c,{tuidValue:e,ui:t,x:n,nullUI:r});n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u})},,,,,,,function(e,t,n){"use strict";n.d(t,"f",function(){return m}),n.d(t,"g",function(){return b}),n.d(t,"d",function(){return w}),n.d(t,"h",function(){return O}),n.d(t,"a",function(){return C}),n.d(t,"e",function(){return N}),n.d(t,"b",function(){return P}),n.d(t,"c",function(){return S});var r=n(6),i=n.n(r),s=n(12),o=n(14),a=n(27),c=n.n(a),u=n(46),l=n(42),h=n(38),d=n(36),f=n(43),p=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},v={};function m(){for(var e in v)v[e]=void 0}var y={},b=new(function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"unit",get:function(){return this._unit},set:function(e){this._unit=e}}]),e}());function w(){return self!==window.parent}function g(e){var t,n,r=e.data,i=e.source;Object(d.c)(i),t=r.hash,void 0!==(n=document.getElementById(t))&&(n.hidden=!0);var s=c.a.clone(u.h.user);s.type="init-sub-win",i.postMessage(s,"*")}function k(e){return p(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("initSubWin: set nav.user",e),u.h.user=e,t.next=4,u.h.showAppView();case 4:case"end":return t.stop()}},t,this)}))}function x(e,t){return p(this,void 0,void 0,i.a.mark(function n(){var r,s,o,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==(r=y[e])){n.next=3;break}return n.abrupt("return",{name:t,url:void 0,urlDebug:void 0,token:void 0});case 3:return s=r.unit,o=t.split("/"),n.next=7,h.k.usq({unit:s,usqOwner:o[0],usqName:o[1]});case 7:if(void 0!==(a=n.sent)){n.next=11;break}throw console.log("apiTokenApi.api return undefined. api=%s, unit=%s",t,s),"api not found";case 11:return n.abrupt("return",{name:t,url:a.url,urlDebug:a.urlDebug,token:a.token});case 12:case"end":return n.stop()}},n,this)}))}function E(e){return p(this,void 0,void 0,i.a.mark(function t(){var n,r,s,o,a,c;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.apiName,r=e.url,s=e.urlDebug,o=e.token,void 0!==(a=v[n])){t.next=4;break}throw"error app api return";case 4:return t.next=6,Object(f.b)(r,s);case 6:c=t.sent,console.log("onAppApiReturn(message:any): url="+r+", debug="+s+", real="+c),a.url=c,a.token=o,a.resolve(a);case 11:case"end":return t.stop()}},t,this)}))}function O(e){var t=e.split("-"),n=t.length;return b.hash=t[0].substr(3),n>0&&(b.unit=Number(t[1])),n>1&&(b.page=t[2]),n>2&&(b.param=t.slice(3)),b}function C(e,t,n,r){for(var i;;){if(i=Object(l.a)(),void 0===y[i]){y[i]={hash:i,unit:t};break}}if(e+="#tv"+i+"-"+t,void 0!==n&&(e+="-"+n,void 0!==r))for(var s=0;s<r.length;s++)e+="-"+r[s];return{url:e,hash:i}}function N(e,t){return p(this,void 0,void 0,i.a.mark(function n(){var r,s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=new h.b("tv/",void 0),s=b.unit,n.next=4,r.usqs(s,e,t);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}},n,this)}))}function P(e,t,n){return p(this,void 0,void 0,i.a.mark(function r(){var s,o,a,c,u,l=this;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===(s=v[e])){r.next=3;break}return r.abrupt("return",s);case 3:if(w()){r.next=19;break}return r.next=6,h.k.usq({unit:b.unit,usqOwner:t,usqName:n});case 6:if(void 0!==(s=r.sent)){r.next=10;break}throw"unauthorized call: usqTokenApi center return undefined!","unauthorized call: usqTokenApi center return undefined!";case 10:return void 0===s.token&&(s.token=h.f),a=(o=s).url,c=o.urlDebug,r.next=14,Object(f.b)(a,c);case 14:return u=r.sent,console.log("realUrl: %s",u),s.url=u,v[e]=s,r.abrupt("return",s);case 19:return console.log("appApi parent send: %s",b.hash),s={name:e,url:void 0,urlDebug:void 0,token:void 0,resolve:void 0,reject:void 0},v[e]=s,r.abrupt("return",new Promise(function(t,n){s.resolve=function(e){return p(l,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e;case 2:r=n.sent,console.log("return from parent window: %s",JSON.stringify(r)),s.url=r.url,s.urlDebug=r.urlDebug,s.token=r.token,t(s);case 8:case"end":return n.stop()}},n,this)}))},s.reject=n,(window.opener||window.parent).postMessage({type:"app-api",apiName:e,hash:b.hash},"*")}));case 23:case"end":return r.stop()}},r,this)}))}window.addEventListener("message",function(e){return p(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.data,t.t0=n.type,t.next="sub-frame-started"===t.t0?4:"ws"===t.t0?6:"init-sub-win"===t.t0?9:"pop-app"===t.t0?12:"center-api"===t.t0?14:"center-api-return"===t.t0?17:"app-api"===t.t0?19:"app-api-return"===t.t0?26:31;break;case 4:return g(e),t.abrupt("break",33);case 6:return t.next=8,u.h.onReceive(n.msg);case 8:return t.abrupt("break",33);case 9:return t.next=11,k(n);case 11:return t.abrupt("break",33);case 12:return u.h.navBack(),t.abrupt("break",33);case 14:return t.next=16,_(e.source,n);case 16:return t.abrupt("break",33);case 17:return V(n),t.abrupt("break",33);case 19:return console.log("receive PostMessage: %s",JSON.stringify(n)),t.next=22,x(n.hash,n.apiName);case 22:return r=t.sent,console.log("onReceiveAppApiMessage: %s",JSON.stringify(r)),e.source.postMessage({type:"app-api-return",apiName:n.apiName,url:r.url,urlDebug:r.urlDebug,token:r.token},"*"),t.abrupt("break",33);case 26:return console.log("app-api-return: %s",JSON.stringify(n)),console.log("await onAppApiReturn(message);"),t.next=30,E(n);case 30:return t.abrupt("break",33);case 31:return this.console.log("message: %s",JSON.stringify(n)),t.abrupt("break",33);case 33:case"end":return t.stop()}},t,this)}))});var j={};function S(e,t,n){return p(this,void 0,void 0,i.a.mark(function r(){var s=this;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("bridgeCenterApi: url=%s, method=%s",e,t),r.next=3,new Promise(function(r,o){return p(s,void 0,void 0,i.a.mark(function s(){var a;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=Object(l.a)(),void 0!==j[a]){i.next=5;break}return j[a]={id:a,resolve:r,reject:o},i.abrupt("break",7);case 5:i.next=0;break;case 7:(window.opener||window.parent).postMessage({type:"center-api",callId:a,url:e,method:t,body:n},"*");case 8:case"end":return i.stop()}},s,this)}))});case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},r,this)}))}function _(e,t){return p(this,void 0,void 0,i.a.mark(function n(){var r,s,o,a,c;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.callId,s=t.url,o=t.method,a=t.body,n.next=3,h.e.directCall(s,o,a);case 3:c=n.sent,e.postMessage({type:"center-api-return",callId:r,result:c},"*");case 5:case"end":return n.stop()}},n,this)}))}function V(e){var t=e.callId,n=e.result,r=j[t];void 0!==r&&(j[t]=void 0,r.resolve(n))}},function(e,t,n){"use strict";var r=n(3),i=n(11),s=n.n(i),o=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class a{}class c extends a{constructor(e){super(),this.onClick=(()=>o(this,void 0,void 0,function*(){yield this.controller.start()})),this.view=(e=>r.createElement("div",{className:s()("px-3","py-2","align-items-center","cursor-pointer",e),onClick:this.onClick},this.icon," \xa0 ",this.label)),this.controller=e,this.icon=e.icon,this.label=e.label}render(e){return r.createElement(this.view,e)}}n.d(t,"a",function(){return c})},,function(e,t,n){"use strict";n.d(t,"c",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"d",function(){return y}),n.d(t,"a",function(){return b});var r,i=n(16),s=n(15),o=n(17),a=n(6),c=n.n(a),u=n(12),l=n(14),h=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};function d(e){void 0!==r&&r.postMessage({type:"ws",msg:e},"*")}function f(e){r=e}function p(e){window.top.postMessage({type:"ws",msg:e},"*")}var v=function(){function e(){Object(u.a)(this,e),this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}return Object(l.a)(e,[{key:"onWsReceiveAny",value:function(e){var t=this.handlerSeed++;return this.anyHandlers[t]=e,t}},{key:"onWsReceive",value:function(e,t){var n=this.handlerSeed++;return this.msgHandlers[n]={type:e,handler:t},n}},{key:"endWsReceive",value:function(e){delete this.anyHandlers[e],delete this.msgHandlers[e]}},{key:"receive",value:function(e){return h(this,void 0,void 0,c.a.mark(function t(){var n,r,i,s,o,a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.$type,t.t0=c.a.keys(this.anyHandlers);case 2:if((t.t1=t.t0()).done){t.next=8;break}return r=t.t1.value,t.next=6,this.anyHandlers[r](e);case 6:t.next=2;break;case 8:t.t2=c.a.keys(this.msgHandlers);case 9:if((t.t3=t.t2()).done){t.next=18;break}if(i=t.t3.value,s=this.msgHandlers[i],o=s.type,a=s.handler,o===n){t.next=14;break}return t.abrupt("continue",9);case 14:return t.next=16,a(e);case 16:t.next=9;break;case 18:case"end":return t.stop()}},t,this)}))}}]),e}(),m=1,y=new(function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(i.a)(this,Object(s.a)(t).apply(this,arguments))).wsBaseId="WsBridge seed "+m++,e}return Object(o.a)(t,e),t}(v)),b=function(e){function t(e,n){var r;return Object(u.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this))).wsBaseId="WSChannel seed "+m++,r.wsHost=e,r.token=n,r}return Object(o.a)(t,e),Object(l.a)(t,[{key:"connect",value:function(){var e=this;if(void 0===this.ws){var n=this;return new Promise(function(r,i){var s=new WebSocket(e.wsHost,e.token||t.centerToken);console.log("connect webSocket %s",e.wsHost),s.onopen=function(t){console.log("webSocket connected %s",e.wsHost),n.ws=s,r()},s.onerror=function(e){i("webSocket can't open!")},s.onmessage=function(t){return h(e,void 0,void 0,c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.wsMessage(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))},s.onclose=function(e){n.ws=void 0,console.log("webSocket closed!")}})}}},{key:"close",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)}},{key:"wsMessage",value:function(e){return h(this,void 0,void 0,c.a.mark(function t(){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("websocket message: %s",e.data),d(n=JSON.parse(e.data)),t.next=6,this.receive(n);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("ws msg error: ",t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}))}},{key:"sendWs",value:function(e){var t=this;this.connect().then(function(){t.ws.send(e)})}}],[{key:"setCenterToken",value:function(e){t.centerToken=e}}]),t}(v)},function(e,t,n){"use strict";var r=n(36);n.d(t,"d",function(){return r.a}),n.d(t,"j",function(){return r.b});var i=n(43);n.d(t,"k",function(){return i.c});var s=n(38);n.d(t,"a",function(){return s.a}),n.d(t,"b",function(){return s.c}),n.d(t,"c",function(){return s.d}),n.d(t,"f",function(){return s.g}),n.d(t,"h",function(){return s.h}),n.d(t,"l",function(){return s.i}),n.d(t,"m",function(){return s.j});var o=n(33);n.d(t,"i",function(){return o.g}),n.d(t,"g",function(){return o.e});var a=n(48);n.d(t,"e",function(){return a.a});n(49)},function(e,t,n){"use strict";var r=n(6),i=n.n(r),s=n(12),o=n(14),a=n(16),c=n(15),u=n(17),l=n(27),h=n(49),d=n(22),f=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},p=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"startWait",value:function(){d.c.startWait()}},{key:"endWait",value:function(){d.c.endWait()}},{key:"showError",value:function(e){return f(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return d.c.endWait(),t.next=3,d.c.onError(e);case 3:case"end":return t.stop()}},t,this)}))}}]),e}(),v=n(33),m=n(43);n.d(t,"h",function(){return g}),n.d(t,"d",function(){return k}),n.d(t,"c",function(){return O}),n.d(t,"j",function(){return C}),n.d(t,"g",function(){return N}),n.d(t,"f",function(){return S}),n.d(t,"i",function(){return _}),n.d(t,"a",function(){return V}),n.d(t,"k",function(){return F}),n.d(t,"e",function(){return A}),n.d(t,"b",function(){return I});var y=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},b={},w={};function g(){b={},w={},x={}}var k=function(e){function t(e,n,r,i,o){var u;return Object(s.a)(this,t),u=Object(a.a)(this,Object(c.a)(t).call(this,e,o)),r&&(u.usqOwner=n,u.usqName=r,u.usq=n+"/"+r),u.access=i,u.showWaiting=o,u}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getHttpChannel",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){var t,n,r,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===this.showWaiting||void 0===this.showWaiting?(t=b,n=new p):t=w,void 0===(r=t[this.usq])){e.next=4;break}return e.abrupt("return",r);case 4:return e.next=6,Object(v.b)(this.usq,this.usqOwner,this.usqName);case 6:return s=e.sent,this.token=s.token,r=new h.a(!1,s.url,s.token,n),e.abrupt("return",t[this.usq]=r);case 10:case"end":return e.stop()}},e,this)}))}},{key:"update",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("update");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))}},{key:"loadAccess",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===this.access?"":this.access.join("|"),e.next=3,this.get("access",{acc:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}))}},{key:"loadEntities",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("entities");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))}},{key:"schema",value:function(e){return y(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("schema/"+e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"schemas",value:function(e){return y(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.post("schema",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"tuidGet",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get("tuid/"+e+"/"+t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"tuidGetAll",value:function(e){return y(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("tuid-all/"+e+"/");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"tuidSave",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("tuid/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"tuidSearch",value:function(e,t,n,r,s,o){return y(this,void 0,void 0,i.a.mark(function a(){var c;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post("tuids/"+e,{arr:t,owner:n,key:r,pageStart:s,pageSize:o});case 2:return c=i.sent,i.abrupt("return",c);case 4:case"end":return i.stop()}},a,this)}))}},{key:"tuidArrGet",value:function(e,t,n,r){return y(this,void 0,void 0,i.a.mark(function s(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.get("tuid-arr/"+e+"/"+n+"/"+t+"/"+r);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}))}},{key:"tuidArrGetAll",value:function(e,t,n){return y(this,void 0,void 0,i.a.mark(function r(){return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.get("tuid-arr-all/"+e+"/"+n+"/"+t+"/");case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"tuidArrSave",value:function(e,t,n,r){return y(this,void 0,void 0,i.a.mark(function s(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post("tuid-arr/"+e+"/"+n+"/"+t+"/",r);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}))}},{key:"tuidArrPos",value:function(e,t,n,r,s){return y(this,void 0,void 0,i.a.mark(function o(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post("tuid-arr-pos/"+e+"/"+n+"/"+t+"/",{id:r,$order:s});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},o,this)}))}},{key:"tuidIds",value:function(e,t,n){return y(this,void 0,void 0,i.a.mark(function r(){var s,o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,s="tuidids/"+e+"/",s+=void 0!==t?t:"$",r.next=5,this.post(s,n);case 5:return o=r.sent,r.abrupt("return",o);case 9:r.prev=9,r.t0=r.catch(0),console.error(r.t0);case 12:case"end":return r.stop()}},r,this,[[0,9]])}))}},{key:"proxied",value:function(e,t,n){return y(this,void 0,void 0,i.a.mark(function r(){var s,o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,s="tuid-proxy/"+e+"/"+t+"/"+n,r.next=4,this.get(s);case 4:return o=r.sent,r.abrupt("return",o);case 8:r.prev=8,r.t0=r.catch(0),console.error(r.t0);case 11:case"end":return r.stop()}},r,this,[[0,8]])}))}},{key:"sheetSave",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("sheet/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"sheetAction",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.put("sheet/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"stateSheets",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("sheet/"+e+"/states",t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"stateSheetCount",value:function(e){return y(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("sheet/"+e+"/statecount");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"getSheet",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get("sheet/"+e+"/get/"+t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"sheetArchives",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("sheet/"+e+"/archives",t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"sheetArchive",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get("sheet/"+e+"/archive/"+t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"action",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("action/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"page",value:function(e,t,n,r){return y(this,void 0,void 0,i.a.mark(function s(){var o;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=typeof r,i.next="undefined"===i.t0?3:5;break;case 3:return o={key:""},i.abrupt("break",7);case 5:return o=l.clone(r),i.abrupt("break",7);case 7:return o.$pageStart=t,o.$pageSize=n,i.next=11,this.post("query-page/"+e,o);case 11:return i.abrupt("return",i.sent);case 12:case"end":return i.stop()}},s,this)}))}},{key:"query",value:function(e,t){return y(this,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("query/"+e,t);case 2:return r=n.sent,n.abrupt("return",r);case 4:case"end":return n.stop()}},n,this)}))}},{key:"user",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))}}]),t}(m.a),x={};var E,O=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,"tv/",void 0,void 0,void 0,!0))).unitId=e,n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getHttpChannel",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=x[this.unitId])){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,this.buildChannel();case 5:return e.abrupt("return",x[this.unitId]=e.sent);case 6:case"end":return e.stop()}},e,this)}))}},{key:"buildChannel",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){var t,n,r,s,o,a,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new p,n=new I("tv/",void 0),e.next=4,n.unitxUsq(this.unitId);case 4:return r=e.sent,s=r.token,o=r.url,a=r.urlDebug,e.next=8,Object(m.b)(o,a);case 8:return c=e.sent,this.token=s,e.abrupt("return",new h.a(!1,c,s,t));case 11:case"end":return e.stop()}},e,this)}))}}]),t}(k);function C(e){console.log("setCenterUrl %s",e),E=e,S=void 0,j=void 0,P=void 0}function N(){return E}var P,j,S=void 0;function _(e){S=e,console.log("setCenterToken %s",e),j=void 0,P=void 0}var V=function(e){function t(e,n){return Object(s.a)(this,t),Object(a.a)(this,Object(c.a)(t).call(this,e,n))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getHttpChannel",value:function(){return y(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0===this.showWaiting||void 0===this.showWaiting?void 0!==P?P:P=new h.a(!0,E,S,new p):void 0!==j?j:j=new h.a(!0,E,S));case 1:case"end":return e.stop()}},e,this)}))}}]),t}(m.a),F=new(function(e){function t(){return Object(s.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"usq",value:function(e){return y(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("app-usq",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(V))("tv/tie/",void 0),A=new(function(e){function t(){return Object(s.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"directCall",value:function(e,t,n){return this.call(e,t,n)}}]),t}(V))("",void 0);console.log("CenterApi"),console.log(V);var I=function(e){function t(){return Object(s.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"usqs",value:function(e,t,n){return y(this,void 0,void 0,i.a.mark(function r(){return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.get("tie/app-usqs",{unit:e,appOwner:t,appName:n});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"unitxUsq",value:function(e){return y(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("tie/unitx-usq",{unit:e});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(V)},,,function(e,t,n){"use strict";n.d(t,"a",function(){return x});var r=n(6),i=n.n(r),s=n(12),o=n(14),a=n(16),c=n(15),u=n(17),l=n(25),h=n(5),d=n(53),f=n(10),p=n.n(f),v=n(27),m=n.n(v),y=n(59),b=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},w=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},g=100,k=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(a.a)(this,Object(c.a)(t).apply(this,arguments))).bottomTime=0,e.topTime=0,e.onScroll=function(t){return w(Object(l.a)(Object(l.a)(e)),void 0,void 0,i.a.mark(function e(){var n,r,s,o,a,c,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.props,r=n.onScroll,s=n.onScrollTop,o=n.onScrollBottom,r&&this.props.onScroll(t),(a=t.target).scrollTop<30&&void 0!==s&&(c=(new Date).getTime())-this.topTime>g&&(this.topTime=c,s()),a.scrollTop+a.offsetHeight>a.scrollHeight-30&&void 0!==o&&(u=(new Date).getTime())-this.bottomTime>g&&(this.bottomTime=u,o());case 5:case"end":return e.stop()}},e,this)}))},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"eachChild",value:function(e,t){var n=this,r=e.props;if(void 0!==r){var i=r.children;void 0!==i&&h.Children.forEach(i,function(e,r){var i=e._$scroll;i&&i(t),console.log(e.toString()),n.eachChild(e,t)})}}},{key:"render",value:function(){return h.createElement("main",{className:this.props.className,onScroll:this.onScroll},this.props.children)}}]),t}(h.Component),x=function(e){function t(e){var n;Object(s.a)(this,t),n=Object(a.a)(this,Object(c.a)(t).call(this,e));var r,i=e.tabs;if(void 0===i||0===i.length)return Object(a.a)(n);n.tabs=i;var o=[],u=!0,l=!1,h=void 0;try{for(var d,f=i[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){var p=d.value,v=m.a.clone(p);void 0===r&&!0===v.isSelected?r=v:v.isSelected=!1,v.isMounted=!1,o.push(v)}}catch(y){l=!0,h=y}finally{try{u||null==f.return||f.return()}finally{if(l)throw h}}return n.state={cur:r,tabs:o},n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){return w(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.tabs){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==(t=this.state.tabs[0])){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.onTabClick(t);case 7:case"end":return e.stop()}},e,this)}))}},{key:"onTabClick",value:function(e){return w(this,void 0,void 0,i.a.mark(function t(){var n,r,s,o,a,c,u,l,h;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!0!==e.isSelected){t.next=2;break}return t.abrupt("return");case 2:for(r=this.state.tabs,s=!0,o=!1,a=void 0,t.prev=6,c=r[Symbol.iterator]();!(s=(u=c.next()).done);s=!0)(l=u.value)===e?(l.isSelected=!0,n=l):l.isSelected=!1;t.next=14;break;case 10:t.prev=10,t.t0=t.catch(6),o=!0,a=t.t0;case 14:t.prev=14,t.prev=15,s||null==c.return||c.return();case 17:if(t.prev=17,!o){t.next=20;break}throw a;case 20:return t.finish(17);case 21:return t.finish(14);case 22:if(!0===n.isMounted){t.next=27;break}if(void 0===(h=n.load)){t.next=27;break}return t.next=27,h();case 27:this.setState({cur:n,tabs:r});case 28:case"end":return t.stop()}},t,this,[[6,10,14,22],[15,,17,21]])}))}},{key:"renderTabs",value:function(e){var t,n=this,r=this.props,i=r.header,s=r.back,o=r.right,a=r.keepHeader,c=this.state.cur,u=h.createElement("div",null,this.state.tabs.map(function(e,t){var r,i,s,o=e.icon,a=e.isSelected,c=e.title,u=e.redDot;if(void 0!==o&&(r=h.createElement("img",{src:o})),void 0!==u){var l=u.get();l<0?(s=p()("red-dot"),i=h.createElement("u",null)):l>0&&(s=p()("red-dot","num"),i=h.createElement("u",null,l))}return h.createElement("div",{key:t,className:p()("va-tab",{cur:a}),onClick:function(){return n.onTabClick(e)}},r,h.createElement("div",{className:s},c,i))}));return!1!==i&&(t=h.createElement(y.a,{back:s,center:!0===a?i:c&&(c.header||c.title),right:o})),h.createElement("article",{className:"page-container"},t,h.createElement("section",null,this.state.tabs.map(function(e,t){var n=e.isSelected,r=e.isMounted,i=e.content;if(!0===n||!0===r)return e.isMounted=!0,h.createElement(k,{key:t,className:p()({invisible:!1===n}),onScroll:e.onScroll,onScrollTop:e.onScrollTop,onScrollBottom:e.onScrollBottom},"function"===typeof i?i():i)})),u,e)}},{key:"renderSingle",value:function(e){var t,n=this.props,r=n.back,i=n.header,s=n.right,o=n.onScroll,a=n.onScrollTop,c=n.onScrollBottom,u=n.children;return!1!==i&&(t=h.createElement(y.a,{back:r,center:i,right:s,logout:this.props.logout})),h.createElement("article",{className:"page-container"},t,h.createElement("section",null,h.createElement(k,{onScroll:o,onScrollTop:a,onScrollBottom:c},u)),e)}},{key:"render",value:function(){var e,t=this.props.footer;return void 0!==t&&(e=h.createElement("footer",null,t)),void 0!==this.tabs?this.renderTabs(e):this.renderSingle(e)}}]),t}(h.Component);x=b([d.a],x)},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=8;function s(){for(var e=r.length,t="",n=0;n<i;n++)t+=r.charAt(Math.floor(Math.random()*e));return t}},function(e,t,n){"use strict";n.d(t,"c",function(){return h}),n.d(t,"a",function(){return d}),n.d(t,"b",function(){return p});var r=n(12),i=n(14),s=n(6),o=n.n(s),a=n(44),c=n(48),u=n(73),l=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};function h(e,t,n,r,i){return l(this,void 0,void 0,o.a.mark(function s(){return o.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.fetch(t,n,r,i);case 2:case"end":return s.stop()}},s,this)}))}var d=function(){function e(t,n){Object(r.a)(this,e),this.path=t||"",this.showWaiting=n}return Object(i.a)(e,[{key:"call",value:function(e,t,n){return l(this,void 0,void 0,o.a.mark(function r(){var i;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.getHttpChannel();case 2:return i=r.sent,r.next=5,i.callFetch(e,t,n);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,this)}))}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.get(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"post",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.post(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"put",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.put(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"delete",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.delete(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}}]),e}();function f(e,t,n,r){if(e.indexOf(t)>0){var i=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"})[r]||n;e=e.replace(t,"://"+i+"/")}return e}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hello";return l(this,void 0,void 0,o.a.mark(function r(){var i,s,l,h;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!0===a.b){r.next=2;break}return r.abrupt("return",e);case 2:if(t){r.next=4;break}return r.abrupt("return",e);case 4:return r.prev=4,i=t,!1===t.endsWith("/")&&(t+="/"),t=f(t,"://centerhost/",c.a,"REACT_APP_CENTER_DEBUG_HOST"),t=f(t,"://usqhost/",c.c,"REACT_APP_USQ_DEBUG_HOST"),t=f(t,"://unitxhost/",c.c,"REACT_APP_USQ_DEBUG_HOST"),t=f(t,"://usql-server/",c.b,"REACT_APP_DEBUG_USQL_SERVER"),void 0===n&&(n=""),s=t+n,console.log("urlDebug: "+i+" ---- "+t+" === "+s),l={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},r.next=17,Object(u.a)(s,l);case 17:return h=r.sent,r.next=20,h.text();case 20:return r.sent,r.abrupt("return",t);case 24:return r.prev=24,r.t0=r.catch(4),console.log("cannot connect %s, so use %s",t,e),console.error(r.t0),r.abrupt("return",e);case 29:case"end":return r.stop()}},r,this,[[4,24]])}))}},function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return a});var r=n(12),i=n(14),s=!1,o=function(){function e(t){Object(r.a)(this,e),this.name=t}return Object(i.a)(e,[{key:"get",value:function(){if(void 0!==this.value)return this.value;var e=localStorage.getItem(this.name);return this.value=null===e?void 0:JSON.parse(e)}},{key:"set",value:function(e){e?(this.value=e,localStorage.setItem(this.name,JSON.stringify(e))):this.clear()}},{key:"clear",value:function(){this.value=void 0,localStorage.removeItem(this.name)}}]),e}(),a=function(){function e(){Object(r.a)(this,e),this.user=new o("user"),this.device=new o("device"),this.homeTabCur=new o("homeTabCur")}return Object(i.a)(e,[{key:"logoutClear",value:function(){[this.user,this.homeTabCur].map(function(e){return e.clear()})}}]),e}()},,function(e,t,n){"use strict";var r=n(22),i=(n(59),n(41)),s=n(5),o=n(12),a=n(14),c=n(16),u=n(15),l=n(17),h=n(45),d=n(10),f=(s.Component,s.Component,n(53)),p=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},v=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){this.props.formSchema.setInputValues()}},{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.children,i=t.formSchema;if(void 0===r){var o;e=[],i.inputs.forEach(function(t,n){null!==(o=i.renderSeperator(t))&&e.push(o),e.push(i.renderField(t))}),null!==(o=i.renderSeperator())&&e.push(o),e.push(i.renderButtons());var a=i.renderFormErrors();null!==a&&e.push(a)}else e=r;return s.createElement("div",{className:d("container",n)},s.createElement("form",{onSubmit:i.onSubmit},e))}}]),t}(s.Component);v=p([f.a],v);var m=n(6),y=n.n(m),b=n(21),w=n(27),g=n.n(w),k=n(58),x=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},E=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return s.createElement("span",null,this.props.err)}}]),t}(s.Component);E=x([f.a],E);var O=function(){function e(t,n){var r=this;Object(o.a)(this,e),this.field=w.clone(n),this.formSchema=t,this.id=w.uniqueId(),this.label=n.label,this.value=n.defaultValue,this.props={name:n.name,placeholder:n.placeholder,onFocus:function(){r.err=void 0,r.formSchema.errors=[]},ref:this.ref.bind(this)},this.setProps(),this.buildValidators()}return Object(a.a)(e,[{key:"parseValue",value:function(e){return e}},{key:"ref",value:function(e){this.element=e}},{key:"reset",value:function(){this.value=void 0,this.err=void 0}},{key:"clear",value:function(){this.value=void 0,this.err=void 0}},{key:"setInitValue",value:function(e){}},{key:"buildValidators",value:function(){var e=this.field.rules;if(void 0!==e)if(this.validators=[],Array.isArray(e)){var t=!0,n=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value,a=this.buildValidator(o);void 0!==a&&this.validators.push(a)}}catch(u){n=!0,r=u}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}else{var c=this.buildValidator(e);void 0!==c&&this.validators.push(c)}}},{key:"buildValidator",value:function(e){if("function"===typeof e)return e;var t=e.split(":");return this.stringValidator(t[0],t[1])}},{key:"stringValidator",value:function(e,t){switch(e){default:return;case"required":return this.required.bind(this)}}},{key:"required",value:function(e){}},{key:"defaultValue",get:function(){return this.field.defaultValue}},{key:"filled",get:function(){var e=void 0!==this.value&&this.value!==this.defaultValue;return console.log("%s value=%s default=%s ret=%s",this.field.name,this.value,this.defaultValue,e),e}}]),e}();x([b.k],O.prototype,"err",void 0),x([b.k],O.prototype,"value",void 0);var C=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"setProps",value:function(){this.props.type="text",this.props.disabled=!0,this.props.placeholder="unknown type "+this.field.type}}]),t}(O),N=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"setProps",value:function(){var e=this;this.props.type="text",this.props.value=this.value,this.props.onBlur=function(){if(void 0!==e.validators){var t=!0,n=!1,r=void 0;try{for(var i,s=e.validators[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=(0,i.value)();if(void 0!==o)return void(e.err=o)}}catch(a){n=!0,r=a}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}e.value=e.parseValue(e.element.value)}}},{key:"setInitValue",value:function(e){void 0===e&&(e=""),this.element.value=e,this.value=this.parseValue(e)}},{key:"clear",value:function(){Object(k.a)(Object(u.a)(t.prototype),"clear",this).call(this),this.element.value=this.field.defaultValue||""}},{key:"required",value:function(e){if(void 0!==this.element){var t=this.element.value;if(void 0!==t&&!(t.trim().length>0))return"\u4e0d\u80fd\u4e3a\u7a7a"}}}]),t}(O),P=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"setProps",value:function(){var e=this;Object(k.a)(Object(u.a)(t.prototype),"setProps",this).call(this),this.props.type="number",this.props.onKeyPress=function(t){var n=t.charCode;if(8===n||0===n||13===n||n>=48&&n<=57){if(void 0===e.extraChars)return;e.extraChars.indexOf(n)}else t.preventDefault()}}},{key:"stringValidator",value:function(e,n){switch(e){default:return Object(k.a)(Object(u.a)(t.prototype),"stringValidator",this).call(this,e,n);case"min":return this._min=Number(n),NaN===this._min&&(this._min=void 0),this.min.bind(this);case"max":return this._max=Number(n),NaN===this._max&&(this._max=void 0),this.max.bind(this)}}},{key:"min",value:function(e){if(void 0!==this._min){var t=this.element.value;if(void 0!==t&&0!==t.trim().length){var n=Number(t);if(NaN!==n)return n<this._min?"\u6700\u5c0f\u503c\u4e3a"+this._min:void 0}}}},{key:"max",value:function(e){if(void 0!==this._max){var t=this.element.value;if(void 0!==t&&0!==t.trim().length){var n=Number(t);if(NaN!==n)return n>this._max?"\u6700\u5927\u503c\u4e3a"+this._max:void 0}}}}]),t}(N),j=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),t}(P),S=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),t}(P),_=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),t}(P),V=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"stringValidator",value:function(e,n){switch(e){default:return Object(k.a)(Object(u.a)(t.prototype),"stringValidator",this).call(this,e,n);case"maxlength":return void(this.props.maxLength=n)}}}]),t}(N),F=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"setProps",value:function(){Object(k.a)(Object(u.a)(t.prototype),"setProps",this).call(this),this.props.type="password"}}]),t}(V),A=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"setProps",value:function(){var e=this;this.props.onBlur=function(){if(void 0!==e.validators){var t=!0,n=!1,r=void 0;try{for(var i,s=e.validators[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=(0,i.value)();if(void 0!==o)return void(e.err=o)}}catch(a){n=!0,r=a}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}e.value=e.parseValue(e.element.value)}}},{key:"setInitValue",value:function(e){void 0===e&&(e=""),this.element.value=e,this.value=this.parseValue(e)}}]),t}(O),I=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"setProps",value:function(){var e=this;this.props.type="checkbox",this.props.onChange=function(t){e.value=!0===t.target.checked?1:0}}},{key:"setInitValue",value:function(e){this.element.checked=0!==e,this.value=e}},{key:"defaultValue",get:function(){var e=this.field.defaultValue;return void 0!==e?e:0}}]),t}(O);function R(e,t){switch(t.type){default:return new C(e,t);case"int":return new j(e,t);case"dec":return new S(e,t);case"float":return new _(e,t);case"string":return new V(e,t);case"password":return new F(e,t);case"text":return new A(e,t);case"checkbox":return new I(e,t)}}var T=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},q=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},M=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n},L=function(){function e(t,n){Object(o.a)(this,e),this.errors=[];var r=t.fields,i=t.onSumit,s=t.fieldTag,a=t.submitText,c=t.resetButton,u=t.clearButton;this.initValues=n,this.fieldTag=s||"div",this.submitText=a||"\u63d0\u4ea4",this.resetButton=!0===c?"\u91cd\u6765":c,this.clearButton=!0===u?"\u6e05\u9664":u,this.submit=i,this._inputs={},this.inputs=[],this.hasLabel=!1;var l=!0,h=!1,d=void 0;try{for(var f,p=r[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var v=f.value;v.name;void 0!==v.label&&(this.hasLabel=!0);var m=this._inputs[v.name]=R(this,v);this.inputs.push(m)}}catch(y){h=!0,d=y}finally{try{l||null==p.return||p.return()}finally{if(h)throw d}}this.onSubmit=this.onSubmit.bind(this),this.onClear=this.onClear.bind(this),this.onFinish=this.onFinish.bind(this),this.onNext=this.onNext.bind(this)}return Object(a.a)(e,[{key:"clear",value:function(){this.inputs.forEach(function(e){return e.clear()}),this.errors.splice(0,this.errors.length)}},{key:"reset",value:function(){this.inputs.forEach(function(e){return e.reset()}),this.errors.splice(0,this.errors.length)}},{key:"values",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var i,s=this.inputs[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value,a=o.value;""===a&&(a=void 0),e[o.field.name]=a}}catch(c){n=!0,r=c}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return e}},{key:"$",value:function(e){return this._inputs[e]}},{key:"removeInput",value:function(e){var t=this._inputs[e];if(void 0!==t){var n=this.inputs.findIndex(function(e){return e===t});n>=0&&this.inputs.splice(n,1)}}},{key:"setInputError",value:function(e,t){var n=this._inputs[e];void 0!==n&&(n.err=t)}},{key:"onReset",value:function(){this.reset()}},{key:"onClear",value:function(){this.clear()}},{key:"onSubmit",value:function(e){return q(this,void 0,void 0,y.a.mark(function t(){var n,i,o,a,c,u,l,h;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),void 0!==this.submit){t.next=4;break}return alert("no submit funciton defined"),t.abrupt("return");case 4:n=!0,i=!1,o=void 0,t.prev=7,a=this.inputs[Symbol.iterator]();case 9:if(n=(c=a.next()).done){t.next=18;break}if(u=c.value,void 0!==(l=u.props.onBlur)){t.next=14;break}return t.abrupt("continue",15);case 14:l();case 15:n=!0,t.next=9;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(7),i=!0,o=t.t0;case 24:t.prev=24,t.prev=25,n||null==a.return||a.return();case 27:if(t.prev=27,!i){t.next=30;break}throw o;case 30:return t.finish(27);case 31:return t.finish(24);case 32:return t.next=34,this.submit(this.values());case 34:if(void 0!==(h=t.sent)){t.next=37;break}return t.abrupt("return");case 37:if(!0!==h.success){t.next=43;break}if(void 0===this.onSuccess){t.next=41;break}return this.onSuccess(h.result),t.abrupt("return");case 41:t.next=46;break;case 43:if(void 0===this.onError){t.next=46;break}return this.onError(h.result),t.abrupt("return");case 46:r.c.push(s.createElement(U,{return:h,onFinish:this.onFinish,onNext:this.onNext}));case 47:case"end":return t.stop()}},t,this,[[7,20,24,32],[25,,27,31]])}))}},{key:"onFinish",value:function(){r.c.pop()}},{key:"onNext",value:function(){this.clear()}},{key:"fieldContainerClassNames",value:function(){return d(this.hasLabel?"col-sm-10":"col-sm-12")}},{key:"setInputValues",value:function(){if(void 0!==this.initValues)for(var e in this._inputs){var t=this.initValues[e];void 0!==t&&this._inputs[e].setInitValue(t)}}},{key:"renderInput",value:function(e){switch(e.field.type){default:return this.renderString(e);case"checkbox":return this.renderCheckBox(e);case"text":return this.renderTextArea(e)}}},{key:"renderString",value:function(e){var t=e.err,n=d("form-control","has-success",t?"is-invalid":"is-valid");return s.createElement("input",Object.assign({className:n},e.props))}},{key:"renderTextArea",value:function(e){var t=e.err,n=e.props,r=(n.value,n.inputtag,M(n,["value","inputtag"])),i=d("form-control","has-success",t?"is-invalid":"is-valid");return s.createElement("textarea",Object.assign({className:i},r),e.value)}},{key:"renderCheckBox",value:function(e){var t=e.props,n=e.field;e.value;return s.createElement("label",{className:"form-check-label h-100 align-items-center d-flex bg-light"},s.createElement("input",{type:"checkbox",className:"form-check-input position-static ml-0",name:n.name,checked:1===e.value,onChange:t.onChange,ref:t.ref}))}},{key:"renderLabel",value:function(e){return!1===this.hasLabel?null:s.createElement("label",{className:"col-sm-2 col-form-label"},void 0!==e?e.label:null)}},{key:"renderErr",value:function(e){return s.createElement("div",{className:"invalid-feedback"},e.err)}},{key:"renderField",value:function(e){return s.createElement("div",{className:"form-group row",key:e.id},this.renderLabel(e),s.createElement("div",{className:this.fieldContainerClassNames()},this.renderInput(e),e.err&&this.renderErr(e)))}},{key:"renderSeperator",value:function(e){return null}},{key:"renderSumit",value:function(){var e=d("btn","btn-primary",this.hasLabel?void 0:"btn-block");return s.createElement("button",{className:e,key:w.uniqueId(),type:"submit",disabled:this.notFilled||this.hasError},this.submitText)}},{key:"renderReset",value:function(){return s.createElement("button",{className:'btn btn-secondary"',key:w.uniqueId(),type:"button",onClick:this.onReset},this.resetButton)}},{key:"renderClear",value:function(){return s.createElement("button",{className:'btn btn-secondary"',key:w.uniqueId(),type:"button",onClick:this.onClear},this.clearButton)}},{key:"renderFormErrors",value:function(){return 0===this.errors.length?null:s.createElement("div",{className:"form-group row"},s.createElement("div",{className:this.fieldContainerClassNames()},this.renderLabel(void 0),this.errors.map(function(e){return s.createElement("div",{className:"invalid-feedback",style:{display:"block"}},e)})))}},{key:"renderButtons",value:function(){return!0===this.hasLabel?s.createElement("div",{className:"form-group row",key:w.uniqueId()},this.renderLabel(void 0),s.createElement("div",{className:this.fieldContainerClassNames()},s.createElement("div",{className:"row container"},s.createElement("div",{className:"col-auto mr-auto"},this.renderSumit()),s.createElement("div",{className:"col-auto"},this.clearButton&&this.renderClear()),s.createElement("div",{className:"col-auto"},this.resetButton&&this.renderReset())))):s.createElement("div",{className:"form-group row",key:w.uniqueId()},s.createElement("div",{className:this.fieldContainerClassNames()},this.renderSumit()),this.clearButton?s.createElement("div",{className:"col-auto"},"this.renderClear()"):null,this.resetButton?s.createElement("div",{className:"col-auto"},"this.renderReset()"):null)}},{key:"hasError",get:function(){return this.inputs.some(function(e){return void 0!==e.err})}},{key:"notFilled",get:function(){var e=this.inputs.every(function(e){return!e.filled});return console.log("not filled %s",e),e}}]),e}();T([b.k],L.prototype,"errors",void 0),T([b.d],L.prototype,"hasError",null),T([b.d],L.prototype,"notFilled",null);var U=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this.props,t=e.return,n=e.onNext,o=e.onFinish,a=t.success,c=t.message,u=t.result;return void 0===c&&(c=!0===a?"\u63d0\u4ea4\u6210\u529f":"\u63d0\u4ea4\u53d1\u751f\u9519\u8bef"),s.createElement(i.a,{back:"close"},s.createElement("div",{className:"jumbotron"},s.createElement("div",{className:"lead"},c),s.createElement("p",null,JSON.stringify(u)),s.createElement("hr",{className:"my-4"}),s.createElement("div",{className:"lead"},s.createElement("button",{className:"btn btn-primary mr-2",type:"button",onClick:function(){r.c.pop(),o()}},"\u5b8c\u6210"),s.createElement("button",{className:"btn btn-default mr-2",type:"button",onClick:function(){r.c.pop(),n()}},"\u7ee7\u7eed"))))}}]),t}(s.Component),B=n(25),D=(s.Component,n(44)),H=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};function $(e,t,n){var r={};if(void 0===e)return r;g.a.merge(r,e._);var i=e[t];if(void 0===i)return r;g.a.merge(r,i._);var s=i[n];if(void 0===s)return r;g.a.merge(r,s);var o=r.entity;if(void 0!==o)for(var a in o)o[a.toLowerCase()]=o[a];return r}var W=function(){function e(t){var n=this;Object(o.a)(this,e),this.isDev=D.b,this.disposer=function(){r.c.unregisterReceiveHandler(n.receiveHandlerId),n.onDispose()},this.onMessageReceive=function(e){return H(n,void 0,void 0,y.a.mark(function t(){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.onMessage(e);case 2:case"end":return t.stop()}},t,this)}))},this._resolve_$=[],this.res=t||{},this.x=this.res.x||{}}return Object(a.a)(e,[{key:"onDispose",value:function(){}},{key:"showVPage",value:function(e,t){return H(this,void 0,void 0,y.a.mark(function n(){return y.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new e(this).showEntry(t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"renderView",value:function(e,t){return new e(this).render(t)}},{key:"event",value:function(e,t){return H(this,void 0,void 0,y.a.mark(function n(){return y.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.onEvent(e,t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"onEvent",value:function(e,t){return H(this,void 0,void 0,y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}))}},{key:"msg",value:function(e){alert(e)}},{key:"errorPage",value:function(e,t){this.openPage(s.createElement(i.a,{header:"App error!"},s.createElement("pre",null,"string"===typeof t?t:t.message)))}},{key:"onMessage",value:function(e){}},{key:"beforeStart",value:function(){return H(this,void 0,void 0,y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.receiveHandlerId=r.c.registerReceiveHandler(this.onMessageReceive),e.abrupt("return",!0);case 2:case"end":return e.stop()}},e,this)}))}},{key:"start",value:function(e){return H(this,void 0,void 0,y.a.mark(function t(){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.beforeStart();case 2:if(!1!==t.sent){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.internalStart(e);case 7:case"end":return t.stop()}},t,this)}))}},{key:"call",value:function(e){return H(this,void 0,void 0,y.a.mark(function t(){var n=this;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){return H(n,void 0,void 0,y.a.mark(function n(){return y.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this._resolve_$.push(t),n.next=3,this.start(e);case 3:case"end":return n.stop()}},n,this)}))}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"vCall",value:function(e,t){return H(this,void 0,void 0,y.a.mark(function n(){var r=this;return y.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,i){return H(r,void 0,void 0,y.a.mark(function r(){return y.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this._resolve_$.push(n),r.next=3,new e(this).showEntry(t);case 3:case"end":return r.stop()}},r,this)}))}));case 1:case"end":return n.stop()}},n,this)}))}},{key:"returnCall",value:function(e){var t=this._resolve_$.pop();void 0!==t?t(e):alert("the Coordinator call already returned, or not called")}},{key:"openPage",value:function(e){r.c.push(e,this.disposer),this.disposer=void 0}},{key:"replacePage",value:function(e){r.c.replace(e,this.disposer),this.disposer=void 0}},{key:"backPage",value:function(){r.c.back()}},{key:"closePage",value:function(e){r.c.pop(e)}},{key:"ceasePage",value:function(e){r.c.ceaseTop(e)}},{key:"removeCeased",value:function(){r.c.removeCeased()}},{key:"regConfirmClose",value:function(e){r.c.regConfirmClose(e)}},{key:"user",get:function(){return r.c.user}}]),e}(),Q=function(){function e(t){Object(o.a)(this,e),this.controller=t,this.res=t.res,this.x=t.x}return Object(a.a)(e,[{key:"renderVm",value:function(e,t){return new e(this.controller).render(t)}},{key:"showVPage",value:function(e,t){return H(this,void 0,void 0,y.a.mark(function n(){return y.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new e(this.controller).showEntry(t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"event",value:function(e,t){return H(this,void 0,void 0,y.a.mark(function n(){return y.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.controller.event(e,t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"returnCall",value:function(e){this.controller.returnCall(e)}},{key:"openPage",value:function(e,t){this.controller.openPage(s.createElement(e,t))}},{key:"replacePage",value:function(e,t){this.controller.replacePage(s.createElement(e,t))}},{key:"openPageElement",value:function(e){this.controller.openPage(e)}},{key:"replacePageElement",value:function(e){this.controller.replacePage(e)}},{key:"backPage",value:function(){this.controller.backPage()}},{key:"closePage",value:function(e){this.controller.closePage(e)}},{key:"ceasePage",value:function(e){this.controller.ceasePage(e)}},{key:"removeCeased",value:function(){this.controller.removeCeased()}},{key:"regConfirmClose",value:function(e){this.controller.regConfirmClose(e)}},{key:"isDev",get:function(){return D.b}}]),e}(),z=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(e){return null}}]),t}(Q);n.d(t,"c",function(){return r.a}),n.d(t,"h",function(){return r.c}),n.d(t,"d",function(){return i.a}),n.d(t,"f",function(){return v}),n.d(t,"b",function(){return L}),n.d(t,"i",function(){return $}),n.d(t,"a",function(){return W}),n.d(t,"g",function(){return Q}),n.d(t,"e",function(){return z})},function(e,t,n){"use strict";var r=n(3),i=n.n(r),s=n(20);class o{constructor(e){this.view=(()=>r.createElement("div",null)),this.label=e}render(){return r.createElement("div",{key:this.key,className:"px-3"},r.createElement("div",{className:"form-group row"},r.createElement("label",{className:"col-sm-2 col-form-label"},this.label),r.createElement("div",{className:"col-sm-10"},this.renderContent())))}setAddRow(e){}get key(){return this.label}getVFields(){}getVArr(){}getVSubmit(){}renderContent(){return r.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"content")}}class a extends o{constructor(e,t){super(e),this.vField=t}get key(){return this.vField.name}getVFields(){return[this.vField]}renderContent(){return this.vField.render()}}class c extends o{constructor(e,t){super(e),this.vArr=t}setAddRow(e){this.vArr.setAddRow(e)}get key(){return this.vArr.name}getVArr(){return this.vArr}render(){return r.createElement(r.Fragment,{key:this.key},this.vArr&&this.vArr.render())}}class u extends o{constructor(e){super(void 0),this.vSubmit=e}get key(){return"$submit"}getVSubmit(){return this.vSubmit}render(){return r.createElement("div",{key:"$submit",className:"px-3"},r.createElement("div",{className:"form-group row"},r.createElement("div",{className:"offset-sm-2 col-sm-10"},this.vSubmit.render())))}}var l=n(24),h=n(18),d=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},f=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class p extends l.d{constructor(e){super(),this.onClickSubmit=(()=>f(this,void 0,void 0,function*(){this.vForm.submit()})),this.view=Object(s.a)(()=>{let{isOk:e}=this.vForm;return r.createElement("button",{type:"button",onClick:this.onClickSubmit,className:this.className,disabled:!1===e},this.caption)}),this.vForm=e,this.caption=this.vForm.submitCaption,this.className="btn btn-primary w-25"}}d([h.k],p.prototype,"caption",void 0),d([h.k],p.prototype,"className",void 0);var v=n(11),m=n.n(v),y=n(9);class b{}class w extends b{check(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(NaN!==t)return;break;case"undefined":}e.push("\u4e0d\u80fd\u4e3a\u7a7a")}}class g extends b{check(e,t){if(void 0===t||null===t)return;NaN===Number(t)&&e.push("\u5fc5\u987b\u662f\u6570\u5b57")}}class k extends b{check(e,t){if(void 0===t||null===t)return;let n=Number(t);!0!==Number.isNaN(n)&&!1!==Number.isInteger(n)||e.push("\u5fc5\u987b\u662f\u6574\u6570")}}class x extends g{constructor(e){super(),this.min=e}check(e,t){super.check(e,t),Number(t)<this.min&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.min)}}class E extends g{constructor(e){super(),this.max=e}check(e,t){super.check(e,t),Number(t)>this.max&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.max)}}var O=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};class C extends l.d{constructor(e,t,n,r){super(),this.form=e,this.field=t,this.name=t.name,this.fieldUI=n||{},this.fieldRes=r||{},this.init()}init(){this.buildRules()}buildRules(){this.rules=[];let{required:e}=this.fieldUI;(!0===e||void 0!==this.field&&!1===this.field.null)&&this.rules.push(new w)}get checkRules(){let e=[];for(let t of this.rules)t.check(e,this.value);return e}get isOk(){if(0===this.rules.length)return!0;return 0===this.checkRules.length}get value(){return this.form.values[this.name]}setValue(e){this.form.values[this.name]=e}get error(){return this.form.errors[this.name]}set error(e){this.form.errors[this.name]=e}parse(e){return e}get readonly(){let{mode:e}=this.form;return e===z.readonly||e===z.edit&&!1===this.fieldUI.editable}}O([h.d],C.prototype,"checkRules",null),O([h.d],C.prototype,"isOk",null),O([h.d],C.prototype,"value",null);class N extends C{constructor(){super(...arguments),this.renderError=(e=>{let{errors:t}=this.form,n=t[this.name];if(void 0!==n)return r.createElement("div",{className:e},r.createElement(y.b,{name:"exclamation-circle"})," ",n)}),this.ref=(e=>{this.input=e,this.setInputValue()}),this.onFocus=(()=>{this.error=void 0}),this.onBlur=(()=>{let e=this.checkRules;e.length>0&&(this.error=e[0]),this.form.computeFields()}),this.onChange=(e=>{let t=this.parse(e.currentTarget.value);null!==t&&this.setValue(t)}),this.view=Object(s.a)(()=>{let e,t,n,{required:i}=this.fieldUI,{placeHolder:s,suffix:o}=this.fieldRes,a=["form-control","form-control-input"];return!0===this.readonly?t=r.createElement("input",{className:m()(a,"bg-light"),ref:this.ref,type:this.inputType,readOnly:!0}):(t=r.createElement("input",{className:m()(a),ref:this.ref,type:this.inputType,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,placeholder:s,readOnly:!1,maxLength:this.maxLength,onKeyPress:this.onKeyPress}),!0!==i&&!1!==this.field.null||(e=r.createElement(P,null))),n=void 0===o?t:r.createElement("div",{className:"input-group"},t,r.createElement("div",{className:"input-group-append"},r.createElement("span",{className:"input-group-text"},o))),r.createElement(r.Fragment,null,e,n,this.renderError("text-danger small mt-1 mx-2"))})}get maxLength(){}setValue(e){super.setValue(e),this.setInputValue()}setInputValue(){if(!this.input)return;let e=this.value;this.input.value=null===e||void 0===e?"":e}}const P=()=>r.createElement("b",{style:{color:"red",position:"absolute",left:"0.1em",top:"0.5em"}},"*");class j extends N{constructor(){super(...arguments),this.inputType="text"}get maxLength(){return this.field.size}}const S=45,_=46;class V extends N{constructor(){super(...arguments),this.inputType="number",this.onKeyPress=(e=>{let t=e.charCode;if(!(8===t||0===t||13===t||t>=48&&t<=57))if(void 0!==this.extraChars&&this.extraChars.indexOf(t)>=0)switch(t){case _:this.onKeyDot();break;case S:this.onKeyNeg(),e.preventDefault()}else e.preventDefault()})}init(){if(super.init(),this.extraChars=[],void 0!==this.fieldUI){let{min:e,max:t}=this.fieldUI;void 0!==e?e<0&&this.extraChars.push(S):this.extraChars.push(S)}switch(this.field.type){case"dec":case"bigint":case"int":case"smallint":case"tinyint":this.extraChars.push(_)}}buildRules(){super.buildRules(),this.rules.push(new g);let{min:e,max:t}=this.fieldUI;void 0!==e&&this.rules.push(new x(e)),void 0!==t&&this.rules.push(new E(t))}parse(e){try{if(0===e.trim().length)return;let n=Number(e);return NaN===n?null:n}catch(t){return null}}setInputValue(){if(!this.input)return;let e=this.value;this.parse(this.input.value)!=e&&(this.input.value=null===e||void 0===e?"":e)}onKeyDot(){let e=this.input.value;e.indexOf(".")>=0&&(this.input.value=e.replace(".",""))}onKeyNeg(){let e=this.input.value,t=e.indexOf("-");e=t>=0?e.replace("-",""):"-"+e,this.input.value=e}}class F extends V{buildRules(){super.buildRules(),this.rules.push(new k)}}class A extends V{}class I extends j{}class R extends j{}class T extends C{constructor(e,t,n){super(e,t,void 0,n),this.view=Object(s.a)(()=>{let e=this.form.values[this.field.name],{placeHolder:t,suffix:n}=this.fieldRes;null===e&&(e="");let r,s=i.a.createElement("input",{className:"form-control form-control-input bg-light",type:"text",placeholder:t,readOnly:!0,value:e});return r=void 0===n?s:i.a.createElement("div",{className:"input-group"},s,i.a.createElement("div",{className:"input-group-append"},i.a.createElement("span",{className:"input-group-text"},n)))})}}var q=n(30),M=n.n(q),L=n(7),U=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class B extends l.d{constructor(e,t,n){super(),this.rowPage=(()=>r.createElement(L.d,{header:this.label,back:"close"},this.vForm.render("py-3"))),this.onSubmit=(()=>U(this,void 0,void 0,function*(){let{valueBoxs:e}=this.vForm;yield this.onRowChanged(e)})),this.onRowChanged=(e=>U(this,void 0,void 0,function*(){void 0===this.rowValues?(e.$owner=this.ownerForm.values,this.list.push(e),void 0===this.onEditRow?this.vForm.reset():yield this.onEditRow(void 0,this.onRowChanged)):(M.a.merge(this.rowValues,e),void 0===this.onEditRow&&L.n.pop())})),this.renderItem=((e,t)=>void 0===this.rowContent?r.createElement("div",{className:"px-3 py-2"},r.createElement(l.a,Object.assign({},e))):r.createElement(this.rowContent,Object.assign({},e))),this.showRow=(e=>U(this,void 0,void 0,function*(){void 0===this.onEditRow?(this.vForm.reset(),void 0!==e&&this.vForm.setValues(e),L.n.push(r.createElement(this.rowPage,null))):yield this.onEditRow(e,this.onRowChanged)})),this.editRow=(e=>U(this,void 0,void 0,function*(){this.rowValues=e;let{vSubmit:t}=this.vForm;void 0!==t&&(t.caption=this.editSubmitCaption,t.className="btn btn-outline-success"),this.vForm.mode=this.ownerForm.mode,yield this.showRow(e)})),this.internalAddRow=(()=>U(this,void 0,void 0,function*(){this.rowValues=void 0;let{vSubmit:e}=this.vForm;e.caption=this.newSubmitCaption,e.className="btn btn-outline-success",this.vForm.reset(),this.vForm.mode=z.new,yield this.showRow(void 0)})),this.view=(()=>{let e;void 0===this.addRow&&this.mode===z.readonly||(e=r.createElement("button",{onClick:this.addRow||this.internalAddRow,type:"button",className:"btn btn-link p-0"},this.ownerForm.arrTitleNewButton));let t=this.header||r.createElement("div",{className:"px-3 bg-light small",style:{paddingTop:"1px",paddingBottom:"1px"}},r.createElement("div",{className:"flex-fill align-self-center"},this.label),e);return r.createElement(y.d,{className:"pb-3",header:t,none:r.createElement(y.e,{className:"px-3 py-2"},this.none),items:this.list,item:{render:this.renderItem,onClick:this.editRow}})}),this.ownerForm=e;let{name:i,fields:s}=t;this.name=i;let{ui:o,res:a,mode:c,inputs:u,values:h}=e,d=a.arrs,f=void 0!==d?d[i]:{},{label:p,none:v,newSubmit:m,editSubmit:b}=f;this.none=v||e.none,this.newSubmitCaption=m||e.arrNewCaption,this.editSubmitCaption=b||e.arrEditCaption,this.label=p||i;let w=o&&o.items[i]||{};this.rowContent=w.rowContent,this.mode=c,void 0===this.onEditRow?this.vForm=new G({fields:s,arrs:void 0,ui:w,res:f,inputs:u[i],none:e.none,submitCaption:"submit",arrNewCaption:void 0,arrEditCaption:void 0,arrTitleNewButton:void 0,mode:c},c===z.readonly?void 0:this.onSubmit):this.onEditRow=n,this.list=h[i]}reset(){this.vForm.reset(),this.list.clear()}setAddRow(e){this.addRow=e}}var D=n(26),H=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};const $={textAlign:"left",paddingLeft:"0.75rem",paddingRight:"0.75rem",overflow:"hidden"};class W extends C{constructor(e,t,n,i){super(e,t,n,i),this.onClick=(()=>H(this,void 0,void 0,function*(){if(!0===this.readonly){if(!this.value)return;return void(yield this.tuid.showInfo(this.value.id))}let e;void 0!==this.input?e=yield this.input.select(this.vForm,this.field,this.vForm.getValues()):(alert("call undefined"),e=0),this.setValue(this.tuid.boxId(e))})),this.view=Object(s.a)(()=>{let e,t,{placeHolder:n}=this.fieldRes,i=!1,{_ownerField:s}=this.field;if(void 0!==s){let{name:e,arr:t}=s;i=null===this.vForm.getValue(e)}if(null===this.value)e=r.createElement(r.Fragment,null,n||this.input.placeHolder);else if("object"===typeof this.value)e=Object(D.b)(this.value);else{let t=this.tuid.boxId(this.value);e=Object(D.b)(t)}if(!0===this.readonly)return r.createElement("div",{className:"form-control form-control-plaintext border border-info rounded bg-light cursor-pointer",onClick:this.onClick},e);let{required:o}=this.fieldUI;return!0!==o&&!1!==this.field.null||(t=r.createElement(P,null)),r.createElement(r.Fragment,null,t,r.createElement("button",{className:"form-control btn btn-outline-info",type:"button",disabled:i,style:$,onClick:this.onClick},e))}),this.tuid=t._tuid,this.vForm=e,this.input=e.inputs[t.name]}}class Q{constructor(e,t,n){this.vForm=e,this.onSubmit=n;let{fields:r,arrs:i,ui:s,res:o}=t;if(this.fields=r,this.arrs=i,void 0!==s){let{items:e,layout:t}=s;this.formItems=e,this.layout=t}this.res=o}build(){return void 0===this.layout?this.bandsOnFly():this.bandsFromLayout()}resFromName(e,t){if(void 0===t)return;let{fields:n}=t;return void 0!==n?n[e]||e:void 0}bandsOnFly(){let e=[];if(this.bandsFromFields(e,this.fields,this.res),void 0!==this.arrs)for(let t of this.arrs)e.push(this.bandFromArr(t));return void 0!==this.onSubmit&&e.push(new u(new p(this.vForm))),e}bandsFromFields(e,t,n){if(void 0!==t)for(let r of t)e.push(this.bandFromField(r,n))}bandsFromLayout(){return[]}bandFromField(e,t){let n,r,i,s,{name:o}=e,c=this.resFromName(o,t);return"object"===typeof c?(r=c.label,n=c):(r=c,n=void 0),void 0!==this.formItems&&(s=this.formItems[o]),void 0===(i="function"===typeof s?new T(this.vForm,e,n):function(e,t,n,r){let i;switch(t.type){default:return;case"tinyint":case"smallint":case"int":i=F;break;case"bigint":let{_tuid:e}=t;if(void 0!==e)return;i=F;break;case"dec":i=A;break;case"char":i=j;break;case"text":i=I;break;case"datetime":i=R}return new i(e,t,n,r)}(this.vForm,e,s,n))&&(i=new W(this.vForm,e,s,n)),new a(r||o,i)}bandFromArr(e){let{name:t,fields:n}=e,r=new B(this.vForm,e);return new c(t,r)}}var z,K=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},J=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};!function(e){e[e.new=0]="new",e[e.edit=1]="edit",e[e.readonly=2]="readonly"}(z||(z={}));class G{constructor(e,t){this.vFields={},this.vArrs={},this.onFormSubmit=(e=>(e.preventDefault(),!1)),this.view=Object(s.a)(({className:e})=>r.createElement("form",{className:e,onSubmit:this.onFormSubmit},this.bands.map(e=>e.render())));let{fields:n,arrs:i,ui:o,res:a,inputs:c,none:u,submitCaption:l,arrNewCaption:h,arrEditCaption:d,arrTitleNewButton:f,mode:p}=e;this.fields=n,this.arrs=i,this.ui=o,void 0!==this.ui&&(this.formItems=this.ui.items),this.res=a,this.inputs=c,this.none=u,this.submitCaption=l,this.arrNewCaption=h,this.arrEditCaption=d,this.arrTitleNewButton=f||r.createElement("small",null,r.createElement(y.b,{name:"plus"})," \u65b0\u589e"),this.mode=void 0===t?z.readonly:p,this.buildFormValues(),this.buildBands(e,t),this.onSubmit=t}buildBands(e,t){this.bandColl={};let n=new Q(this,e,t);this.bands=n.build();for(let r of this.bands){this.bandColl[r.key]=r;let e=r.getVFields();if(void 0!==e)for(let r of e)this.vFields[r.name]=r;let t=r.getVArr();void 0!==t&&(this.vArrs[t.name]=t);let n=r.getVSubmit();void 0!==n&&(this.vSubmit=n)}}getBand(e){return this.bandColl[e]}computeFields(){if(void 0===this.formItems)return;let e=this.values;for(let t in this.formItems){let n=this.formItems[t];"function"===typeof n&&(e[t]=n.call(e))}}submit(){return J(this,void 0,void 0,function*(){void 0!==this.onSubmit&&(yield this.onSubmit())})}getValues(){let e={},t=this.values;for(let n of this.fields){let{name:r}=n,i=t[r];e[r]=null!==i&&"object"===typeof i?i.id:i}if(void 0!==this.arrs)for(let n of this.arrs){let{name:t,fields:r,id:i,order:s}=n,o=e[t]=[],a=this.vArrs[t].list;for(let e of a){let t={};void 0!==i&&(t[i]=e[i]),void 0!==s&&(t[s]=e[s]);for(let n of r){let{name:r}=n,i=e[r];t[r]=null!==i&&"object"===typeof i?i.id:i}o.push(t)}}return e}get valueBoxs(){let e={},t=this.values;for(let n of this.fields){let{name:r,_tuid:i}=n,s=t[r];e[r]=void 0===i||"object"===typeof s?s:i.boxId(s)}if(void 0===this.arrs)return e;for(let n of this.arrs){let{name:t,fields:r,id:i,order:s}=n,o=e[t]=this.vArrs[t].list.slice();for(let e of o)for(let t of r){let{name:n,_tuid:r}=t,i=e[n];e[n]=void 0===r||"object"===typeof i?i:r.boxId(i)}}return e}setValues(e){if(void 0===e)return void this.reset();let t=this.values,n=this.errors;for(let r of this.fields){let i=r.name;n[i]=void 0;let s=e[i];t[i]=s}for(let r in this.vArrs){let n=e[r];if(void 0===n)continue;let i=t[r];i.clear(),i.push(...n)}}get isOk(){for(let e in this.vFields)if(!1===this.vFields[e].isOk)return!1;return!0}reset(){let e=this.values,t=this.errors;for(let n of this.fields){let r=n.name;e[r]=null,t[r]=void 0}for(let n in this.vFields){let e=this.vFields[n];void 0!==e.name&&e.setValue(null)}for(let n in this.vArrs){this.vArrs[n].reset()}}getValue(e){return this.values[e]}setValue(e,t){this.values[e]=t}setError(e,t){this.errors[e]=t}buildFieldValues(e){let t={valueFromFieldName:function(e){return this[e]}};for(let n of e){t[n.name]=null}return t}buildObservableValues(){let e=this.buildFieldValues(this.fields);if(void 0!==this.arrs)for(let t of this.arrs)e[t.name]=h.k.array([],{deep:!0});return Object(h.k)(e)}buildFormValues(){this.values=this.buildObservableValues(),this.errors=Object(h.k)(this.buildFieldValues(this.fields))}render(e="py-3"){return r.createElement(this.view,{className:e})}}K([h.d],G.prototype,"isOk",null),n.d(t,"a",function(){return z}),n.d(t,"b",function(){return G})},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s});var r="localhost:3000",i="localhost:3015",s="localhost:3009"},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(12),i=n(14),s=n(6),o=n.n(s),a=n(33),c=n(22),u=n(44),l=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};var h=function(){function e(t,n,i,s){var a=this;Object(r.a)(this,e),this.startWait=function(){void 0!==a.ui&&a.ui.startWait()},this.endWait=function(e,t){void 0!==a.ui&&a.ui.endWait(),void 0!==t&&t("\u8bbf\u95eewebapi\u8d85\u65f6 "+e)},this.showError=function(e){return l(a,void 0,void 0,o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.ui){t.next=3;break}return t.next=3,this.ui.showError(e);case 3:case"end":return t.stop()}},t,this)}))},this.isCenter=t,this.hostUrl=n,this.apiToken=i,this.ui=s,this.timeout=!0===u.b?5e5:5e3}return Object(i.a)(e,[{key:"used",value:function(){this.post("",{})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return l(this,void 0,void 0,o.a.mark(function n(){var r,i,s,a,c;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=15;break}if(!((r=Object.keys(t)).length>0)){n.next=15;break}i="?",s=0;case 5:if(!(s<r.length)){n.next=15;break}if(a=r[s],void 0!==t[a]){n.next=10;break}return n.abrupt("continue",12);case 10:e+=i+a+"="+t[a],i="&";case 12:s++,n.next=5;break;case 15:return(c=this.buildOptions()).method="GET",n.next=19,this.innerFetch(e,c);case 19:return n.abrupt("return",n.sent);case 20:case"end":return n.stop()}},n,this)}))}},{key:"post",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.buildOptions()).method="POST",r.body=JSON.stringify(t),n.next=5,this.innerFetch(e,r);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"put",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.buildOptions()).method="PUT",r.body=JSON.stringify(t),n.next=5,this.innerFetch(e,r);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"delete",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.buildOptions()).method="DELETE",r.body=JSON.stringify(t),n.next=5,this.innerFetch(e,r);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"fetch",value:function(e){function t(t,n,r,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n,r){return l(this,void 0,void 0,o.a.mark(function i(){var s,a,u,h,d,f,p,v=this;return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return u=function(e){return{channel:s,url:a,options:t,resolve:n,reject:r,error:e}},s=this,this.startWait(),a=e,i.prev=4,console.log("%s %s",t.method,a),h=setTimeout(function(){return s.endWait(e,r)},this.timeout),i.next=9,fetch(a,t);case 9:if(!1!==(d=i.sent).ok){i.next=15;break}throw clearTimeout(h),s.endWait(),console.log("call error %s",d.statusText),d.statusText;case 15:if(!((f=d.headers.get("content-type"))&&f.indexOf("json")>=0)){i.next=20;break}return i.abrupt("return",d.json().then(function(e){return l(v,void 0,void 0,o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(clearTimeout(h),s.endWait(),!0!==e.ok){t.next=4;break}return t.abrupt("return",n(e.res));case 4:if(void 0!==e.error){t.next=9;break}return t.next=7,s.showError(u("not valid tonva json"));case 7:t.next=12;break;case 9:return t.next=11,s.showError(u(e.error));case 11:r(e.error);case 12:case"end":return t.stop()}},t,this)}))}).catch(function(e){return l(v,void 0,void 0,o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.showError(u(e.message));case 2:case"end":return t.stop()}},t,this)}))}));case 20:return i.next=22,d.text();case 22:p=i.sent,clearTimeout(h),s.endWait(),n(p);case 26:i.next=36;break;case 28:if(i.prev=28,i.t0=i.catch(4),"string"!==typeof i.t0){i.next=34;break}if(!0!==i.t0.toLowerCase().startsWith("unauthorized")){i.next=34;break}return c.c.logout(),i.abrupt("return");case 34:return i.next=36,this.showError(u(i.t0.message));case 36:case 37:case"end":return i.stop()}},i,this,[[4,28]])}))})},{key:"innerFetch",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r,i=this;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.hostUrl+e,!0!==this.isCenter||void 0!==this.apiToken||!Object(a.d)()){n.next=5;break}return n.next=4,Object(a.c)(r,t.method,t.body);case 4:return n.abrupt("return",n.sent);case 5:return n.next=7,new Promise(function(e,n){return l(i,void 0,void 0,o.a.mark(function i(){return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.fetch(r,t,e,n);case 2:case"end":return i.stop()}},i,this)}))});case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}},n,this)}))}},{key:"callFetch",value:function(e,t,n){return l(this,void 0,void 0,o.a.mark(function r(){var i,s=this;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(i=this.buildOptions()).method=t,i.body=n,r.next=5,new Promise(function(t,n){return l(s,void 0,void 0,o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.fetch(e,i,t,n);case 2:case"end":return r.stop()}},r,this)}))});case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,this)}))}},{key:"buildOptions",value:function(){var e=c.c.language,t=c.c.culture,n=new Headers;n.append("Content-Type","application/json;charset=UTF-8");var r=e;return t&&(r+="-"+t),n.append("Accept-Language",r),this.apiToken&&n.append("Authorization",this.apiToken),{headers:n}}}]),e}()},function(e,t,n){"use strict";n.d(t,"startApp",function(){return a});var r=n(3),i=n(51);n(52);n.o(i,"CApp")&&n.d(t,"CApp",function(){return i.CApp}),n.o(i,"CMap")&&n.d(t,"CMap",function(){return i.CMap}),n.o(i,"CQuery")&&n.d(t,"CQuery",function(){return i.CQuery}),n.o(i,"CTuidMain")&&n.d(t,"CTuidMain",function(){return i.CTuidMain}),n.o(i,"ControllerUsq")&&n.d(t,"ControllerUsq",function(){return i.ControllerUsq}),n.o(i,"VEntity")&&n.d(t,"VEntity",function(){return i.VEntity}),n.o(i,"VMapMain")&&n.d(t,"VMapMain",function(){return i.VMapMain}),n.o(i,"VQueryMain")&&n.d(t,"VQueryMain",function(){return i.VQueryMain}),n.o(i,"VTuidMain")&&n.d(t,"VTuidMain",function(){return i.VTuidMain}),n.o(i,"tv")&&n.d(t,"tv",function(){return i.tv});n(66);var s=n(26);n.d(t,"tv",function(){return s.b});var o=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};function a(e,t){return o(this,void 0,void 0,function*(){!function e(t){for(let n in t){let i=t[n];if(t[n.toLowerCase()]=i,"object"===typeof i&&!r.isValidElement(i))if(!0===Array.isArray(i))for(let t of i)e(t);else e(i)}}(t);let n=new(t&&t.CApp||i.CApp)(e,t||{usqs:{}});yield n.start()})}},function(e,t,n){"use strict";var r=n(63);n.d(t,"CApp",function(){return r.a});n(86),n(68),n(70);var i=n(54);n.d(t,"CTuidMain",function(){return i.b}),n.d(t,"VTuidMain",function(){return i.d});n(67);var s=n(60);n.d(t,"CQuery",function(){return s.a}),n.d(t,"VQueryMain",function(){return s.c});var o=n(69);n.d(t,"CMap",function(){return o.a}),n.d(t,"VMapMain",function(){return o.b});n(71),n(72);var a=n(24);n.d(t,"PureJSONContent",function(){return a.b});n(47);var c=n(87);n.o(c,"ControllerUsq")&&n.d(t,"ControllerUsq",function(){return c.ControllerUsq}),n.o(c,"VEntity")&&n.d(t,"VEntity",function(){return c.VEntity}),n.o(c,"tv")&&n.d(t,"tv",function(){return c.tv});var u=n(65);n.d(t,"ControllerUsq",function(){return u.a});var l=n(13);n.d(t,"VEntity",function(){return l.b});n(34),n(64)},function(e,t,n){"use strict";var r=n(18),i=n(30),s=n.n(i),o=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};const a="\t",c="\n";class u{constructor(e,t,n){this.fieldMaps={},this.entities=e,this.name=t,this.typeId=n,this.sys=this.name.indexOf("$")>=0}get sName(){return this.jName||this.name}get tvApi(){return this.entities.usqApi}fieldMap(e){void 0===e&&(e="$");let t=this.fieldMaps[e];if(void 0===t){let n;if("$"===e)n=this.fields;else if(void 0!==this.arrFields){let t=this.arrFields.find(t=>t.name===e);void 0!==t&&(n=t.fields)}else if(void 0!==this.returns){let t=this.returns.find(t=>t.name===e);void 0!==t&&(n=t.fields)}if(void 0===n)return{};t={};for(let e of n)t[e.name]=e;this.fieldMaps[e]=t}return t}loadSchema(){return o(this,void 0,void 0,function*(){if(void 0!==this.schema)return;let e=yield this.entities.usqApi.schema(this.name);this.setSchema(e)})}setSchema(e){if(void 0===e)return;if(void 0!==this.schema)return;this.schema=e;let{name:t,fields:n,arrs:r,returns:i}=e;t!==this.name&&(this.jName=t),this.entities.buildFieldTuid(this.fields=n),this.entities.buildArrFieldsTuid(this.arrFields=r,n),this.entities.buildArrFieldsTuid(this.returns=i,n)}schemaStringify(){return JSON.stringify(this.schema,(e,t)=>{if("_tuid"!==e)return t},4)}tuidFromField(e){let{_tuid:t,tuid:n}=e;if(void 0!==n)return void 0!==t?t:e._tuid=this.entities.getTuid(n,void 0)}tuidFromName(e,t){if(void 0===this.schema)return;let{fields:n,arrs:r}=this.schema,i=this.entities;function s(e,t){if(void 0===t)return;let n=t.find(t=>t.name===e);return void 0!==n?i.getTuid(n.tuid,void 0):void 0}let o=e.toLowerCase();if(void 0===t)return s(o,n);if(void 0===r)return;let a=t.toLowerCase(),c=r.find(e=>e.name===a);return void 0!==c?s(o,c.fields):void 0}pack(e){let t=[],n=this.fields;void 0!==n&&this.packRow(t,n,e);let r=this.arrFields;if(void 0!==r)for(let i of r)this.packArr(t,i.fields,e[i.name]);return t.join("")}escape(e,t){let n=e[t.name];switch(typeof n){default:return n;case"object":let e=t._tuid;return void 0===e?n.id:e.getIdFromObj(n);case"string":let r=n.length,i="",s=0;for(let t=0;t<r;t++){switch(n.charCodeAt(t)){case 9:i+=n.substring(s,t)+"\\t",s=t+1;break;case 10:i+=n.substring(s,t)+"\\n",s=t+1}}return i+n.substring(s);case"undefined":return""}}packRow(e,t,n){let r=t.length;if(0===r)return;let i="";i+=this.escape(n,t[0]);for(let s=1;s<r;s++){let e=t[s];i+=a+this.escape(n,e)}e.push(i+c)}packArr(e,t,n){if(void 0!==n)for(let r of n)this.packRow(e,t,r);e.push(c)}unpackSheet(e){let t={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(t,n,e,r));let i=this.arrFields;if(void 0!==i)for(let s of i)r=this.unpackArr(t,s,e,r);return t}unpackReturns(e){let t={},n=0,r=this.returns;if(void 0!==r)for(let i of r)n=this.unpackArr(t,i,e,n);return t}unpackRow(e,t,n,r){let i=0,s=0,o=r,a=0,c=n.length,u=t.length;for(;r<c;r++)if(i=s,9===(s=n.charCodeAt(r))){let s=t[a];if(8!==i){let t=n.substring(o,r);e[s.name]=this.to(e,t,s)}else{}if(o=r+1,++a>=u)break}else if(10===s){let s=t[a];if(8!==i){let t=n.substring(o,r);e[s.name]=this.to(e,t,s)}else{}++r,++a;break}return r}to(e,t,n){switch(n.type){default:return t;case"datetime":case"date":case"time":return new Date(Number(t));case"tinyint":case"smallint":case"int":case"dec":return Number(t);case"bigint":let e=Number(t),{_tuid:r}=n;return void 0===r?e:(r.useId(e,!0),r.boxId(e))}}unpackArr(e,t,n,r){let i=[],s=n.length,{name:o,fields:a}=t;for(;r<s;){if(10===n.charCodeAt(r)){++r;break}let e={};i.push(e),r=this.unpackRow(e,a,n,r)}return e[o]=i,r}}var l=n(93),h=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};const d=1e3;class f extends u{constructor(e,t,n){super(e,t,n),this.queue=[],this.waitingIds=[],this.cache=r.k.map({},{deep:!1}),this.buildIdBoxer()}get typeName(){return"tuid"}buildIdBoxer(){this.BoxId=function(){};let e=this.BoxId.prototype;Object.defineProperty(e,"_$tuid",{value:this,writable:!1,enumerable:!1}),Object.defineProperty(e,"obj",{enumerable:!1,get:function(){if(!(void 0===this.id||this.id<=0))return this._$tuid.valueFromId(this.id)}}),e.valueFromFieldName=function(e){return this._$tuid.valueFromFieldName(e,this.obj)},e.toJSON=function(){return this.id}}boxId(e){this.useId(e);let t=new this.BoxId;return t.id=e,t}getTuidContent(){return this.entities.usq.getTuidContent(this)}getIdFromObj(e){return e[this.idName]}setSchema(e){super.setSchema(e);let{id:t,unique:n}=e;this.idName=t,this.unique=n}moveToHead(e){let t=this.queue.findIndex(t=>t===e);this.queue.splice(t,1),this.queue.push(e)}valueFromId(e){let t;switch(typeof e){case"object":t=e.id;break;case"number":t=e;break;default:return}let n=this.cache.get(t);return void 0!==this.owner&&"object"===typeof n&&(n.$owner=this.owner.boxId(n.owner)),n}valueFromFieldName(e,t){if(void 0===t)return;let n=this.fields.find(t=>t.name===e);if(void 0===n)return;let r=t[e],{_tuid:i}=n;return void 0===i?r:i.valueFromId(r)}resetCache(e){this.cache.delete(e);let t=this.queue.findIndex(t=>t===e);this.queue.splice(t,1),this.useId(e)}useId(e,t){if(void 0!==e&&0!==e&&!1!==Object(l.isNumber)(e))if(!0!==this.cache.has(e))if(this.entities.cacheTuids(!0===t?70:20),this.cache.set(e,e),this.waitingIds.findIndex(t=>t===e)>=0)this.moveToHead(e);else{if(this.queue.length>=d){let t=this.queue.shift();if(t===e)return void this.queue.push(t);if(!0===this.cache.has(t))this.cache.delete(t);else{let e=this.waitingIds.findIndex(e=>e===t);this.waitingIds.splice(e,1)}}this.waitingIds.push(e),this.queue.push(e)}else this.moveToHead(e)}proxied(e,t){return h(this,void 0,void 0,function*(){this.entities.getTuid(e,void 0).useId(t);let n=yield this.tvApi.proxied(this.name,e,t);return this.cacheValue(n),n})}cacheValue(e){if(void 0===e)return!1;let t=this.getIdFromObj(e);if(void 0===t)return!1;let n=this.waitingIds.findIndex(e=>e===t);return n>=0&&this.waitingIds.splice(n,1),this.cache.set(t,e),!0}afterCacheId(e){for(let t of this.fields){let{_tuid:n}=t;void 0!==n&&n.useId(e[t.name])}}cacheIds(){return h(this,void 0,void 0,function*(){if(0===this.waitingIds.length)return;let e,t;void 0===this.owner?e=this.name:(e=this.owner.name,t=this.name);let n=yield this.tvApi.tuidIds(e,t,this.waitingIds);for(let r of n)!1!==this.cacheValue(r)&&(this.cacheTuidFieldValues(r),this.afterCacheId(r))})}load(e){return h(this,void 0,void 0,function*(){if(void 0===e||0===e)return;let t=yield this.tvApi.tuidGet(this.name,e);return t._$tuid=this,this.cacheValue(t),this.cacheTuidFieldValues(t),t})}getDiv(e){}cacheTuidFieldValues(e){let{fields:t,arrs:n}=this.schema;if(this.cacheFieldsInValue(e,t),void 0!==n)for(let r of n){let{name:t,fields:n}=r,i=e[t];if(void 0===i)continue;let s=this.getDiv(t);for(let e of i)e._$tuid=s,e.$owner=this.boxId(e.owner),this.cacheFieldsInValue(e,n)}}cacheFieldsInValue(e,t){for(let n of t){let{name:t,_tuid:r}=n;if(void 0===r)continue;let i=e[t];e[t]=r.boxId(i)}}save(e,t){return h(this,void 0,void 0,function*(){let n=s.a.clone(t);return n.$id=e,yield this.tvApi.tuidSave(this.name,n)})}search(e,t,n){return h(this,void 0,void 0,function*(){return yield this.searchArr(void 0,e,t,n)})}searchArr(e,t,n,r){return h(this,void 0,void 0,function*(){let i,s,{fields:o}=this.schema;void 0!==this.owner?(i=this.owner.name,s=this.name):(i=this.name,s=void 0);let a=yield this.tvApi.tuidSearch(i,s,e,t,n,r);for(let e of a)this.cacheFieldsInValue(e,o),void 0!==this.owner&&(e.$owner=this.owner.boxId(e.owner));return a})}loadArr(e,t,n){return h(this,void 0,void 0,function*(){if(void 0!==n&&0!==n)return yield this.tvApi.tuidArrGet(this.name,e,t,n)})}saveArr(e,t,n,r){return h(this,void 0,void 0,function*(){let i=s.a.clone(r);return i.$id=n,yield this.tvApi.tuidArrSave(this.name,e,t,i)})}posArr(e,t,n,r){return h(this,void 0,void 0,function*(){return yield this.tvApi.tuidArrPos(this.name,e,t,n,r)})}showInfo(e){return h(this,void 0,void 0,function*(){yield this.entities.usq.showTuid(this,e)})}}class p extends f{get Main(){return this}setSchema(e){super.setSchema(e);let{arrs:t}=e;if(void 0!==t){this.divs={};for(let e of t){let{name:t}=e,n=new v(this.entities,t,this.typeId);n.owner=this,this.divs[t]=n,n.setSchema(e)}}}getDiv(e){return this.divs[e]}cacheIds(){const e=e=>super[e];return h(this,void 0,void 0,function*(){if(yield e("cacheIds").call(this),void 0!==this.divs)for(let e in this.divs)yield this.divs[e].cacheIds()})}afterCacheId(e){if(super.afterCacheId(e),void 0===this.proxies)return;let{type:t,$proxy:n}=e;this.proxies[t].useId(n)}}class v extends f{get Main(){return this.owner}}var m=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class y extends u{get typeName(){return"action"}submit(e){return m(this,void 0,void 0,function*(){yield this.loadSchema();let t=this.pack(e);return yield this.tvApi.action(this.name,{data:t})})}}var b=n(7),w=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class g extends u{get typeName(){return"sheet"}setSchema(e){super.setSchema(e),this.states=e.states}build(e){this.states=[];for(let t of e.ops)this.states.push({name:t,actions:void 0})}createSheetState(e,t){let n={name:e,actions:[]},r=n.actions;for(let i in t){let e={name:i};r.push(e)}return n}save(e,t){return w(this,void 0,void 0,function*(){let{appId:n}=this.entities,r=this.pack(t);return yield this.tvApi.sheetSave(this.name,{app:n,discription:e,data:r})})}action(e,t,n,r){return w(this,void 0,void 0,function*(){return yield this.tvApi.sheetAction(this.name,{id:e,flow:t,state:n,action:r})})}unpack(e){return w(this,void 0,void 0,function*(){let t=e[0][0];return{brief:t,data:this.unpackSheet(t.data),flows:e[1]}})}getSheet(e){return w(this,void 0,void 0,function*(){let t=yield this.tvApi.getSheet(this.name,e);return 0===t[0].length?yield this.getArchive(e):yield this.unpack(t)})}getArchive(e){return w(this,void 0,void 0,function*(){let t=yield this.tvApi.sheetArchive(this.name,e);return yield this.unpack(t)})}getArchives(e,t){return w(this,void 0,void 0,function*(){return yield this.tvApi.sheetArchives(this.name,{pageStart:e,pageSize:t})})}getStateSheets(e,t,n){return w(this,void 0,void 0,function*(){return yield this.tvApi.stateSheets(this.name,{state:e,pageStart:t,pageSize:n})})}createPageStateItems(){return new k(this)}stateSheetCount(){return w(this,void 0,void 0,function*(){let e=yield this.tvApi.stateSheetCount(this.name);return this.states.map(t=>{let n=t.name,r=0,i=e.find(e=>e.state===n);return void 0!==i&&(r=i.count),{state:n,count:r}})})}}class k extends b.e{constructor(e){super(!0),this.sheet=e,this.pageSize=10}load(e,t,n){return w(this,void 0,void 0,function*(){return yield this.sheet.getStateSheets(e,t,n)})}setPageStart(e){this.pageStart=void 0===e?0:e.id}}var x=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class E extends u{get typeName(){return"query"}setSchema(e){super.setSchema(e);let{returns:t}=e;this.returns=t,this.isPaged=void 0!==t.find(e=>"$page"===e.name)}resetPage(e,t){this.pageStart=void 0,this.pageSize=e,this.params=t,this.more=!1,this.list=void 0}get hasMore(){return this.more}loadPage(){return x(this,void 0,void 0,function*(){if(void 0===this.pageSize)throw"call resetPage(size:number, params:any) first";let e;if(void 0!==this.pageStart)switch(this.startField.type){default:e=this.pageStart;break;case"date":case"time":case"datetime":e=this.pageStart.getTime()}yield this.loadSchema();let t=yield this.tvApi.page(this.name,e,this.pageSize+1,this.params),n=yield this.unpackReturns(t);this.list=r.k.array([],{deep:!1});let i=n.$page;if(void 0!==i){if(i.length>this.pageSize){this.more=!0,i.pop();let e=this.returns.find(e=>"$page"===e.name);this.startField=e.fields[0],this.pageStart=i[i.length-1][this.startField.name]}else this.more=!1;this.list.push(...i)}})}page(e,t,n){return x(this,void 0,void 0,function*(){yield this.loadSchema();let r=yield this.tvApi.page(this.name,t,n+1,e);return(yield this.unpackReturns(r)).$page})}query(e){return x(this,void 0,void 0,function*(){yield this.loadSchema();let t=yield this.tvApi.query(this.name,e);return yield this.unpackReturns(t)})}table(e){return x(this,void 0,void 0,function*(){let t=yield this.query(e);for(let e in t)return t[e]})}obj(e){return x(this,void 0,void 0,function*(){let t=yield this.table(e);if(t.length>0)return t[0]})}scalar(e){return x(this,void 0,void 0,function*(){let t=yield this.obj(e);for(let e in t)return t[e]})}}(function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);s>3&&o&&Object.defineProperty(t,n,o)})([r.k],E.prototype,"list",void 0);class O extends E{constructor(){super(...arguments),this.queryApiName="book"}get typeName(){return"book"}}class C extends E{constructor(){super(...arguments),this.queryApiName="history"}get typeName(){return"history"}}var N=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class P extends u{constructor(){super(...arguments),this.actions={},this.queries={}}get typeName(){return"map"}setSchema(e){super.setSchema(e);let{actions:t,queries:n,keys:r}=e;this.entities.buildFieldTuid(this.keys=r);for(let i in t){let e=t[i],{name:n}=e,r=this.entities.newAction(n,void 0);r.setSchema(e),this.actions[i]=r}for(let i in n){let e=n[i],{name:t}=e,r=this.entities.newQuery(t,void 0);r.setSchema(e),this.queries[i]=r}}add(e){return N(this,void 0,void 0,function*(){return yield this.loadSchema(),yield this.actions.add.submit(e)})}del(e){return N(this,void 0,void 0,function*(){return yield this.loadSchema(),yield this.actions.del.submit(e)})}all(){return N(this,void 0,void 0,function*(){return yield this.loadSchema(),yield this.queries.all.query({})})}page(e,t,n){return N(this,void 0,void 0,function*(){return yield this.loadSchema(),yield this.queries.page.page(e,t,n)})}query(e){return N(this,void 0,void 0,function*(){return yield this.loadSchema(),yield this.queries.query.query(e)})}table(e){return N(this,void 0,void 0,function*(){let t=yield this.query(e);for(let e in t)return t[e]})}obj(e){return N(this,void 0,void 0,function*(){let t=yield this.table(e);if(t.length>0)return t[0]})}scalar(e){return N(this,void 0,void 0,function*(){let t=yield this.obj(e);for(let e in t)return t[e]})}}class j extends E{constructor(){super(...arguments),this.queryApiName="pending"}get typeName(){return"pending"}}var S=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};function _(e){switch(e){case"tinyint":case"smallint":case"int":case"bigint":case"dec":return 0;case"char":case"text":return"";case"datetime":case"date":return"2000-1-1";case"time":return"0:00"}}class V{constructor(e,t,n){this.tuids={},this.actions={},this.sheets={},this.queries={},this.books={},this.maps={},this.histories={},this.pendings={},this.tuidArr=[],this.actionArr=[],this.sheetArr=[],this.queryArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.loadIds=(()=>{this.clearCacheTimer();for(let e in this.tuids){this.tuids[e].cacheIds()}}),this.usq=e,this.usqApi=t,this.appId=n}tuid(e){return this.tuids[e.toLowerCase()]}action(e){return this.actions[e.toLowerCase()]}sheet(e){return this.sheets[e.toLowerCase()]}query(e){return this.queries[e.toLowerCase()]}book(e){return this.books[e.toLowerCase()]}map(e){return this.maps[e.toLowerCase()]}history(e){return this.histories[e.toLowerCase()]}pending(e){return this.pendings[e.toLowerCase()]}sheetFromTypeId(e){for(let t in this.sheets){let n=this.sheets[t];if(n.typeId===e)return n}}loadAccess(){return S(this,void 0,void 0,function*(){let e=yield this.usqApi.loadAccess();this.buildEntities(e)})}loadEntities(){return S(this,void 0,void 0,function*(){let e=yield this.usqApi.loadEntities();this.buildEntities(e)})}buildEntities(e){let{access:t,tuids:n}=e;this.buildTuids(n),this.buildAccess(t)}getTuid(e,t,n){let r=this.tuids[e];if(void 0!==r)return void 0===t?r:r.divs[t]}cacheTuids(e){this.clearCacheTimer(),this.cacheTimer=setTimeout(this.loadIds,e)}clearCacheTimer(){void 0!==this.cacheTimer&&(clearTimeout(this.cacheTimer),this.cacheTimer=void 0)}buildTuids(e){let t={};for(let n in e){let r=e[n],{name:i,typeId:s,proxies:o}=r;this.newTuid(n,s).sys=!0,void 0!==o&&(t[n]=o)}for(let n in e){let t=e[n],{name:r}=t;this.getTuid(n).setSchema(t)}for(let n in t){let e=t[n],r=this.tuids[n];r.proxies={};for(let t of e)r.proxies[t]=this.tuids[t]}}buildAccess(e){for(let t in e){let n=e[t];switch(typeof n){case"string":this.fromType(t,n);break;case"object":this.fromObj(t,n)}}}newAction(e,t){let n=this.actions[e];return void 0!==n?n:(n=this.actions[e]=new y(this,e,t),this.actionArr.push(n),n)}newTuid(e,t){let n=this.tuids[e];return void 0!==n?n:(n=this.tuids[e]=new p(this,e,t),this.tuidArr.push(n),n)}newQuery(e,t){let n=this.queries[e];return void 0!==n?n:(n=this.queries[e]=new E(this,e,t),this.queryArr.push(n),n)}newBook(e,t){let n=this.books[e];return void 0!==n?n:(n=this.books[e]=new O(this,e,t),this.bookArr.push(n),n)}newMap(e,t){let n=this.maps[e];return void 0!==n?n:(n=this.maps[e]=new P(this,e,t),this.mapArr.push(n),n)}newHistory(e,t){let n=this.histories[e];if(void 0===n)return n=this.histories[e]=new C(this,e,t),this.historyArr.push(n),n}newPending(e,t){let n=this.pendings[e];if(void 0===n)return n=this.pendings[e]=new j(this,e,t),this.pendingArr.push(n),n}newSheet(e,t){let n=this.sheets[e];return void 0!==n?n:(n=this.sheets[e]=new g(this,e,t),this.sheetArr.push(n),n)}fromType(e,t){let n=t.split("|");t=n[0];let r=Number(n[1]);switch(t){case"usq":this.usqId=r;break;case"tuid":this.newTuid(e,r).sys=!1;break;case"action":this.newAction(e,r);break;case"query":this.newQuery(e,r);break;case"book":this.newBook(e,r);break;case"map":this.newMap(e,r);break;case"history":this.newHistory(e,r);break;case"sheet":this.newSheet(e,r);break;case"pending":this.newPending(e,r)}}fromObj(e,t){switch(t.$){case"sheet":this.buildSheet(e,t)}}buildSheet(e,t){let n=this.sheets[e];void 0===n&&(n=this.newSheet(e,t.id)),n.build(t)}buildFieldTuid(e,t){if(void 0!==e){for(let t of e){let{tuid:e,arr:n,url:r}=t;void 0!==e&&(t._tuid=this.getTuid(e,n,r))}for(let n of e){let{owner:r}=n;if(void 0===r)continue;let i=e.find(e=>e.name===r);if(void 0===i&&(void 0!==t&&(i=t.find(e=>e.name===r)),void 0===i))throw`owner field ${r} is undefined`;n._ownerField=i;let{arr:s,url:o}=n;if(n._tuid=this.getTuid(i._tuid.name,s,o),void 0===n._tuid)throw"owner field ${owner} is not tuid"}}}buildArrFieldsTuid(e,t){if(void 0!==e)for(let n of e){let{fields:e}=n;void 0!==e&&this.buildFieldTuid(e,t)}}}n.d(t,"b",function(){return _}),n.d(t,"a",function(){return V})},,function(e,t,n){"use strict";var r=n(30),i=n.n(r),s=n(13),o=n(3),a=n.n(o),c=n(9),u=n(28),l=n(7),h=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class d extends s.b{constructor(){super(...arguments),this.onNew=(()=>this.event("new")),this.onList=(()=>this.event("list")),this.onSearch=(e=>h(this,void 0,void 0,function*(){return this.event("list",e)}))}showEntry(e){return h(this,void 0,void 0,function*(){this.openPage(this.view)})}entityRender(e,t){return e.render()}entityClick(e){return h(this,void 0,void 0,function*(){yield e.onClick()})}get view(){let{label:e,proxyLinks:t}=this.controller;return()=>o.createElement(l.d,{header:e},void 0===t?o.createElement(o.Fragment,null,o.createElement(c.f,{className:"w-100",onSearch:this.onSearch,placeholder:"\u641c\u7d22"+e}),o.createElement("div",{className:"my-3"},o.createElement(u.b,{className:"ml-3",color:"primary",onClick:this.onNew},"\u65b0\u589e"),o.createElement(u.b,{className:"ml-3",color:"primary",onClick:this.onList},"\u5217\u8868"))):o.createElement(c.d,{className:"my-2",header:o.createElement(c.e,null,e," \u4ee3\u7406\u4e0b\u5217Tuid"),items:t,item:{render:this.entityRender,onClick:this.entityClick}}))}}var f=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class p extends s.b{constructor(){super(...arguments),this.next=(()=>f(this,void 0,void 0,function*(){this.vForm.reset(),this.closePage()})),this.finish=(()=>{this.closePage(2),this.event("edit-end")}),this.onSubmit=(()=>f(this,void 0,void 0,function*(){let e=this.vForm.getValues(),t=yield this.controller.entity.save(this.id,e),{id:n}=t;if(n<0){let{unique:e}=this.controller.entity;if(void 0!==e)for(let t of e)this.vForm.setError(t,"\u4e0d\u80fd\u91cd\u590d")}else this.openPageElement(o.createElement(l.d,{header:this.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},o.createElement("div",{className:"m-3"},o.createElement("span",{className:"text-success"},o.createElement(c.b,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),o.createElement("div",{className:"mt-5"},o.createElement(u.b,{className:"mr-3",color:"primary",onClick:this.next},"\u7ee7\u7eed\u5f55\u5165"),o.createElement(u.b,{color:"primary",outline:!0,onClick:this.finish},"\u4e0d\u7ee7\u7eed"))))),this.event("item-changed",{id:this.id,values:e})}))}showEntry(e){return f(this,void 0,void 0,function*(){this.vForm=this.createForm(this.onSubmit,e),void 0!==e&&(this.id=e.id),this.openPage(this.editView)})}get editView(){return()=>o.createElement(l.d,{header:(void 0===this.id?"\u65b0\u589e":"\u7f16\u8f91")+" - "+this.label},this.vForm.render("py-3"))}resetForm(){this.vForm.reset()}}var v=n(24),m=n(20),y=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class b extends s.b{constructor(){super(...arguments),this.mainView=Object(m.a)(()=>{let e=a.a.createElement(c.f,{className:"mx-1 w-100",initKey:"",onSearch:this.onSearchMain,placeholder:"\u641c\u7d22"+this.label});return a.a.createElement(l.d,{header:e,back:"close"},a.a.createElement(c.d,{items:this.controller.PageItems.items,item:{render:this.renderMainRow,onClick:this.clickMainRow},before:"\u641c\u7d22"+this.label+"\u8d44\u6599"}))}),this.onSearchMain=(e=>y(this,void 0,void 0,function*(){yield this.controller.searchMain(e)})),this.renderMainRow=((e,t)=>a.a.createElement(this.mainRowContent,Object.assign({},e))),this.clickMainRow=(e=>y(this,void 0,void 0,function*(){this.ceasePage(),void 0!==this.controller.entity.owner?yield this.showDiv(this.entity.getIdFromObj(e)):this.returnCall(e)})),this.divView=(e=>a.a.createElement(l.d,{header:"\u9009\u62e9Div"},a.a.createElement(c.d,{items:e.items,item:{render:this.renderDivRow,onClick:this.clickDivRow}}))),this.renderDivRow=((e,t)=>a.a.createElement(this.divRowContent,Object.assign({},e))),this.clickDivRow=(e=>{this.ceasePage(),this.returnCall(e)})}showEntry(e){return y(this,void 0,void 0,function*(){void 0===e?yield this.showMain(e):yield this.showDiv(e)})}showMain(e){return y(this,void 0,void 0,function*(){this.mainRowContent=this.ui.rowContent||v.c,yield this.controller.searchMain(e),this.openPage(this.mainView)})}showDiv(e){return y(this,void 0,void 0,function*(){let{divs:t}=this.ui;void 0!==t&&(this.divRowContent=t[this.entity.name].rowContent),void 0===this.divRowContent&&(this.divRowContent=v.c);let n=yield this.controller.getDivItems(e);this.openPage(this.divView,{items:n})})}}var w=n(26),g=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class k extends s.b{constructor(){super(...arguments),this.next=(()=>g(this,void 0,void 0,function*(){this.vForm.reset(),this.closePage()})),this.finish=(()=>{this.closePage(2)}),this.onSubmit=(()=>g(this,void 0,void 0,function*(){let e=this.vForm.getValues(),t=yield this.entity.save(this.id,e);t&&alert("\u8fd9\u91cc\u8fd8\u8981\u5224\u65ad\u8fd4\u56de\u503c\uff0c\u5148\u4e0d\u5904\u7406\u4e86 \n"+Object(w.a)(t)),this.openPage(()=>o.createElement(l.d,{header:this.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},o.createElement("div",{className:"m-3"},o.createElement("span",{className:"text-success"},o.createElement(c.b,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),o.createElement("div",{className:"mt-5"},o.createElement(u.b,{className:"mr-3",color:"primary",onClick:this.next},"\u7ee7\u7eed\u5f55\u5165"),o.createElement(u.b,{color:"primary",outline:!0,onClick:this.finish},"\u4e0d\u7ee7\u7eed")))))})),this.view=(()=>o.createElement(l.d,{header:this.label},this.vForm.render("py-3")))}buildForm(e){this.vForm=this.createForm(void 0,e)}showEntry(e){return g(this,void 0,void 0,function*(){this.buildForm(e),this.openPage(this.view)})}render(e){return this.buildForm(e),this.vForm.render()}loadId(e){return g(this,void 0,void 0,function*(){this.id=e})}resetForm(){this.vForm.reset()}}class x extends k{}var E=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class O extends l.e{constructor(e){super(!0),this.tuid=e}load(e,t,n){return E(this,void 0,void 0,function*(){return yield this.tuid.search(e,t,n)})}setPageStart(e){this.pageStart=void 0===e?0:e.id}}var C=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class N extends s.b{constructor(){super(...arguments),this.onSearch=(e=>C(this,void 0,void 0,function*(){yield this.controller.searchMain(e)})),this.renderRow=((e,t)=>o.createElement(this.rowContent,Object.assign({},e))),this.clickRow=(e=>{this.callOnSelected(e)}),this.rowKey=(e=>{let{id:t}=e;return t}),this.view=Object(m.a)(()=>{let e,t=o.createElement(c.f,{className:"mx-1 w-100",initKey:"",onSearch:this.onSearch,placeholder:"\u641c\u7d22"+this.label}),{owner:n}=this.entity;if(void 0!==n){let t=n.valueFromId(this.ownerId);e=o.createElement("div",null,"owner: ",Object(w.a)(t))}return o.createElement(l.d,{header:t},e,o.createElement(c.d,{items:this.controller.PageItems.items,item:{render:this.renderRow,onClick:this.clickRow,key:this.rowKey},before:"\u641c\u7d22"+this.label+"\u8d44\u6599"}))})}showEntry(e){return C(this,void 0,void 0,function*(){this.rowContent=this.ui.rowContent||v.c,void 0!==this.entity.owner&&(this.ownerId=Number(e)),yield this.controller.searchMain(""),this.openPage(this.view)})}callOnSelected(e){void 0!==this.onSelected?this.onSelected(e):alert("onSelect is undefined")}}class P extends N{onSelected(e){return C(this,void 0,void 0,function*(){this.event("edit",e.id)})}}var j=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class S extends s.a{buildPageItems(){return new O(this.entity.owner||this.entity)}searchMain(e){return j(this,void 0,void 0,function*(){void 0===this.PageItems&&(this.PageItems=this.buildPageItems()),void 0!==e&&(yield this.PageItems.first(e))})}getDivItems(e){return j(this,void 0,void 0,function*(){return yield this.entity.searchArr(e,void 0,0,1e3)})}}class _ extends S{constructor(e,t,n,r){super(e,t,n,r);let i=this.entity;if(this.proxies=i.proxies,void 0!==this.proxies){this.proxyLinks=[];for(let e in this.proxies){let t=this.cUsq.linkFromName("tuid",e);this.proxyLinks.push(t)}}}getLable(e){if(e===this.entity)return this.label;let{name:t}=e,{arrs:n}=this.res;if(void 0!==n){let e=n[t];if(void 0!==e){let t=e.label;if(void 0!==t)return t}}return t}get VTuidMain(){return d}get VTuidEdit(){return p}get VTuidList(){return P}internalStart(){return j(this,void 0,void 0,function*(){yield this.showVPage(this.VTuidMain)})}onEvent(e,t){return j(this,void 0,void 0,function*(){let n;switch(e){default:return;case"new":n=this.VTuidEdit;break;case"list":n=this.VTuidList;break;case"edit":return void(yield this.edit(t));case"item-changed":return void this.itemChanged(t)}yield this.showVPage(n,t)})}edit(e){return j(this,void 0,void 0,function*(){let t=yield this.entity.load(e),n=this.VTuidEdit;yield this.showVPage(n,t)})}itemChanged({id:e,values:t}){if(void 0===this.PageItems)return;let n=this.PageItems.items.find(t=>t.id===e);void 0!==n&&i.a.merge(n,t)}}class V extends S{internalStart(e){return j(this,void 0,void 0,function*(){yield this.showVPage(this.VTuidSelect,e)})}beforeStart(){const e=e=>super[e];return j(this,void 0,void 0,function*(){return!1!==(yield e("beforeStart").call(this))&&(void 0!==this.PageItems&&this.PageItems.reset(),!0)})}get VTuidSelect(){return b}idFromItem(e){return e.id}}class F extends S{internalStart(e){return j(this,void 0,void 0,function*(){let t=yield this.entity.load(e);yield this.showVPage(this.VTuidInfo,t)})}get VTuidInfo(){return x}}n.d(t,"b",function(){return _}),n.d(t,"c",function(){return V}),n.d(t,"a",function(){return F}),n.d(t,"d",function(){return d})},,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(6),i=n.n(r),s=n(12),o=n(14),a=n(16),c=n(15),u=n(17),l=n(25),h=n(5),d=n(22),f=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},p=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).logoutClick=function(){if(!1!==confirm("Really want to logout?")){var e=n.props.logout;"function"===typeof e&&e(),d.c.logout()}},n.navChange=n.navChange.bind(Object(l.a)(Object(l.a)(n))),n.state={hasBack:!1},n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"navChange",value:function(){this.setState({hasBack:d.c.level>1})}},{key:"componentWillMount",value:function(){this.navChange()}},{key:"componentWillUnmount",value:function(){}},{key:"back",value:function(){return f(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.c.back();case 2:case"end":return e.stop()}},e,this)}))}},{key:"openWindow",value:function(){window.open(document.location.href)}},{key:"render",value:function(){var e,t,n,r,i=this.state.hasBack||self!=top,s=this.props,o=s.right,a=s.center,c=s.logout;if(void 0!==c&&self===top&&("boolean"===typeof c&&!0===c||"function"===typeof c)){var u=d.c.user,l=u.nick,f=u.name;n=h.createElement("div",{className:"d-flex align-items-center"},h.createElement("small",{className:"text-light"},l||f),h.createElement("a",{className:"dropdown-toggle btn btn-secondary btn-sm ml-2",role:"button",onClick:this.logoutClick},h.createElement("i",{className:"fa fa-sign-out"})))}if(i)switch(this.props.back){case"none":e=void 0;break;default:case"back":e=h.createElement("nav",{onClick:this.back},h.createElement("i",{className:"fa fa-arrow-left"}));break;case"close":e=h.createElement("nav",{onClick:this.back},h.createElement("i",{className:"fa fa-close"}))}return self!=top&&(console.log(document.location.href),t=h.createElement("header",{onClick:this.openWindow})),(o||n)&&(r=h.createElement("aside",null,o," ",n)),h.createElement("header",{style:d.b},t,e,h.createElement("div",null,a),r)}}]),t}(h.Component)},function(e,t,n){"use strict";var r=n(13),i=n(3),s=n.n(i),o=n(20),a=n(9),c=n(7),u=n(26);const l=e=>s.a.createElement("div",{className:"px-3 py-2"},Object(u.a)(e));var h=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class d extends r.b{constructor(){super(...arguments),this.onSubmit=(()=>h(this,void 0,void 0,function*(){let e=this.vForm.getValues();if(!0===this.entity.isPaged)yield this.entity.resetPage(30,e),yield this.entity.loadPage(),this.replacePage(this.pageResult);else{let t=yield this.entity.query(e);this.replacePage(this.queryResult,t)}})),this.again=(()=>{this.vForm.reset(),this.replacePage(this.view)}),this.renderRow=((e,t)=>i.createElement(this.row,Object.assign({},e))),this.view=(()=>i.createElement(c.d,{header:this.label},this.vForm.render("mx-3 my-2"),this.renderExtra())),this.pageResult=(()=>{let{name:e,list:t}=this.entity,n=i.createElement("button",{className:"btn btn-outline-success",onClick:this.again},i.createElement(a.b,{name:"search"})," \u518d\u67e5\u8be2");return i.createElement(c.d,{header:this.label,right:n},i.createElement(a.d,{items:t,item:{render:this.renderRow}}))}),this.queryResult=Object(o.a)(e=>{let t=i.createElement("button",{className:"btn btn-outline-success",onClick:this.again},i.createElement(a.b,{name:"search"})," \u518d\u67e5\u8be2");return i.createElement(c.d,{header:this.label,right:t},i.createElement("pre",null,JSON.stringify(e,void 0,"\t")))})}showEntry(e){return h(this,void 0,void 0,function*(){this.vForm=this.createForm(this.onSubmit,e);let{row:t,queryRow:n}=this.ui;this.row=n||t||l,this.openPage(this.view)})}renderExtra(){}}var f=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class p extends r.b{constructor(){super(...arguments),this.onSearch=(e=>f(this,void 0,void 0,function*(){yield this.PageItems.first(e)})),this.renderRow=((e,t)=>i.createElement(this.row,Object.assign({},e))),this.clickRow=(e=>{this.callOnSelected(e)}),this.view=(()=>{let e=i.createElement(a.f,{className:"mx-1 w-100",initKey:"",onSearch:this.onSearch,placeholder:"\u641c\u7d22"+this.label});return i.createElement(c.d,{header:e},i.createElement(a.d,{items:this.PageItems.items,item:{render:this.renderRow,onClick:this.clickRow},before:"\u641c\u7d22"+this.label+"\u8d44\u6599"}))})}showEntry(e){return f(this,void 0,void 0,function*(){let{row:t,selectRow:n}=this.ui;this.row=n||t||l,this.PageItems=new v(this.entity),yield this.onSearch(e),this.openPage(this.view)})}callOnSelected(e){this.closePage(),this.returnCall(e)}}class v extends c.e{constructor(e){super(),this.query=e}load(){return f(this,void 0,void 0,function*(){let e;if(yield this.query.loadSchema(),!0===this.query.isPaged)e=yield this.query.page(this.param,this.pageStart,this.pageSize);else{e=(yield this.query.query(this.param))[this.query.returns[0].name]}return e})}setPageStart(e){void 0===e&&(this.pageStart=0)}}var m=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class y extends r.a{}class b extends y{internalStart(){return m(this,void 0,void 0,function*(){yield this.showVPage(this.VQueryMain)})}get VQueryMain(){return this.ui&&this.ui.main||d}}class w extends y{internalStart(e){return m(this,void 0,void 0,function*(){yield this.showVPage(this.VQuerySelect,e)})}get VQuerySelect(){return p}}n.d(t,"a",function(){return b}),n.d(t,"b",function(){return w}),n.d(t,"c",function(){return d})},,,function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(3),i=n(7),s=n(9),o=n(68),a=n(66),c=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class u extends i.b{constructor(e,t){super(Object(i.p)(t.res,i.n.language,i.n.culture)),this.cUsqCollection={},this.renderRow=((e,t)=>{let{id:n,nick:i,name:o}=e;return r.createElement(s.c,{className:"px-3 py-2",right:"id: "+n},r.createElement("div",null,i||o))}),this.onRowClick=(e=>c(this,void 0,void 0,function*(){i.m.unit=e.id,yield this.start()})),this.selectUnitPage=(()=>r.createElement(i.d,{header:"\u9009\u62e9\u5c0f\u53f7",logout:!0},r.createElement(s.d,{items:this.appUnits,item:{render:this.renderRow,onClick:this.onRowClick}})));let n=e.split("/");if(2!==n.length)throw"tonvaApp name must be / separated, owner/app";this.appOwner=n[0],this.appName=n[1],this.ui=t,this.caption=this.res.caption||"Tonva"}loadUsqs(){return c(this,void 0,void 0,function*(){let e=[],t=(i.m.unit,yield Object(i.l)(this.appOwner,this.appName)),{id:n,usqs:r}=t;this.id=n;for(let i of r){let{id:t,usqOwner:n,usqName:r,url:s,urlDebug:o,ws:a,access:c,token:u}=i,l=n+"/"+r,h=this.ui&&this.ui.usqs&&this.ui.usqs[l],d=this.newCUsq(l,t,c,h||{}),f=yield d.loadSchema();void 0===f?this.cUsqCollection[l]=d:e.push(f)}if(0!==e.length)return e})}newCUsq(e,t,n,r){let i=new(this.ui.CUsq||o.a)(e,this.id,t,n,r);return Object.setPrototypeOf(i.x,this.x),i}get cUsqArr(){let e=[];for(let t in this.cUsqCollection)e.push(this.cUsqCollection[t]);return e}getCUsq(e){return this.cUsqCollection[e]}get VAppMain(){return this.ui&&this.ui.main||l}beforeStart(){const e=e=>super[e];return c(this,void 0,void 0,function*(){if(!1===(yield e("beforeStart").call(this)))return!1;try{let e=document.location.hash;e.startsWith("#tvdebug")?this.isProduction=!1:this.isProduction=e.startsWith("#tv");let{unit:n}=i.m;if(!1===this.isProduction&&(void 0===n||n<=0)){let e=yield Object(i.l)(this.appOwner,this.appName),{id:t}=e;switch(this.id=t,yield this.loadAppUnits(),this.appUnits.length){case 0:return this.showUnsupport(),!1;case 1:if(void 0===(n=this.appUnits[0].id)||n<0)return this.showUnsupport(),!1;i.m.unit=n;break;default:return i.n.clear(),i.n.push(r.createElement(this.selectUnitPage,null)),!1}}let s=yield this.loadUsqs();return void 0===s||(this.openPage(r.createElement(i.d,{header:"ERROR"},r.createElement("div",{className:"m-3"},r.createElement("div",null,"Load Usqs \u53d1\u751f\u9519\u8bef\uff1a"),s.map((e,t)=>r.createElement("div",{key:t},e))))),!1)}catch(t){return i.n.push(r.createElement(i.d,{header:"App start error!"},r.createElement("pre",null,"string"===typeof t?t:t.message))),!1}})}internalStart(){return c(this,void 0,void 0,function*(){yield this.showMainPage()})}clearPrevPages(){i.n.clear()}showUnsupport(){this.clearPrevPages(),this.openPage(r.createElement(i.d,{header:"APP\u65e0\u6cd5\u8fd0\u884c",logout:!0},r.createElement("div",{className:"m-3 text-danger container"},r.createElement("div",{className:"form-group row"},r.createElement("div",{className:"col-2"},r.createElement(s.b,{name:"exclamation-triangle"})),r.createElement("div",{className:"col"},"\u7528\u6237\u4e0d\u652f\u6301APP")),r.createElement("div",{className:"form-group row"},r.createElement("div",{className:"col-2"},"\u7528\u6237: "),r.createElement("div",{className:"col"},`${i.n.user.name}`)),r.createElement("div",{className:"form-group row"},r.createElement("div",{className:"col-2"},"App:"),r.createElement("div",{className:"col"},`${this.appOwner}/${this.appName}`)))))}showMainPage(){return c(this,void 0,void 0,function*(){let e=document.location.hash.split("-");if(e.length>2){let t=e[2];if("sheet"===t||"sheet_debug"===t){let t=Number(e[3]),n=Number(e[4]),r=Number(e[5]),i=this.getCUsqFromId(t);return void 0===i?void alert("unknown usqId: "+t):(this.clearPrevPages(),void(yield i.navSheet(n,r)))}}this.clearPrevPages(),this.showVPage(this.VAppMain)})}getCUsqFromId(e){for(let t in this.cUsqCollection){let n=this.cUsqCollection[t];if(n.id===e)return n}}loadAppUnits(){return c(this,void 0,void 0,function*(){let e=yield a.a.userAppUnits(this.id);this.appUnits=e,1===e.length&&(i.m.unit=e[0].id)})}}class l extends i.h{constructor(){super(...arguments),this.appPage=(()=>{let e,{caption:t,cUsqArr:n}=this.controller;return e=0===n.length?r.createElement("div",{className:"text-danger"},r.createElement(s.b,{name:""})," \u6b64APP\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u7684USQ"):n.map((e,t)=>r.createElement("div",{key:t},e.render())),r.createElement(i.d,{header:t,logout:()=>{i.m.unit=void 0}},e)})}showEntry(e){return c(this,void 0,void 0,function*(){this.openPage(this.appPage)})}}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),i=n.n(r),s=n(9);function o(e,t){return i.a.createElement(s.b,{className:e,name:t,fixWidth:!0})}const a={tuid:o("text-info","list-alt"),action:o("text-info","hand-o-right"),map:o("text-muted","list-ul"),book:o("text-muted","book"),query:o("text-warning","search"),history:o("text-info","hand-o-right"),pending:o("text-info","forward"),sheet:o("text-primary","wpforms")}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(7);class i extends r.b{constructor(e,t){super(t),this.cUsq=e}}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(7),i=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};const s=new class extends r.a{userAppUnits(e){return i(this,void 0,void 0,function*(){return yield this.get("tie/user-app-units",{app:e})})}}("tv/",void 0)},function(e,t,n){"use strict";var r=n(18),i=n(7),s=n(13),o=n(3),a=n.n(o),c=n(20),u=n(28),l=n(9),h=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class d extends s.b{constructor(){super(...arguments),this.newClick=(()=>this.event("new")),this.schemaClick=(()=>this.event("schema")),this.archivesClick=(()=>this.event("archives")),this.sheetStateClick=(e=>this.event("state",e)),this.renderState=((e,t)=>{let{state:n,count:r}=e;if(0===r)return null;let i=o.createElement(u.a,{className:"ml-5 align-self-end",color:"success"},r);return o.createElement(l.c,{className:"px-3 py-2",left:this.controller.getStateLabel(n),right:i})}),this.view=Object(c.a)(()=>{let e,t=this.controller.statesCount.filter(e=>e.count),n=o.createElement("button",{className:"btn btn-outline-primary",onClick:this.archivesClick},"\u5df2\u5f52\u6863");return!0===this.isDev&&(e=o.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:this.schemaClick},"\u6a21\u677f")),o.createElement(i.d,{header:this.label},o.createElement(l.c,{className:"mx-3 my-2",right:n},o.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:this.newClick},"\u65b0\u5efa"),e),o.createElement(l.d,{className:"my-2",header:o.createElement(l.e,{className:"mx-3 my-1"},"\u5f85\u5904\u7406",this.label),none:"[ \u65e0 ]",items:t,item:{render:this.renderState,onClick:this.sheetStateClick}}))})}showEntry(){return h(this,void 0,void 0,function*(){yield this.controller.getStateSheetCount(),this.openPage(this.view)})}}var f=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class p extends s.b{constructor(){super(...arguments),this.onSubmit=(()=>f(this,void 0,void 0,function*(){let e=this.vForm.getValues(),t=this.vForm.values;yield this.controller.onSave(e,t)})),this.view=(()=>o.createElement(i.d,{header:this.label},this.vForm.render()))}showEntry(e){return f(this,void 0,void 0,function*(){this.vForm=this.createForm(this.onSubmit,e),this.openPage(this.view)})}}var v=n(47);const m={width:"8rem"};class y extends s.b{constructor(){super(...arguments),this.flowRow=((e,t)=>{let n,{date:r,user:i,preState:s,state:a,action:c}=e;switch(void 0===c&&(c=o.createElement(o.Fragment,null,o.createElement(l.b,{className:"text-primary",name:"pencil-square-o"})," \u5236\u5355")),a){case"$":break;case"#":n=o.createElement(o.Fragment,null,o.createElement(l.b,{className:"text-success",name:"file-archive-o"}));break;default:n=o.createElement(o.Fragment,null,o.createElement(l.b,{className:"text-muted",name:"arrow-right"})," \xa0 ",a)}return o.createElement(l.c,{left:o.createElement("div",{className:"pl-3 py-2",style:m},c),right:o.createElement("div",{className:"p-2"},o.createElement(l.e,null,o.createElement(l.a,{date:r})))},o.createElement("div",{className:"p-2"},n))}),this.sheetView=(()=>{let e,{brief:t,flows:n}=this.sheetData;return"-"===t.state&&(e=o.createElement("div",{className:"mx-3 my-2",style:{color:"red"}},"\u672c\u5355\u636e\u4f5c\u5e9f")),o.createElement("div",null,e,this.vForm.render(),o.createElement(l.d,{header:o.createElement(l.e,{className:"mx-3 my-1"},"\u6d41\u7a0b"),items:n,item:{render:this.flowRow}}))})}}var b=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class w extends y{constructor(){super(...arguments),this.onSubmit=(()=>b(this,void 0,void 0,function*(){let e=this.vForm.getValues();yield this.controller.saveSheet(e,this.vForm.values),this.closePage(),this.returnCall(this.vForm.values)})),this.view=(()=>o.createElement(i.d,{header:this.label},this.vForm.render()))}showEntry(e){return b(this,void 0,void 0,function*(){this.sheetData=e,this.vForm=this.createForm(this.onSubmit,e.data,v.a.edit),this.openPage(this.view)})}}var g=n(11),k=n.n(g),x=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class E extends y{constructor(){super(...arguments),this.actionClick=(e=>x(this,void 0,void 0,function*(){let{id:t,flow:n,state:r}=this.sheetData.brief;yield this.controller.action(t,n,r,e.name);this.ceasePage(),this.openPage(this.acted)})),this.deleteClick=(()=>x(this,void 0,void 0,function*(){alert("\u5355\u636e\u4f5c\u5e9f\uff1a\u7a0b\u5e8f\u6b63\u5728\u8bbe\u8ba1\u4e2d")})),this.editClick=(()=>x(this,void 0,void 0,function*(){let e=yield this.controller.editSheet(this.sheetData);this.vForm.setValues(e)})),this.page=(()=>{let e,t,{brief:n}=this.sheetData,{state:r,no:s}=n,o=this.controller.getStateLabel(r),{states:c}=this.entity,l=c.find(e=>e.name===r);if(void 0===l){let t,n;switch(r){default:t="\u4e0d\u8ba4\u8bc6\u7684\u5355\u636e\u72b6\u6001'"+r+"'",n="text-info";break;case"-":t="\u5df2\u4f5c\u5e9f",n="text-danger";break;case"#":t="\u5df2\u5f52\u6863",n="text-success"}e=a.a.createElement("div",{className:k()(n)},"[",t,"]")}else e=a.a.createElement("div",{className:"flex-grow-1"},l.actions.map((e,t)=>a.a.createElement(u.b,{key:t,className:"mr-2",color:"primary",onClick:()=>this.actionClick(e)},this.controller.getActionLabel(r,e.name)))),"$"===r&&(t=a.a.createElement("div",null,a.a.createElement(u.b,{outline:!0,className:"ml-2",color:"info",onClick:this.editClick},"\u4fee\u6539"),a.a.createElement(u.b,{outline:!0,className:"ml-2",color:"danger",onClick:this.deleteClick},"\u4f5c\u5e9f")));return a.a.createElement(i.d,{header:this.label+":"+o+"-"+s},a.a.createElement("div",{className:"mb-2"},a.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},e,t),a.a.createElement(this.sheetView,null)))}),this.acted=(()=>{let{discription:e}=this.sheetData.brief;return a.a.createElement(i.d,{header:"\u5df2\u5904\u7406",back:"close"},a.a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.a.createElement("div",{className:"p-3"},e),a.a.createElement("div",{className:"text-success"},a.a.createElement(l.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),a.a.createElement("div",{className:"p-3"},a.a.createElement("button",{className:"btn btn-outline-info",onClick:()=>this.backPage()},"\u8fd4\u56de"))))})}showEntry(e){return x(this,void 0,void 0,function*(){this.sheetData=e,this.vForm=this.createForm(void 0,e.data),this.openPage(this.page)})}}var O=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class C extends s.b{constructor(){super(...arguments),this.view=(()=>o.createElement(i.d,{header:this.label+"\u6a21\u677f"},o.createElement("pre",{className:"mx-3 my-2"},this.entity.schemaStringify())))}showEntry(e){return O(this,void 0,void 0,function*(){this.openPage(this.view)})}}var N=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class P extends s.b{constructor(){super(...arguments),this.archiveClick=(e=>N(this,void 0,void 0,function*(){1!==e.processing&&this.event("archived",e)})),this.archiveRow=((e,t)=>{let{id:n,no:r,discription:i,date:s}=e,a=o.createElement(o.Fragment,null,1===e.processing?"... ":"",e.no," \xa0 ",e.discription),c=o.createElement(l.e,null,o.createElement(l.a,{date:s}));return o.createElement(l.c,{className:"px-3 py-2",left:a,right:c})}),this.view=(()=>o.createElement(i.d,{header:"\u5df2\u5f52\u6863"+this.label},o.createElement(l.d,{items:this.list,item:{render:this.archiveRow,onClick:this.archiveClick}})))}showEntry(){return N(this,void 0,void 0,function*(){this.list=yield this.entity.getArchives(void 0,10),this.openPage(this.view)})}}var j=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class S extends s.b{constructor(){super(...arguments),this.rowClick=(e=>j(this,void 0,void 0,function*(){1!==e.processing?this.event("action",e.id):this.event("processing",e.id)})),this.onScrollBottom=(()=>{console.log("onScrollBottom"),this.controller.pageStateItems.more()}),this.rowContent=(e=>{let{id:t,no:n,discription:r,date:i,processing:s}=e,a=o.createElement(o.Fragment,null,n," \xa0 ",o.createElement(l.e,null,r)," ",1===s?"...":""),c=o.createElement(l.e,null,o.createElement(l.a,{date:i}));return o.createElement(l.c,{className:"px-3 py-2",left:a,right:c})}),this.renderRow=((e,t)=>o.createElement(this.row,Object.assign({},e))),this.view=(()=>{let{pageStateItems:e}=this.controller;return o.createElement(i.d,{header:this.label+" - "+this.stateLabel,onScrollBottom:this.onScrollBottom},o.createElement(l.d,{items:e,item:{render:this.renderRow,onClick:this.rowClick}}))})}showEntry(e){return j(this,void 0,void 0,function*(){this.row=this.ui.listRow||this.rowContent,this.stateName=e.state,this.stateLabel=this.controller.getStateLabel(this.stateName),yield this.controller.pageStateItems.first(this.stateName),this.openPage(this.view)})}}var _=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class V extends y{constructor(){super(...arguments),this.view=(()=>{let{brief:e}=this.sheetData;return o.createElement(i.d,{header:this.label+":-"+e.no},o.createElement(this.sheetView,null))})}showEntry(e){return _(this,void 0,void 0,function*(){this.sheetData=e,this.vForm=this.createForm(void 0,this.sheetData.data),this.openPage(this.view)})}}class F extends s.b{}var A=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class I extends F{constructor(){super(...arguments),this.restart=(()=>A(this,void 0,void 0,function*(){this.ceasePage(),yield this.event("new")})),this.actionClick=(e=>A(this,void 0,void 0,function*(){this.ceasePage();let{id:t,flow:n,state:r}=this.brief;yield this.controller.action(t,n,r,e.name);this.openPage(this.acted)})),this.buttons=o.createElement(o.Fragment,null,o.createElement("button",{className:"btn btn-outline-primary mr-3",onClick:this.restart},"\u7ee7\u7eed\u5f00\u5355"),o.createElement("button",{className:"btn btn-outline-info",onClick:()=>this.backPage()},"\u8fd4\u56de")),this.view=(()=>{let{states:e}=this.entity;let t=e.find(e=>"$"===e.name),n=o.createElement(o.Fragment,null,t.actions.map((e,t)=>o.createElement("button",{key:t,className:"btn btn-primary mr-3",onClick:()=>this.actionClick(e)},this.controller.getActionLabel("$",e.name))));return o.createElement(i.d,{header:"\u5df2\u4fdd\u5b58",back:"close"},o.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},o.createElement("div",{className:"text-success"},o.createElement(l.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u4fdd\u5b58\uff01\u7cfb\u7edf\u5c1a\u672a\u5904\u7406"),o.createElement("div",{className:"p-3"},n,this.buttons)))}),this.acted=(()=>o.createElement(i.d,null,o.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},o.createElement("div",{className:"text-success"},o.createElement(l.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),o.createElement("div",{className:"p-3"},this.buttons))))}showEntry(e){return A(this,void 0,void 0,function*(){this.brief=e,this.openPage(this.view)})}}var R=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class T extends y{constructor(){super(...arguments),this.page=(()=>{let{brief:e}=this.sheetData,{state:t,no:n}=e,r=this.controller.getStateLabel(t);return a.a.createElement(i.d,{header:this.label+":"+r+"-"+n},a.a.createElement("div",{className:"mb-2"},a.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},"\u6b63\u5728\u5904\u7406\u4e2d..."),a.a.createElement(this.sheetView,null)))})}showEntry(e){return R(this,void 0,void 0,function*(){this.sheetData=e,this.vForm=this.createForm(void 0,e.data),this.openPage(this.page)})}}var q=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class M extends s.a{constructor(){super(...arguments),this.statesCount=r.k.array([],{deep:!0}),this.onSave=((e,t)=>q(this,void 0,void 0,function*(){let n=yield this.saveSheet(e,t);this.ceasePage(),yield this.showSaved(n)}))}internalStart(){return q(this,void 0,void 0,function*(){this.pageStateItems=this.entity.createPageStateItems(),yield this.showVPage(this.VSheetMain)})}onMessage(e){return q(this,void 0,void 0,function*(){let{type:t,body:n,from:r,to:i,push:s}=e;"sheet"===t&&this.onSheet(r,i,n)})}onSheet(e,t,n){let r=this.user.id,{id:i,preState:s,state:o}=n;console.log({$:"onMessage sheet",from:e,to:t.join(","),id:i,preState:s,state:o,me:r,sheetData:n}),e===r&&this.sheetActPreState(i,s),void 0!==t.find(e=>e===r)&&this.sheetActState(i,o,n)}sheetActPreState(e,t){if(this.changeStateCount(t,-1),void 0===this.curState||this.curState!==t)return;let n=this.pageStateItems.items.findIndex(t=>t.id===e);n>=0&&this.pageStateItems.items.splice(n,1)}sheetActState(e,t,n){this.changeStateCount(t,1),void 0!==this.curState&&this.curState===t&&this.pageStateItems.items.findIndex(t=>t.id===e)<0&&this.pageStateItems.items.push(n)}changeStateCount(e,t){if(void 0===e)return;let n=this.statesCount.findIndex(t=>t.state===e);if(console.log({$:"changeState",state:e,delta:t,index:n}),n<0)return;let r=this.statesCount[n];r.count+=t,r.count<0&&(r.count=0)}get VSheetMain(){return this.ui&&this.ui.main||d}get VSheetNew(){return this.ui.sheetNew||p}get VSheetSaved(){return this.ui.sheetSaved||I}get VSheetEdit(){return this.ui.sheetEdit||w}get VSheetSchema(){return C}get VArchives(){return P}get VArchived(){return V}get VSheetList(){return S}get VSheetAction(){return this.ui.sheetAction||E}get VSheetProcessing(){return T}onEvent(e,t){return q(this,void 0,void 0,function*(){let n;switch(e){default:return;case"new":n=this.VSheetNew;break;case"schema":n=this.VSheetSchema;break;case"archives":n=this.VArchives;break;case"state":this.curState=t.state,n=this.VSheetList;break;case"archived":return void(yield this.showArchived(t));case"action":return void(yield this.showAction(t));case"processing":return void(yield this.showProcessing(t))}yield this.showVPage(n,t)})}startSheet(e){return q(this,void 0,void 0,function*(){!1!==(yield this.beforeStart())&&(yield this.onEvent("action",e))})}showAction(e){return q(this,void 0,void 0,function*(){let t=yield this.getSheetData(e);Object(i.o)({body:{$type:"msg",action:"$sheet",msg:{id:e,usq:this.cUsq.id,state:t.brief.state}}}),yield this.showVPage(this.VSheetAction,t)})}showProcessing(e){return q(this,void 0,void 0,function*(){let t=yield this.getSheetData(e);yield this.showVPage(this.VSheetProcessing,t)})}editSheet(e){return q(this,void 0,void 0,function*(){return yield this.vCall(this.VSheetEdit,e)})}showArchived(e){return q(this,void 0,void 0,function*(){let t=yield this.getArchived(e.id);yield this.showVPage(this.VArchived,t)})}showSaved(e){return q(this,void 0,void 0,function*(){yield this.showVPage(this.VSheetSaved,e)})}getStateUI(e){let{states:t}=this.res;if(void 0!==t)return t[e]}getStateLabel(e){let t=this.getStateUI(e),n=t&&t.label||e;switch(n){default:return n;case"$":return"\u65b0\u5355"}}getActionLabel(e,t){let n=this.getStateUI(e);if(void 0===n)return t;let r=n.actions;if(void 0===r)return t;let i=r[t];return i&&i.label||t}getStateSheetCount(){return q(this,void 0,void 0,function*(){this.statesCount.clear();let e=yield this.entity.stateSheetCount();this.statesCount.splice(0,0,...e)})}getSheetData(e){return q(this,void 0,void 0,function*(){return yield this.entity.getSheet(e)})}getArchived(e){return q(this,void 0,void 0,function*(){return yield this.entity.getArchive(e)})}saveSheet(e,t){return q(this,void 0,void 0,function*(){let{sheetTitle:n}=this.ui,r=void 0===n?this.label:n(t,this.x);return yield this.entity.save(r,e)})}action(e,t,n,r){return q(this,void 0,void 0,function*(){return yield this.entity.action(e,t,n,r)})}}n.d(t,"a",function(){return M})},function(e,t,n){"use strict";var r=n(7),i=n(52),s=n(34),o=n(13),a=n(3),c=n.n(a),u=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class l extends o.b{constructor(){super(...arguments),this.view=(()=>a.createElement(r.d,{header:this.label},"Book"))}showEntry(e){return u(this,void 0,void 0,function*(){this.openPage(this.view)})}}var h=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class d extends o.a{internalStart(){return h(this,void 0,void 0,function*(){yield this.showVPage(this.VBookMain)})}get VBookMain(){return l}}var f=n(67),p=n(70),v=n(60),m=n(54),y=n(69),b=n(24),w=n(9);class g extends r.j{constructor(e){super(e),this.isSysVisible=!1,this.view=(()=>{let e,{res:t,usq:n,error:r}=this.controller,i={render:(e,t)=>e.render(),onClick:void 0},s=[{header:t.tuid||"TUID",items:this.tuidLinks},{cn:"my-2",header:t.map||"MAP",items:this.mapLinks},{cn:"my-2",header:t.sheet||"SHEET",items:this.sheetLinks},{cn:"my-2",header:t.action||"ACTION",items:this.actionLinks},{cn:"my-2",header:t.query||"QUERY",items:this.queryLinks},{cn:"mt-2 mb-4",header:t.book||"BOOK",items:this.bookLinks},{cn:"mt-2 mb-4",header:t.history||"HISTORY",items:this.historyLinks},{cn:"mt-2 mb-4",header:t.pending||"PENDING",items:this.pendingLinks}];return e=void 0!==r?c.a.createElement("div",{className:"p-3 text-danger"},"\u8fde\u63a5\u9519\u8bef: ",r):s.map(({cn:e,header:t,items:n},r)=>n.length>0&&c.a.createElement(w.d,{key:r,className:e,header:c.a.createElement("div",{className:"px-3 py-1 bg-light"},c.a.createElement(w.e,null,t)),items:n,item:i})),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"px-3 py-1 small"},t.usq||n),e)});let{tuidArr:t,mapArr:n,sheetArr:r,actionArr:i,queryArr:o,bookArr:a,historyArr:u,pendingArr:l}=e.entities;this.tuidLinks=t.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cTuidMain(e))),this.mapLinks=n.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cMap(e))),this.sheetLinks=r.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cSheet(e))),this.actionLinks=i.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cAction(e))),this.queryLinks=o.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cQuery(e))),this.bookLinks=a.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cBook(e))),this.historyLinks=u.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cHistory(e))),this.pendingLinks=l.filter(e=>this.isVisible(e)).map(e=>new s.a(this.controller.cPending(e)))}isVisible(e){return!0!==e.sys||this.isSysVisible}render(e){return void 0===this.view?c.a.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):c.a.createElement(this.view)}}var k=n(71),x=n(72),E=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};function O(e){if(void 0!==e)for(let t in e)e[t.toLowerCase()]=e[t]}class C extends r.b{constructor(e,t,n,s,o){super(Object(r.p)(o.res,r.n.language,r.n.culture)),this.isSysVisible=!1,this.usq=e,this.id=n,O(o.tuid),O(o.sheet),O(o.map),O(o.query),O(o.action),O(o.book),O(o.history),O(o.pending),this.ui=o,this.CTuidMain=o.CTuidMain||m.b,this.CTuidSelect=o.CTuidSelect||m.c,this.CTuidInfo=o.CTuidInfo||m.a,this.CQuery=o.CQuery||v.a,this.CQuerySelect=o.CQuerySelect||v.b,this.CMap=o.CMap||y.a,this.CAction=o.CAction||p.a,this.CSheet=o.CSheet||f.a,this.CBook=o.CBook||d,this.CHistory=o.CHistory||k.a,this.CPending=o.CPending||x.a;let a,c,u=e.split("/");switch(u.length){case 1:a="$$$",c=u[0];break;case 2:a=u[0],c=u[1];break;default:return void console.log("usq must be usqOwner/usqName format")}let l,h,b=document.location.hash,w=void 0===b||""===b?"debug/":"tv/";l=void 0===s||"*"===s?[]:s.split(";").map(e=>e.trim()).filter(e=>e.length>0),h="$$$/$unitx"===e?new r.f(r.m.unit):new r.g(w,a,c,l,!0),this.entities=new i.a(this,h,t)}internalStart(){return E(this,void 0,void 0,function*(){})}loadEntites(){return E(this,void 0,void 0,function*(){yield this.entities.loadAccess()})}loadSchema(){return E(this,void 0,void 0,function*(){try{yield this.loadEntites(),void 0===this.id&&(this.id=this.entities.usqId);for(let e in this.ui){let t=this.ui[e];if(void 0===t)continue;let{caption:n,collection:r}=t;if(void 0!==r)for(let i in r)void 0===this.entities[e](i)&&console.warn(e+":'"+i+"' is not usql entity")}return}catch(e){return console.error(e),this.error=e,e.message}})}getQuerySearch(e){return E(this,void 0,void 0,function*(){let t=this.entities.query(e);if(void 0===t)alert(`QUERY ${e} \u6ca1\u6709\u5b9a\u4e49!`);else{yield t.loadSchema();let{returns:n}=t;n.length>1&&alert(`QUERY ${e} \u8fd4\u56de\u591a\u5f20\u8868, \u65e0\u6cd5\u505aQuerySearch`)}return t})}getTuidPlaceHolder(e){let t,{tuidPlaceHolder:n,entity:r}=this.res,{name:i}=e;if(void 0!==r){let e=r[i];void 0!==e&&(t=e.label)}return n||"Select"}getNone(){let{none:e}=this.res;return e||"none"}isVisible(e){return!0!==e.sys||this.isSysVisible}navSheet(e,t){return E(this,void 0,void 0,function*(){let n=this.entities.sheetFromTypeId(e);if(void 0===n)return void alert("sheetTypeId "+e+" is not exists!");let r=this.cSheet(n);yield r.startSheet(t)})}sheet(e){return this.entities.sheet(e)}action(e){return this.entities.action(e)}query(e){return this.entities.query(e)}book(e){return this.entities.book(e)}map(e){return this.entities.map(e)}history(e){return this.entities.history(e)}pending(e){return this.entities.pending(e)}tuid(e){return this.entities.tuid(e)}tuidDiv(e,t){let n=this.entities.tuid(e);if(void 0===n)return;let{divs:r}=n;return void 0!==r?r[t]:void 0}cSheetFromName(e){let t=this.entities.sheet(e);if(void 0!==t)return this.cSheet(t)}cActionFromName(e){let t=this.entities.action(e);if(void 0!==t)return this.cAction(t)}cQueryFromName(e){let t=this.entities.query(e);if(void 0!==t)return this.cQuery(t)}cBookFromName(e){let t=this.entities.book(e);if(void 0!==t)return this.cBook(t)}cMapFromName(e){let t=this.entities.map(e);if(void 0!==t)return this.cMap(t)}cHistoryFromName(e){let t=this.entities.history(e);if(void 0!==t)return this.cHistory(t)}cPendingFromName(e){let t=this.entities.pending(e);if(void 0!==t)return this.cPending(t)}cTuidMainFromName(e){let t=this.entities.tuid(e);if(void 0!==t)return this.cTuidMain(t)}cTuidInfoFromName(e){let t=this.entities.tuid(e);if(void 0!==t)return this.cTuidInfo(t)}cTuidSelectFromName(e){let t=this.entities.tuid(e);if(void 0!==t)return this.cTuidSelect(t)}cFromName(e,t){switch(e){case"sheet":let n=this.entities.sheet(t);if(void 0===n)return;return this.cSheet(n);case"action":let r=this.entities.action(t);if(void 0===r)return;return this.cAction(r);case"tuid":let i=this.entities.tuid(t);if(void 0===i)return;return this.cTuidMain(i);case"query":let s=this.entities.query(t);if(void 0===s)return;return this.cQuery(s);case"book":let o=this.entities.book(t);if(void 0===o)return;return this.cBook(o);case"map":let a=this.entities.map(t);if(void 0===a)return;return this.cMap(a);case"history":let c=this.entities.history(t);if(void 0===c)return;return this.cHistory(c);case"pending":let u=this.entities.pending(t);if(void 0===u)return;return this.cPending(u)}}linkFromName(e,t){return this.link(this.cFromName(e,t))}getUI(e){let t,n,{name:r,typeName:i}=e;if(void 0!==this.ui){let e=this.ui[i];void 0!==e&&(t=e[r])}let{entity:s}=this.res;return void 0!==s&&(n=s[r]),{ui:t||{},res:n||{}}}link(e){return new s.a(e)}get tuidLinks(){return this.entities.tuidArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cTuidMain(e)))}cTuidMain(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CTuidMain||this.CTuidMain)(this,e,t,n)}cTuidSelect(e){let{ui:t,res:n}=this.getUI(e.owner||e);return new(t&&t.CTuidSelect||this.CTuidSelect)(this,e,t,n)}cTuidInfo(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CTuidInfo||this.CTuidInfo)(this,e,t,n)}cSheet(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CSheet||this.CSheet)(this,e,t,n)}get sheetLinks(){return this.entities.sheetArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cSheet(e)))}cAction(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CAction||this.CAction)(this,e,t,n)}get actionLinks(){return this.entities.actionArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cAction(e)))}cQuery(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CQuery||this.CQuery)(this,e,t,n)}cQuerySelect(e){let t=this.entities.query(e);if(void 0===t)return;let{ui:n,res:r}=this.getUI(t);return new(n&&n.CQuerySelect||this.CQuerySelect)(this,t,n,r)}get queryLinks(){return this.entities.queryArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cQuery(e)))}cBook(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CBook||this.CBook)(this,e,t,n)}get bookLinks(){return this.entities.bookArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cBook(e)))}cHistory(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CHistory||this.CHistory)(this,e,t,n)}get historyLinks(){return this.entities.historyArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cHistory(e)))}cPending(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CPending||this.CPending)(this,e,t,n)}get pendingLinks(){return this.entities.pendingArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cPending(e)))}cMap(e){let{ui:t,res:n}=this.getUI(e);return new(t&&t.CMap||this.CMap)(this,e,t,n)}get mapLinks(){return this.entities.mapArr.filter(e=>this.isVisible(e)).map(e=>this.link(this.cMap(e)))}getTuidContent(e){let{owner:t}=e;if(void 0===t){let{ui:t}=this.getUI(e);return t&&t.inputContent||b.b}{let{ui:n}=this.getUI(t);return n&&n.divs&&n.divs[e.name].inputContent||b.b}}showTuid(e,t){return E(this,void 0,void 0,function*(){let{owner:n}=e,r=this.cTuidInfo(n||e);yield r.start(t)})}get VUsq(){return g}render(){return new this.VUsq(this).render()}}n.d(t,"a",function(){return C})},function(e,t,n){"use strict";var r=n(30),i=n.n(r),s=n(13),o=n(52),a=n(3),c=n(20),u=n(11),l=n.n(u),h=n(9),d=n(7),f=n(26),p=n(24),v=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class m extends s.b{constructor(){super(...arguments),this.itemRender=((e,t)=>a.createElement(this.ItemRow,{item:e})),this.ItemRow=Object(c.a)(({item:e})=>{let t,n,r,i,{tuid:s,box:o,children:c,isLeaf:u,keyIndex:d,values:v}=e,m=this.controller.keyUIs[d],{content:y,valuesContent:b,none:w}=m,g=a.createElement("button",{className:"btn btn-link btn-sm",onClick:()=>this.controller.addClick(e)},a.createElement(h.b,{name:"plus"})),k=a.createElement("button",{className:"btn btn-link btn-sm",onClick:()=>this.controller.removeClick(e)},a.createElement(h.b,{className:"text-info",name:"trash"}));if(!1===u?t=0===d?g:a.createElement(a.Fragment,null,k," \xa0 ",g):d>0&&(t=k),!0===u)n=void 0,v&&(i=(b||p.b)(v,this.x));else{r="border-bottom";let e=w&&w(this.x);n=a.createElement(h.d,{className:"ml-4",items:c,item:{onClick:void 0,render:this.itemRender},none:e})}return a.createElement("div",{className:"d-flex flex-column"},a.createElement(h.c,{className:l()("px-3","py-2",r),right:t},a.createElement("div",{className:"py-1"},Object(f.b)(o,y,this.x)),a.createElement("div",{className:"py-1 font-weight-bold"},i)),n)})}showEntry(e){return v(this,void 0,void 0,function*(){this.openPage(this.view)})}get view(){return()=>a.createElement(d.d,{header:this.label},a.createElement(h.d,{items:this.controller.items,item:{className:"my-2",onClick:void 0,render:this.itemRender}}))}}var y=n(18),b=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class w extends s.b{constructor(){super(...arguments),this.onValuesSubmit=(()=>b(this,void 0,void 0,function*(){this.ceasePage();let e=this.vForm.getValues();this.returnCall(e)})),this.view=(()=>a.createElement(d.d,null,this.vForm.render()))}showEntry(e){return b(this,void 0,void 0,function*(){this.vForm=this.createForm(this.onValuesSubmit),this.openPageElement(a.createElement(this.view,null))})}}var g=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class k{constructor(e,t,n,r){this.children=y.k.array([],{deep:!0}),this.parent=e,this.tuid=t,this.box=n,this.keyIndex=r,this.isLeaf=!1}}class x extends s.a{constructor(){super(...arguments),this.addClick=(e=>g(this,void 0,void 0,function*(){let{keyIndex:t,children:n}=e,r=this.keyFields.length,i=r-1,s=t+1;if(s>=r)return;let a=this.keyFields[s],c=a.name,u=a._tuid,l={},h={};for(let o=e;void 0!==o;o=o.parent){let{keyIndex:e,box:t}=o,n=this.keyFields[e].name;l[n]=h["_"+n]=t.id}let d=yield this.searchOnKey(a,l);if(void 0===d||d<=0)return;u.useId(d);let f=u.boxId(d),p={},v={};if(t+1===i){if(u.useId(d),v[c]=p["_"+c]=f,this.entity.fields.length>0){let e=yield this.vCall(w,h);for(let t in e)v[t]=p["_"+t]=e[t]}}else{v[c]=h["_"+c]=f;for(let t=s+1;t<i;t++)h["_"+this.keyFields[t].name]=0;p["_"+this.keyFields[i].name]=0;let{fields:e}=this.entity;for(let t of e){let{name:e,type:n,null:r}=t;!0!==r&&(p["_"+t.name]=Object(o.b)(n))}}h.arr1=[p],yield this.entity.actions.add.submit(h);let m=n.findIndex(e=>e.box.id===d);if(m<0)n.push(this.createItem(e,u,f,s,v));else{let{fields:e}=this.entity;if(void 0!==e&&e.length>0){let e=n[m];n.splice(m,1),e.values=v,n.splice(m,0,e)}}this.removeCeased()})),this.removeClick=(e=>g(this,void 0,void 0,function*(){let t=this.keyFields[e.keyIndex]._tuid,n=this.cUsq.cTuidMain(t.Main).getLable(t),r=this.res.confirmDelete||i.a.template("do you really want to remove ${label}?");if(!1===confirm(r({label:n})))return;let s=this.entity,o={},a={};(o.arr1=[]).push(a);for(let i=e;void 0!==i;i=i.parent){let e=i.keyIndex;a["_"+this.keyFields[e].name]=i.box.id}let c=this.keyFields.length;for(let i=e.keyIndex+1;i<c;i++){a["_"+this.keyFields[i].name]=-1}yield s.actions.del.submit(o);let u=e.parent.children,l=u.findIndex(t=>t===e);l>=0&&u.splice(l,1)}))}internalStart(){return g(this,void 0,void 0,function*(){let{keys:e}=this.entity,t=this.entity.queries.all,n=(yield t.query({})).ret,r=e.length;this.keyUIs=i.a.clone(this.ui.keys||[]),this.keyFields=[];let s=t.returns[0].fields;for(let i=0;i<r;i++)this.keyFields.push(s[i]),i>=this.keyUIs.length&&this.keyUIs.push({content:p.b});this.items=Object(y.k)([]);let o=void 0;for(let i of n){let e=this.addItem(o,i);void 0!==e&&(this.items.push(e),o=e)}yield this.showVPage(this.VMapMain)})}createItem(e,t,n,r,i){let s=new k(e,t,n,r);return r===this.keyFields.length-1&&(s.isLeaf=!0,s.values=i),s}addItem(e,t){let n=void 0,r=this.keyFields.length,i=e;for(let s=0;s<r;s++){let e=this.keyFields[s],{name:r}=e,o=e._tuid,a=t[r];if(void 0===a)break;let{id:c}=a;if(0===s){if(0===c)continue;void 0!==i&&i.box.id===c||(n=i=this.createItem(void 0,o,a,s,t));continue}let{children:u,box:l}=i,h=u.length;if(h>0){let e=u[h-1];if(e.box.id===c){i=e;continue}}c>0&&u.push(i=this.createItem(i,o,a,s,t))}return n}searchOnKey(e,t){return g(this,void 0,void 0,function*(){let{_tuid:n,_ownerField:r}=e,i=this.cUsq.cTuidSelect(n),s=t;void 0!==r&&"object"===typeof(s=t[r.name])&&(s=s.id);let o=yield i.call(s);return n.getIdFromObj(o)})}get VMapMain(){return m}}n.d(t,"a",function(){return x}),n.d(t,"b",function(){return m})},function(e,t,n){"use strict";var r=n(13),i=n(3),s=n(7),o=n(26),a=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class c extends r.b{constructor(){super(...arguments),this.onSubmit=(()=>a(this,void 0,void 0,function*(){let e=this.vForm.getValues();this.returns=yield this.controller.submit(e),this.closePage(),this.openPage(this.resultPage)})),this.mainPage=(()=>{let{label:e}=this.controller;return i.createElement(s.d,{header:e},this.vForm.render("mx-3 my-2"))}),this.resultPage=(()=>{let{label:e}=this.controller;return i.createElement(s.d,{header:e,back:"close"},"\u5b8c\u6210\uff01",i.createElement("pre",null,Object(o.a)(this.returns)))})}showEntry(e){return a(this,void 0,void 0,function*(){this.vForm=this.createForm(this.onSubmit,e),this.openPage(this.mainPage)})}}var u=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class l extends r.a{internalStart(){return u(this,void 0,void 0,function*(){yield this.showVPage(this.VActionMain)})}get VActionMain(){return c}submit(e){return u(this,void 0,void 0,function*(){return this.entity.submit(e)})}}n.d(t,"a",function(){return l})},function(e,t,n){"use strict";var r=n(13),i=n(3),s=n(7),o=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class a extends r.b{constructor(){super(...arguments),this.view=(()=>i.createElement(s.d,{header:this.label},"History"))}showEntry(e){return o(this,void 0,void 0,function*(){this.openPage(this.view)})}}var c=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class u extends r.a{internalStart(){return c(this,void 0,void 0,function*(){yield this.showVPage(this.VHistoryMain)})}get VHistoryMain(){return a}}n.d(t,"a",function(){return u})},function(e,t,n){"use strict";var r=n(13),i=n(3),s=n(7),o=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class a extends r.b{constructor(){super(...arguments),this.view=(()=>i.createElement(s.d,{header:this.label},"pending"))}showEntry(e){return o(this,void 0,void 0,function*(){this.openPage(this.view)})}}var c=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};class u extends r.a{internalStart(){return c(this,void 0,void 0,function*(){yield this.showVPage(this.VPendingMain)})}get VPendingMain(){return a}}n.d(t,"a",function(){return u})},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=2e3;function i(e,t){return new Promise(function(n,i){fetch(e,t).then(n).catch(i);var s=new Error("Connection timed out");setTimeout(i,r,s)})}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(88);function i(e){var t=r(e);return t.accesses&&t.accesses.split(","),{id:t.id,name:t.name,token:e,device:t.device}}},,,,function(e,t,n){"use strict";n(3),n(63)},function(e,t){},,function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(38),i=n(36),s={set:function(e){Object(r.i)(e),i.a.setCenterToken(e)},clear:function(){Object(r.i)(void 0),i.a.setCenterToken(void 0)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(6),i=n.n(r),s=n(12),o=n(14),a=n(16),c=n(15),u=n(17),l=n(25),h=n(5),d=n(37),f=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},p=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(a.a)(this,Object(c.a)(t).apply(this,arguments))).reApi=function(){return f(Object(l.a)(Object(l.a)(e)),void 0,void 0,i.a.mark(function e(){var t,n,r,s,o,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.clearError(),t=this.props,n=t.channel,r=t.url,s=t.options,o=t.resolve,a=t.reject,e.next=4,Object(d.k)(n,r,s,o,a);case 4:case"end":return e.stop()}},e,this)}))},e.close=function(){return f(Object(l.a)(Object(l.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.clearError();case 1:case"end":return e.stop()}},e,this)}))},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.error,r=t.url;if("object"===typeof n){var i=[];for(var s in n)i.push(h.createElement("li",{key:s},h.createElement("label",null,s),h.createElement("div",null,n[s])));e=h.createElement("ul",null,i)}else e=h.createElement("div",null,n);return h.createElement("li",null,h.createElement("article",{className:"page-container"},h.createElement("section",null,h.createElement("div",{className:"va-error"},h.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),h.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),h.createElement("div",null,"url: ",r),e,h.createElement("div",{className:"p-3"},h.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),h.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed"))))))}}]),t}(h.Component)},,,,,function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},function(e,t,n){e.exports=n(160)},,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},,,,,,,,,,,,,function(e,t,n){},,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,,,,,,,,,,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),s=n(35),o=n(7),a=(n(124),n(126),n(9));var c={user:{inputContent:e=>{let{id:t,name:n,nick:i,assigned:s}=e;return void 0!==s?r.createElement(r.Fragment,null,s," - ",r.createElement(a.e,null,n)):void 0!=i?r.createElement(r.Fragment,null,i," - ",r.createElement(a.e,null,n)):void 0!==n?n:"id "+t+" ..."}},section:{inputContent:e=>{let{id:t,name:n}=e;return r.createElement(r.Fragment,null,n)}},organization:{divs:{post:{inputContent:e=>{let{id:t,title:n}=e;return r.createElement(r.Fragment,null,n)}}}}},u=n(23),l=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};var h={teamPerson:{CMap:class extends u.CMap{searchOnKey(e,t){const n=e=>super[e];return l(this,void 0,void 0,function*(){switch(e.name){default:return yield n("searchOnKey").call(this,e,t);case"post":return yield this.searchOnPost(t)}})}searchOnPost(e){return l(this,void 0,void 0,function*(){let t=this.cQuerySelect("teamPosts");return(yield t.call(e)).post.id})}},keys:[{content:({name:e,id:t},n)=>r.createElement(r.Fragment,null,r.createElement(a.e,null,n.team)," ",e),none:e=>e.noStaff},{content:({name:e,id:t},n)=>r.createElement(r.Fragment,null,r.createElement(a.e,null,n.staff)," ",e," \xa0 ",r.createElement(a.e,null,n.no," ",Object(o.k)(t,4))),none:e=>e.noPost},{content:({x:e,title:t,id:n})=>r.createElement(r.Fragment,null,r.createElement(a.e,null,e.post)," ",t),none:void 0}]}},d=n(20),f=n(50);class p extends u.VQueryMain{constructor(){super(...arguments),this.queryResult=Object(d.a)(e=>{let t=e.ret[0],n=i.a.createElement("button",{className:"btn btn-outline-success",onClick:this.again},i.a.createElement(a.b,{name:"search"})," \u518d\u67e5\u8be2");return i.a.createElement(o.d,{header:this.label,right:n},"\u91cd\u8f7d\u7684CGetMessage ",i.a.createElement("br",null),Object(f.tv)(t.fromUser),i.a.createElement("pre",null,JSON.stringify(t,void 0,"\t")))})}}var v={getMessage:{main:p},teamPosts:{row:Object(d.a)(e=>i.a.createElement("div",{className:"px-3 py-2"},Object(u.tv)(e.post)))}},m=n(30),y=n.n(m);var b={zh:{CN:{x:{no:"\u7f16\u53f7",team:"\u90e8\u95e8",staff:"\u5458\u5de5",noStaff:"\u65e0\u5458\u5de5",post:"\u804c\u4f4d",noPost:"\u65e0\u804c\u4f4d",a:"aaa",b:{s:"sss",d:()=>i.a.createElement("span",{className:"text-success"},"ddd")},c:()=>i.a.createElement("span",{className:"text-danger"},"ccc")},usq:"$UNITX",tuid:"\u57fa\u7840\u6863\u6848",map:"\u5bf9\u7167\u8868",tuidPlaceHolder:"\u9009\u62e9",submit:"\u63d0\u4ea4",arrNew:"\u65b0\u589e",arrEdit:"\u4fdd\u5b58",entity:{message:{label:"\u6d88\u606f-message",arrNew:"\u65b0\u589e\u6d88\u606f",arrEdit:"\u4fdd\u5b58\u6d88\u606f",fields:{fromUser:"\u53d1\u9001\u4eba",fromUnit:"\u53d1\u9001\u90e8\u95e8",type:"\u7c7b\u578b",date:"\u65e5\u671f",subject:"\u4e3b\u9898",discription:"\u63cf\u8ff0",content:"\u5185\u5bb9"}},getMessage:{label:"\u83b7\u53d6Message",submit:"\u83b7\u53d6\u6d88\u606f",fields:{msg:"\u6d88\u606f"}},newMessage:{label:"\u65b0\u5efa\u6d88\u606f",fields:{type:"\u7c7b\u578b",subject:"\u4e3b\u9898"},arrs:{to:{label:"\u53d1\u9001",newSubmit:"\u65b0\u589eto",editSumbit:"\u4fdd\u5b58to"},cc:{label:"\u6284\u9001",newSubmit:"\u65b0\u589ecc",editSumbit:"\u4fdd\u5b58cc"}}},sectionTeam:{label:"\u5927\u90e8\u8bbe\u7f6e"},teamPerson:{label:"\u90e8\u95e8\u5458\u5de5\u804c\u4f4d",fields:{},confirmDelete:y.a.template("\u771f\u7684\u8981\u5220\u9664${label}\u5417")},teamOrganization:{label:"\u90e8\u95e8\u673a\u6784\u5bf9\u7167\u8868"},teamPosts:{label:"\u90e8\u95e8\u804c\u4f4d"},person:{label:"\u5458\u5de5",fields:{name:"\u59d3\u540d",nick:"\u522b\u540d",given:"\u540d\u5b57",sur:"\u59d3",gender:"\u6027\u522b",user:"\u7528\u6237"}},organization:{label:"\u7ec4\u7ec7\u7ed3\u6784",arrs:{post:{label:"\u804c\u4f4d"}}},user:{label:"\u7528\u6237"}}}}},w=n(28);class g extends u.VTuidMain{get view(){let{label:e,proxyLinks:t}=this.controller;return()=>r.createElement(o.d,{header:e},void 0===t?r.createElement(r.Fragment,null,r.createElement(a.f,{className:"w-100",onSearch:this.onSearch,placeholder:"\u641c\u7d22"+e}),"\u6539\u5199\u7684TuidMain",r.createElement("div",{className:"my-3"},r.createElement(w.b,{className:"ml-3",color:"primary",onClick:this.onNew},"\u65b0\u589e"),r.createElement(w.b,{className:"ml-3",color:"primary",onClick:this.onList},"\u5217\u8868"))):r.createElement(a.d,{className:"my-2",header:r.createElement(a.e,null,e," \u4ee3\u7406\u4e0b\u5217Tuid"),items:t,item:{render:this.entityRender,onClick:this.entityClick}}))}}var k=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};var x={CTuidMain:class extends u.CTuidMain{get VTuidMain(){return g}buildSelect(e,t,n){let{name:r}=e;switch(t){case void 0:switch(r){case"fromUser":return(e,t,n)=>k(this,void 0,void 0,function*(){let{_tuid:e}=t,n=this.cUsq.cTuidSelect(e);return(yield n.call()).id})}}return super.buildSelect(e,t,n)}},tuid:c,map:h,query:v,res:b};var E={tuid:{customer:{inputContent:e=>{let{id:t,name:n,discription:i}=e;return r.createElement(r.Fragment,null,i||n||"id "+t+" ...")}},article:{inputContent:e=>{let{id:t,name:n,discription:i,casNO:s}=e;return void 0!==s?r.createElement(r.Fragment,null,"CAS:",s," - ",i||n):r.createElement(r.Fragment,null,i||n||"id "+t+" ...")}}},sheet:{order:{form:{items:{sumAmount:()=>1,articles:{items:{amount:function(){return(void 0===this.quantity||null===this.quantity?0:this.quantity)*(void 0===this.price||null===this.price?0:this.price)}}}}}}}};var O={zh:{CN:{x:{none:"[\u65e0]",no:"\u7f16\u53f7",team:"\u90e8\u95e8",staff:"\u5458\u5de5",noStaff:"\u65e0\u5458\u5de5",post:"\u804c\u4f4d",noPost:"\u65e0\u804c\u4f4d",product:"\u4ea7\u54c1",pack:"\u5305\u88c5",a:"aaa",b:{s:"sss",d:()=>i.a.createElement("span",{className:"text-success"},"ddd")},c:()=>i.a.createElement("span",{className:"text-danger"},"ccc")},usq:"\u767e\u7075\u5a01\u8ba2\u5355",tuid:"\u57fa\u7840\u6863\u6848",sheet:"\u5355\u636e",map:"\u5bf9\u7167\u8868",tuidPlaceHolder:"\u70b9\u51fb\u9009\u62e9",none:"\u65e0\u5185\u5bb9",submit:"\u63d0\u4ea4",arrNew:"\u65b0\u589e",arrEdit:"\u4fdd\u5b58",entity:{product:{label:"\u4ea7\u54c1",fields:{discription:"\u63cf\u8ff0",packType:"\u57fa\u672c\u5305\u88c5\u7c7b\u578b"},arrs:{pack:{label:"\u5305\u88c5\u89c4\u683c",fields:{ratio:"\u6362\u7b97\u7387",name:{label:"\u540d\u79f0",placeHolder:"\u5982\u679c\u7a7a\uff0c\u5219\u663e\u793a\u6362\u7b97\u7387+\u57fa\u672c\u5305\u88c5\u7c7b\u578b"}}}}},packType:{label:"\u5305\u88c5\u7c7b\u578b",fields:{name:"\u540d\u79f0",discription:{label:"\u63cf\u8ff0",placeHolder:"\u5305\u88c5\u8bf4\u660e\uff0c\u4e0d\u7528\u4e8e\u5b9e\u9645\u4ea7\u54c1\u4e2d"}}},customer:{label:"\u5ba2\u6237",fields:{discription:"\u63cf\u8ff0"}},order:{x:{top:()=>i.a.createElement(i.a.Fragment,null,i.a.createElement("h6",null,"\u8ba2\u5355\u6b65\u9aa4"),i.a.createElement("div",null,"\u7b2c\u4e00\u6b65\uff1a\u9009\u5b9a\u5ba2\u6237"),i.a.createElement("div",null,"\u7b2c\u4e8c\u6b65\uff1a\u989c\u8272\u53d8\u5316",i.a.createElement("span",{className:"text-success"},"\u8bf4\u660e"),i.a.createElement("span",{className:"text-danger"},"\u6587\u5b57"),"\uff0c\u89e3\u91ca\u505a\u5355\u7684\u8fc7\u7a0b")),title:y.a.template("\u8ba2\u5355 ${customer} \u91d1\u989d${amount}\u5143"),detail:"\u8ba2\u5355-\u8be6\u60c5"},label:"\u8ba2\u5355",arrNew:"\u65b0\u589e",arrEdit:"\u4fdd\u5b58",title:y.a.template("\u8ba2\u5355 \u5ba2\u6237${customer} \u91d1\u989d${amount}\u5143"),fields:{customer:"\u5ba2\u6237",fromUnit:"\u53d1\u9001\u90e8\u95e8",type:"\u7c7b\u578b",date:"\u65e5\u671f",subject:"\u4e3b\u9898",discription:"\u63cf\u8ff0",content:"\u5185\u5bb9"},arrs:{products:{label:"\u4ea7\u54c1\u660e\u7ec6",fields:{product:{label:"\u4ea7\u54c1",placeHolder:"\u70b9\u51fb\u9009\u62e9\u4ea7\u54c1"},pack:{label:"\u5305\u88c5\u89c4\u683c",placeHolder:"\u70b9\u51fb\u9009\u62e9\u5305\u88c5\u89c4\u683c"},price:{label:"\u5355\u4ef7",suffix:"\u5143"},quantity:{label:"\u6570\u91cf"},amount:{label:"\u91d1\u989d",suffix:"\u5143"}}}},states:{$:{label:"\u65b0\u5f00\u5355",actions:{submit:{label:"\u65b0\u5355\u63d0\u4ea4"}}},deliver:{label:"\u53d1\u8d27",actions:{finish:{label:"\u5b8c\u6210\u53d1\u8d27"}}}}},price:{label:"\u4ea7\u54c1\u4ef7\u683c\u8868"},getMessage:{label:"\u83b7\u53d6Message",submit:"\u83b7\u53d6\u6d88\u606f",fields:{msg:"\u6d88\u606f"}},newMessage:{label:"\u65b0\u5efa\u6d88\u606f",fields:{type:"\u7c7b\u578b",subject:"\u4e3b\u9898"},arrs:{to:{label:"\u53d1\u9001",newSubmit:"\u65b0\u589eto",editSumbit:"\u4fdd\u5b58to"},cc:{label:"\u6284\u9001",newSubmit:"\u65b0\u589ecc",editSumbit:"\u4fdd\u5b58cc"}}},sectionTeam:{label:"\u5927\u90e8\u8bbe\u7f6e"},teamPerson:{label:"\u90e8\u95e8\u5458\u5de5\u804c\u4f4d",fields:{},confirmDelete:y.a.template("\u771f\u7684\u8981\u5220\u9664${label}\u5417")},teamOrganization:{label:"\u90e8\u95e8\u673a\u6784\u5bf9\u7167\u8868"},teamPosts:{label:"\u90e8\u95e8\u804c\u4f4d"},person:{label:"\u5458\u5de5",fields:{name:"\u59d3\u540d",nick:"\u522b\u540d",given:"\u540d\u5b57",sur:"\u59d3",gender:"\u6027\u522b",user:"\u7528\u6237"}},organization:{label:"\u7ec4\u7ec7\u7ed3\u6784",arrs:{post:{label:"\u804c\u4f4d"}}},user:{label:"\u7528\u6237"}}}}};const C={inputContent:e=>{let{id:t,discription:n}=e;return r.createElement(r.Fragment,null,n||"id "+t+" ...")},rowContent:e=>{let{discription:t}=e,n=r.createElement(a.e,null);return r.createElement(a.c,{className:"px-3 py-2",left:t,right:n})}},N=Object(d.a)(e=>{let t,{id:n,ratio:i,name:s,$owner:o}=e,a=String(i);if(void 0!==o){let e=o.valueFromFieldName("packType"),n=e.valueFromFieldName?e.valueFromFieldName("name"):e.name;n&&(t=s?s+" = "+(a+n):a+n)}return void 0===t&&(t=(s?s+" "+a:a)+" err: no $owner in values"),r.createElement("div",{className:"px-3 py-2"},t)});var P={customer:C,product:{inputContent:e=>{let{id:t,discription:n}=e;return r.createElement(r.Fragment,null,n||"id "+t+" ...")},rowContent:Object(d.a)(e=>{let t,{discription:n,packType:i}=e;return i&&i.content&&(t=r.createElement(a.e,null,Object(u.tv)(i))),r.createElement(a.c,{className:"px-3 py-2",left:n,right:t})}),divs:{pack:{inputContent:Object(d.a)(e=>{let{id:t,ratio:n,name:i,$owner:s}=e;if(void 0===s)return r.createElement(r.Fragment,null,i||n||"id"+t+" ...");let o=s.valueFromFieldName("packType");return r.createElement(r.Fragment,null,i||n+(o&&o.name)||"id"+t+" ...")}),rowContent:N}},form:{items:{packType:{autoList:!0},pack:{rowContent:N}}}},packType:{inputContent:e=>{let{id:t,name:n,discription:i}=e;return r.createElement(r.Fragment,null,i||n||"id "+t+" ...")},rowContent:e=>{let{name:t,discription:n}=e,i=r.createElement(a.e,null,n);return r.createElement(a.c,{className:"px-3 py-2",left:t,right:i})}}},j=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};const S={sheetNew:class extends u.VEntity{constructor(){super(...arguments),this.onSubmit=(()=>j(this,void 0,void 0,function*(){let e=this.vForm.getValues(),t=this.vForm.values;yield this.controller.onSave(e,t)})),this.addRow=(()=>j(this,void 0,void 0,function*(){yield this.selectProduct()})),this.step1Next=(()=>j(this,void 0,void 0,function*(){this.ceasePage(),this.customer=yield this.cCustomerSelect.call(""),this.openPage(this.orderPage),this.openPage(this.customerPage)})),this.conformOrder=(()=>j(this,void 0,void 0,function*(){this.ceasePage();let{entity:e}=this.cCustomerSelect;e.useId(this.customer.id),this.vForm.setValue("customer",e.boxId(this.customer.id)),yield this.selectProduct()})),this.addProductRows=(({product:e,packRows:t})=>j(this,void 0,void 0,function*(){let{entity:n}=this.cProductSelect;n.useId(e),n.divs.pack;let r=this.vForm.vArrs.products,{list:i}=r;for(let s of t){let{pack:t,price:r,quantity:o,amount:a}=s;i.push({product:n.boxId(e),pack:t,price:r,quantity:o,amount:a})}this.product=void 0,yield this.selectProduct()})),this.selectProduct=(()=>j(this,void 0,void 0,function*(){this.product=yield this.cProductSelect.call(),this.priceRows=yield this.getPrices(this.product.id),this.openPage(this.productPage)})),this.stopOrder=(()=>{this.closePage()}),this.step1SelectCustomer=(()=>r.createElement(o.d,{header:"\u65b0\u5efa\u8ba2\u5355"},r.createElement("div",{className:"p-3 d-flex align-items-center flex-column"},this.x.top()),r.createElement("div",{className:"p-3 d-flex justify-content-center"},r.createElement("button",{className:"w-25 btn btn-primary",onClick:this.step1Next},"\u5f00\u59cb")))),this.customerPage=(()=>r.createElement(o.d,{header:"\u786e\u8ba4\u5ba2\u6237"},r.createElement("div",{className:"p-3"},"\u5ba2\u6237\u8be6\u60c5\uff0c\u4fe1\u7528\uff0c\u6536\u8d27\u5730\u5740\uff0c\u6536\u6b3e\u4fe1\u606f\uff0c\u7b49\u7b49"),this.cCustomerSelect.createForm(void 0,this.customer).render(),r.createElement("div",{className:"p-3 d-flex justify-content-center"},r.createElement("button",{className:"w-25 btn btn-primary",onClick:this.conformOrder},"\u786e\u8ba4\u5f00\u5355"),r.createElement("button",{className:"mx-3 btn btn-outline-secondary",onClick:this.stopOrder},"\u62d2\u7edd")))),this.orderPage=(()=>r.createElement(o.d,{header:this.x.detail},this.vForm.render())),this.inputs={},this.addProduct=(()=>j(this,void 0,void 0,function*(){this.ceasePage();let e=[];for(let t of this.priceRows){let{pack:n,retail:r}=t,i=Number.parseFloat(this.inputs[n.id].value);if(Number.isNaN(i))continue;let s={pack:n,quantity:i,price:r,amount:r*i};e.push(s)}yield this.addProductRows({product:this.product.id,packRows:e})})),this.refQuantity=((e,t)=>{this.inputs[t]=e}),this.renderPack=((e,t)=>{let{pack:n,retail:i}=e;return r.createElement("div",{className:"px-3 py-1 d-flex"},r.createElement("div",{className:"row py-1 align-items-center flex-fill"},r.createElement("div",{className:"col-sm-6"},Object(u.tv)(n)),r.createElement("div",{className:"col-sm-6"},r.createElement("div",{className:"row align-items-center"},r.createElement("div",{className:"col-6 text-sm-right"},r.createElement("span",{className:"text-danger"},i)," \u5143"),r.createElement("div",{className:"col-6"},r.createElement("input",{className:"text-center form-control form-control-sm",ref:e=>this.refQuantity(e,n.id),type:"number",min:0}))))))}),this.productPage=(()=>{let{discription:e}=this.product;return r.createElement(o.d,{header:"\u9009\u5b9a\u4ea7\u54c1"},r.createElement("div",{className:"p-3 text-primary bg-white my-3"},e),r.createElement(a.d,{items:this.priceRows,item:{render:this.renderPack}}),r.createElement("div",{className:"p-3 d-flex justify-content-center"},r.createElement("button",{className:"w-25 btn btn-primary",onClick:this.addProduct},"\u52a0\u5165\u8ba2\u5355")))})}showEntry(e){return j(this,void 0,void 0,function*(){let t=this.controller.cUsq;this.mapPrice=t.entities.map("price");let n=t.entities.tuid("customer");this.cCustomerSelect=t.cTuidSelect(n);let r=t.entities.tuid("product");this.cProductSelect=t.cTuidSelect(r),this.vForm=this.createForm(this.onSubmit,e),this.vForm.getBand("products").setAddRow(this.addRow),this.openPage(this.step1SelectCustomer)})}getPrices(e){return j(this,void 0,void 0,function*(){return yield this.mapPrice.page({_product:e},0,1e3)})}},sheetTitle:(e,t)=>{let n=t.title,{customer:r,amount:i}=e;return n({customer:r.obj.discription,amount:i||99})},form:{items:{customer:{editable:!1},sumAmount:()=>1,products:{rowContent:Object(d.a)(e=>{let{product:t,pack:n,price:i,quantity:s}=e;return r.createElement("div",{className:"row px-3 py-2"},r.createElement("div",{className:"col-8"},r.createElement("div",{className:"text-primary"},Object(u.tv)(t)),r.createElement("div",{className:"small"},Object(u.tv)(n))),r.createElement("div",{className:"col-2 text-right"},r.createElement("span",{className:"text-danger h5 mb-0"},i.toFixed(2))," ",r.createElement("small",null,"\u5143")),r.createElement("div",{className:"col-2"},s))}),items:{product:{editable:!1},pack:{editable:!1},price:{editable:!1},amount:function(){return(void 0===this.quantity||null===this.quantity?0:this.quantity)*(void 0===this.price||null===this.price?0:this.price)}}}}}};var _=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};var V=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};var F={CApp:class extends u.CApp{start(e){const t=e=>super[e];return _(this,void 0,void 0,function*(){yield t("start").call(this,e)})}},res:{zh:{CN:{x:{no:"\u7f16\u53f7",team:"\u90e8\u95e8"},caption:"*\u767e\u7075\u5a01\u8ba2\u5355*"}}},main:class extends o.h{constructor(){super(...arguments),this.appPage=(()=>{let e,{caption:t,cUsqArr:n}=this.controller;return e=0===n.length?i.a.createElement("div",{className:"p-3 text-info"},i.a.createElement(a.b,{name:"minus-circle",className:"text-danger",size:"lg"})," \xa0 \u6b64APP\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u7684USQ"):n.map((e,t)=>i.a.createElement("div",{key:t},e.render())),i.a.createElement(o.d,{header:t,logout:()=>{o.m.unit=void 0}},i.a.createElement("div",{className:"p-3"},"\u81ea\u5b9a\u4e49\u7a0b\u5e8f\u754c\u9762\u4e86\u3002\u663e\u793a\u8fd9\u4e00\u6bb5\uff0c\u81ea\u5b9a\u4e49\u8d77\u4f5c\u7528\u4e86\u3002\u53ef\u4ee5\u5728\u8fd9\u91cc\u653e\u7f6e\u4efb\u4f55\u5185\u5bb9"),e)})}showEntry(e){return V(this,void 0,void 0,function*(){this.openPage(this.appPage)})}},usqs:{"$$$/$unitx":x,"DevApp/devappApi":E,"JKDev/jkOrder":{tuid:P,sheet:{order:S},map:{price:{keys:[{content:({discription:e,id:t},n)=>r.createElement(r.Fragment,null,r.createElement(a.e,null,n.product)," \xa0 ",e),none:e=>e.none},{content:(e,t)=>{let{name:n,id:i,discription:s,$owner:o}=e;return r.createElement(r.Fragment,null,r.createElement(a.e,null,t.pack)," \xa0 ")},valuesContent:(e,t)=>{let{pack:n,retail:i}=e;return r.createElement("div",{className:"px-0 py-1"},r.createElement("div",{className:"d-inline-block w-25"},Object(u.tv)(n))," ",i," \u5143")},none:e=>e.noPost}]}},res:O},"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/cart":{}}},A=n(18),I=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};const R="JKDev/jkOrder";var T=class extends r.Component{constructor(){super(...arguments),this.text=A.k.box("kkk"),this.onClick=(()=>{this.text.set("bbb"),alert("click")})}onLogined(){return I(this,void 0,void 0,function*(){yield Object(f.startApp)(R,F)})}render(){return r.createElement(o.c,{onLogined:this.onLogined})}};const q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=(()=>{const t=e.installing;t&&(t.onstatechange=(()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}))})}).catch(e=>{console.error("Error during service worker registration:",e)})}n(158);s.render(r.createElement(T,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="./service-worker.js";q?function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):M(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e):M(e)})}}()}],[[96,3,2]]]);
//# sourceMappingURL=main.2bc2f29e.chunk.js.map